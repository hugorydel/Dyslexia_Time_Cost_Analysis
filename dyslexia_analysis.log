2025-10-17 22:05:38,743 - __main__ - INFO - Dyslexia Time Analysis Pipeline initialized
2025-10-17 22:05:38,743 - __main__ - INFO - Dyslexia Time Analysis Pipeline initialized
2025-10-17 22:05:39,724 - __main__ - INFO - Running hypothesis testing analysis...
2025-10-17 22:05:39,725 - __main__ - INFO - ================================================================================
2025-10-17 22:05:39,725 - __main__ - INFO - HYPOTHESIS TESTING ANALYSIS
2025-10-17 22:05:39,725 - __main__ - INFO - ================================================================================
2025-10-17 22:05:39,725 - __main__ - INFO - Loading CopCo dataset...
2025-10-17 22:05:39,731 - utils.data_utils - INFO - Loading 57 participant files...
2025-10-17 22:05:41,731 - utils.data_utils - INFO - Starting with 335,203 total word entries
2025-10-17 22:05:41,942 - utils.data_utils - INFO - Word fixation patterns:
2025-10-17 22:05:41,943 - utils.data_utils - INFO -   - Skipped words (0 fixations): 126,302
2025-10-17 22:05:41,943 - utils.data_utils - INFO -   - Fixated words (1+ fixations): 208,901
2025-10-17 22:05:41,943 - utils.data_utils - INFO -   - Unknown fixations (NaN): 0
2025-10-17 22:05:41,980 - utils.data_utils - INFO - Fixated words reading times: median 272ms, 99th percentile 1777ms
2025-10-17 22:05:41,983 - utils.data_utils - INFO - Removed 14 fixated words with extreme reading times (0 too short, 14 too long)
2025-10-17 22:05:42,084 - utils.data_utils - INFO - Removed 23 words longer than 30 characters (likely data errors)
2025-10-17 22:05:42,123 - utils.data_utils - INFO - Final dataset: 126,302 skipped words, 208,864 fixated words
2025-10-17 22:05:42,124 - utils.data_utils - INFO - Data cleaning complete: 335,166 words retained (100.0% of original)
2025-10-17 22:05:42,133 - utils.data_utils - INFO - Groups identified: 19 dyslexic, 39 control
2025-10-17 22:05:42,210 - __main__ - INFO - Calculating skipping probabilities...
2025-10-17 22:05:42,213 - utils.skipping_utils - INFO - Skipping analysis from ExtractedFeatures:
2025-10-17 22:05:42,213 - utils.skipping_utils - INFO -   Total words: 335,166
2025-10-17 22:05:42,213 - utils.skipping_utils - INFO -   Skipped: 126,302 (37.7%)
2025-10-17 22:05:42,214 - utils.skipping_utils - INFO -   Fixated: 208,864 (62.3%)
2025-10-17 22:05:42,266 - __main__ - INFO - Skipping analysis: 37.7% overall rate
2025-10-17 22:05:42,286 - __main__ - INFO - Loaded: 335,166 words from 57 participants
2025-10-17 22:05:42,287 - __main__ - INFO - ============================================================
2025-10-17 22:05:42,287 - __main__ - INFO - COMPUTING LINGUISTIC FEATURES
2025-10-17 22:05:42,287 - __main__ - INFO - ============================================================
2025-10-17 22:05:42,288 - utils.linguistic_features - INFO - Loading Danish frequency list from danish_frequencies\danish_leipzig_for_analysis.txt
2025-10-17 22:05:43,807 - utils.linguistic_features - WARNING - Found 2 duplicate words after lowercasing. 
2025-10-17 22:05:44,239 - utils.linguistic_features - INFO - Loaded 1,499,999 word proportions from Leipzig Corpora
2025-10-17 22:05:44,365 - utils.linguistic_features - INFO - Computing word frequency...
2025-10-17 22:05:44,365 - utils.linguistic_features - INFO -   Stripping punctuation from words before frequency lookup
2025-10-17 22:05:45,083 - utils.linguistic_features - INFO - 13 missing word instances were punctuation-only
2025-10-17 22:05:45,083 - utils.linguistic_features - WARNING - 4,586 word instances (1.4%) not found in frequency list (197 unique valid words)
2025-10-17 22:05:45,084 - utils.linguistic_features - INFO - Sample of 197 missing valid words: ['2. (margrethe', '2000-direktiverne', '9. og dronning', 'adspredelsens', 'affaldspolitikken', 'amokkacino', 'april 1940 på amalienborg', 'awakens (2015', 'blintzes', 'blotgydje', 'bygnings-konstruktioner', 'cølibatægteskabet', 'ecodesign-direktivet', 'elevrådsarrangementer', 'forbrugsopgjorte', 'forårsbebudning', 'første krigsminister, a.f', 'glædesblussene', 'græssteppefugl', 'havtema', 'hejre (bromus', 'initiativlyst', 'issefjerene', 'kaldet lemma', 'kridtrende', 'kusine, christine', 'lgbtqi-diskrimination', 'lgbtqi-miljøet', 'lgbtqi-personer', 'ligusteragtig', 'live-action-udgaven', 'livsgrøden', 'lysfester', 'lærerindejob', 'midsommeraftner', 'minervafester', 'morgensamlingsudvalget', 'naturlovgivning', 'og star', 'ph.d.-stilling', 'regnvandsbidrag', 'sankthansormen', 'sejdkunst', 'skraldefester', 'solhversfesten', 'spejder-juniorer', 'tusindårsfornemmelser', 'udstillingsparate', 'vaneslægt', 'åbningsriffet']... (147 more)
2025-10-17 22:05:45,092 - utils.linguistic_features - INFO - Excluding 4,599 word instances (1.4%) with missing frequencies from analysis
2025-10-17 22:05:45,287 - utils.linguistic_features - INFO - Remaining dataset: 330,567 words
2025-10-17 22:05:45,287 - utils.linguistic_features - INFO - Final dataset: 330,567 words with valid frequencies
2025-10-17 22:05:50,172 - utils.linguistic_features - INFO - Loading causal language model: KennethTM/gpt2-medium-danish
2025-10-17 22:05:51,988 - utils.linguistic_features - INFO - Using CPU for surprisal computation
2025-10-17 22:05:51,988 - utils.linguistic_features - INFO - Causal language model loaded successfully
2025-10-17 22:05:51,988 - utils.linguistic_features - INFO - Computing surprisal with causal GPT-2 (left-to-right)...
2025-10-17 22:05:53,284 - utils.linguistic_features - INFO - Dataset statistics:
2025-10-17 22:05:53,285 - utils.linguistic_features - INFO -   Total participant-sentence instances: 20,707
2025-10-17 22:05:53,285 - utils.linguistic_features - INFO -   Unique sentence texts: 1,986
2025-10-17 22:05:53,285 - utils.linguistic_features - INFO -   Average participants per sentence: 10.4
2025-10-17 22:05:53,285 - utils.linguistic_features - INFO - Loading cached surprisal values from word_surprisal\surprisal_cache_gpt2.pkl
2025-10-17 22:05:53,298 - utils.linguistic_features - INFO - Loaded surprisal for 1,986 unique sentences
2025-10-17 22:05:53,298 - utils.linguistic_features - INFO - Broadcasting surprisal values to all participant instances...
2025-10-17 22:05:53,298 - utils.linguistic_features - INFO -   Mapping surprisal to words...
2025-10-17 22:05:56,876 - utils.linguistic_features - INFO -   Mapped 326,496 words
2025-10-17 22:05:56,877 - utils.linguistic_features - INFO - 
Surprisal Computation Results:
2025-10-17 22:05:56,878 - utils.linguistic_features - INFO -   Unique sentences processed: 1,986
2025-10-17 22:05:56,878 - utils.linguistic_features - INFO -   Total words with surprisal: 326,496 / 330,567
2025-10-17 22:05:56,880 - utils.linguistic_features - INFO -   Mean: 6.93 bits
2025-10-17 22:05:56,885 - utils.linguistic_features - INFO -   Median: 5.69 bits
2025-10-17 22:05:56,887 - utils.linguistic_features - INFO -   Std: 5.55 bits
2025-10-17 22:05:56,888 - utils.linguistic_features - INFO -   Range: [0.00, 59.34] bits
2025-10-17 22:05:56,917 - utils.linguistic_features - INFO - Linguistic features added successfully
2025-10-17 22:05:56,917 - utils.linguistic_features - INFO - 
Feature Summary:
2025-10-17 22:05:56,920 - utils.linguistic_features - INFO -   Word length: mean=4.67, std=3.08
2025-10-17 22:05:56,924 - utils.linguistic_features - INFO -   Zipf frequency: mean=5.85, std=1.38, range=[0.91, 7.51]
2025-10-17 22:05:56,927 - utils.linguistic_features - INFO -   Surprisal: mean=6.93, std=5.55
2025-10-17 22:05:56,953 - utils.hypothesis_testing_utils - INFO - Preparing data for hypothesis testing...
2025-10-17 22:05:57,030 - utils.hypothesis_testing_utils - INFO - Creating ERT variable...
2025-10-17 22:05:57,034 - utils.hypothesis_testing_utils - INFO -   ERT created: 123,666 skipped (0ms), 206,901 fixated
2025-10-17 22:05:57,034 - utils.hypothesis_testing_utils - INFO - Centering and scaling predictors...
2025-10-17 22:05:57,059 - utils.hypothesis_testing_utils - INFO -   word_length: mean=4.67, scale=3.08
2025-10-17 22:05:57,079 - utils.hypothesis_testing_utils - INFO -   word_frequency_zipf: mean=5.85, scale=1.38
2025-10-17 22:05:57,097 - utils.hypothesis_testing_utils - INFO -   surprisal: mean=6.93, scale=5.55
2025-10-17 22:05:57,097 - utils.hypothesis_testing_utils - INFO - Checking collinearity (VIF)...
2025-10-17 22:05:57,305 - utils.hypothesis_testing_utils - INFO - VIF Results:
2025-10-17 22:05:57,307 - utils.hypothesis_testing_utils - INFO -   Length: 2.82 (OK)
2025-10-17 22:05:57,307 - utils.hypothesis_testing_utils - INFO -   Frequency: 3.18 (OK)
2025-10-17 22:05:57,307 - utils.hypothesis_testing_utils - INFO -   Surprisal: 1.41 (OK)
2025-10-17 22:05:57,308 - utils.hypothesis_testing_utils - INFO - Creating residualized surprisal...
2025-10-17 22:05:57,330 - utils.hypothesis_testing_utils - INFO -   Correlation (Frequency-Surprisal): r=-0.539
2025-10-17 22:05:57,331 - utils.hypothesis_testing_utils - INFO -   Residualized surprisal created
2025-10-17 22:05:57,331 - utils.hypothesis_testing_utils - INFO - Defining pooled quartiles...
2025-10-17 22:05:57,348 - utils.hypothesis_testing_utils - INFO -   word_length: Q1=2.00, Q3=6.00
2025-10-17 22:05:57,364 - utils.hypothesis_testing_utils - INFO -   word_frequency_zipf: Q1=4.91, Q3=7.10
2025-10-17 22:05:57,380 - utils.hypothesis_testing_utils - INFO -   surprisal: Q1=2.76, Q3=9.97
2025-10-17 22:05:57,380 - utils.hypothesis_testing_utils - INFO - Data preparation complete: 330,567 words ready for analysis
2025-10-17 22:05:57,398 - utils.quartile_analysis - INFO - ============================================================
2025-10-17 22:05:57,399 - utils.quartile_analysis - INFO - PART A: QUARTILE ANALYSIS (Q1 vs Q3)
2025-10-17 22:05:57,399 - utils.quartile_analysis - INFO - ============================================================
2025-10-17 22:05:57,399 - utils.quartile_analysis - INFO - 
Analyzing word_length...
2025-10-17 22:05:58,280 - utils.quartile_analysis - INFO -   Computed means for 57 participants
2025-10-17 22:05:58,282 - utils.quartile_analysis - INFO -     Control Q3-Q1: 259.7ms
2025-10-17 22:05:58,282 - utils.quartile_analysis - INFO -     Dyslexic Q3-Q1: 442.6ms
2025-10-17 22:05:58,341 - utils.quartile_analysis - INFO -   Fitting mixed model on 152,465 words...
2025-10-17 22:05:58,995 - utils.quartile_analysis - INFO -   Group×Bin interaction: beta=134.79, p=0.0000
2025-10-17 22:05:59,024 - utils.quartile_analysis - INFO -   Computing bootstrap CIs (1000 iterations)...
2025-10-17 22:06:00,808 - utils.quartile_analysis - INFO -   Bootstrap 95% CI for interaction: [98.47, 259.71]
2025-10-17 22:06:00,808 - utils.quartile_analysis - INFO - 
Analyzing word_frequency_zipf...
2025-10-17 22:06:01,632 - utils.quartile_analysis - INFO -   Computed means for 57 participants
2025-10-17 22:06:01,633 - utils.quartile_analysis - INFO -     Control Q3-Q1: -225.9ms
2025-10-17 22:06:01,634 - utils.quartile_analysis - INFO -     Dyslexic Q3-Q1: -388.2ms
2025-10-17 22:06:01,695 - utils.quartile_analysis - INFO -   Fitting mixed model on 162,606 words...
2025-10-17 22:06:04,773 - utils.quartile_analysis - INFO -   Group×Bin interaction: beta=-122.40, p=0.0000
2025-10-17 22:06:04,804 - utils.quartile_analysis - INFO -   Computing bootstrap CIs (1000 iterations)...
2025-10-17 22:06:06,595 - utils.quartile_analysis - INFO -   Bootstrap 95% CI for interaction: [-225.59, -87.90]
2025-10-17 22:06:06,595 - utils.quartile_analysis - INFO - 
Analyzing surprisal...
2025-10-17 22:06:07,412 - utils.quartile_analysis - INFO -   Computed means for 57 participants
2025-10-17 22:06:07,413 - utils.quartile_analysis - INFO -     Control Q3-Q1: 135.8ms
2025-10-17 22:06:07,414 - utils.quartile_analysis - INFO -     Dyslexic Q3-Q1: 277.3ms
2025-10-17 22:06:07,477 - utils.quartile_analysis - INFO -   Fitting mixed model on 163,257 words...
2025-10-17 22:06:10,358 - utils.quartile_analysis - INFO -   Group×Bin interaction: beta=105.53, p=0.0000
2025-10-17 22:06:10,390 - utils.quartile_analysis - INFO -   Computing bootstrap CIs (1000 iterations)...
2025-10-17 22:06:12,203 - utils.quartile_analysis - INFO -   Bootstrap 95% CI for interaction: [84.99, 194.82]
2025-10-17 22:06:12,205 - utils.continuous_models - INFO - ============================================================
2025-10-17 22:06:12,205 - utils.continuous_models - INFO - PART B: CONTINUOUS MODELS (TWO-PART)
2025-10-17 22:06:12,205 - utils.continuous_models - INFO - ============================================================
2025-10-17 22:06:12,206 - utils.continuous_models - INFO - 
1. SKIPPING MODEL (Logistic)
2025-10-17 22:06:12,308 - utils.continuous_models - INFO -   Formula: skipped ~ dyslexic_int * (word_length_scaled + word_frequency_zipf_scaled + surprisal_scaled)
2025-10-17 22:06:12,308 - utils.continuous_models - INFO -   Fitting on 326,496 words...
2025-10-17 22:06:12,722 - utils.continuous_models - INFO -   Model fitted successfully
2025-10-17 22:06:12,723 - utils.continuous_models - INFO -     dyslexic_int:word_length_scaled: beta=-0.0250, p=0.2274
2025-10-17 22:06:12,724 - utils.continuous_models - INFO -     dyslexic_int:word_frequency_zipf_scaled: beta=-0.0640, p=0.0004
2025-10-17 22:06:12,724 - utils.continuous_models - INFO -     dyslexic_int:surprisal_scaled: beta=-0.0272, p=0.0203
2025-10-17 22:06:12,733 - utils.continuous_models - INFO - 
2. DURATION MODEL (Log-TRT | Fixated)
2025-10-17 22:06:12,858 - utils.continuous_models - INFO -   Formula: log_TRT ~ dyslexic_int * (word_length_scaled + word_frequency_zipf_scaled + surprisal_scaled)
2025-10-17 22:06:12,858 - utils.continuous_models - INFO -   Fitting on 204,224 fixated words...
2025-10-17 22:06:13,967 - utils.continuous_models - INFO -   Model fitted successfully
2025-10-17 22:06:13,967 - utils.continuous_models - INFO -   Smearing correction factor: 1.1562
2025-10-17 22:06:13,967 - utils.continuous_models - INFO -     dyslexic_int:word_length_scaled: beta=0.0078, p=0.0585
2025-10-17 22:06:13,967 - utils.continuous_models - INFO -     dyslexic_int:word_frequency_zipf_scaled: beta=-0.0084, p=0.0678
2025-10-17 22:06:13,968 - utils.continuous_models - INFO -     dyslexic_int:surprisal_scaled: beta=0.0349, p=0.0000
2025-10-17 22:06:13,976 - utils.continuous_models - INFO - 
3. SLOPE RATIOS (Dyslexic Amplification)
2025-10-17 22:06:13,977 - utils.continuous_models - INFO -   Length: SR = 1.064 (AMPLIFIED)
2025-10-17 22:06:13,977 - utils.continuous_models - INFO -   Frequency: SR = 1.173 (AMPLIFIED)
2025-10-17 22:06:13,977 - utils.continuous_models - INFO -   Surprisal: SR = 2.100 (AMPLIFIED)
2025-10-17 22:06:13,977 - utils.continuous_models - INFO - 
4. BOOTSTRAP CONFIDENCE INTERVALS
2025-10-17 22:06:13,977 - utils.continuous_models - INFO -   Computing bootstrap CIs (100 iterations)...
2025-10-17 22:06:15,468 - utils.continuous_models - INFO -   Length: 95% CI = [1.561, 2.534]
2025-10-17 22:06:15,468 - utils.continuous_models - INFO -   Frequency: 95% CI = [1.645, 2.586]
2025-10-17 22:06:15,469 - utils.continuous_models - INFO -   Surprisal: 95% CI = [1.921, 3.074]
2025-10-17 22:06:15,469 - utils.continuous_models - INFO - 
5. RECOMBINING TO EXPECTED ERT
2025-10-17 22:06:15,540 - utils.continuous_models - INFO -   Predicting expected ERT...
2025-10-17 22:06:15,873 - utils.continuous_models - INFO -   Predicted ERT for 326,496 words
2025-10-17 22:06:15,875 - utils.continuous_models - INFO -     Mean predicted ERT: 143.91ms
2025-10-17 22:06:15,877 - utils.continuous_models - INFO -     Mean observed ERT: 236.03ms
2025-10-17 22:06:15,893 - utils.gap_decomposition - INFO - ============================================================
2025-10-17 22:06:15,893 - utils.gap_decomposition - INFO - PART C: GAP DECOMPOSITION
2025-10-17 22:06:15,894 - utils.gap_decomposition - INFO - ============================================================
2025-10-17 22:06:15,980 - utils.gap_decomposition - INFO - 
Fitting M0...
2025-10-17 22:06:15,981 - utils.gap_decomposition - INFO -   Formula: ERT ~ dyslexic_int
2025-10-17 22:06:16,374 - utils.gap_decomposition - INFO -   M0 fitted successfully
2025-10-17 22:06:16,374 - utils.gap_decomposition - INFO - 
Fitting M1...
2025-10-17 22:06:16,374 - utils.gap_decomposition - INFO -   Formula: ERT ~ dyslexic_int * word_length_scaled
2025-10-17 22:06:17,126 - utils.gap_decomposition - INFO -   M1 fitted successfully
2025-10-17 22:06:17,126 - utils.gap_decomposition - INFO - 
Fitting M2...
2025-10-17 22:06:17,127 - utils.gap_decomposition - INFO -   Formula: ERT ~ dyslexic_int * (word_length_scaled + word_frequency_zipf_scaled)
2025-10-17 22:06:17,841 - utils.gap_decomposition - INFO -   M2 fitted successfully
2025-10-17 22:06:17,842 - utils.gap_decomposition - INFO - 
Fitting M3...
2025-10-17 22:06:17,842 - utils.gap_decomposition - INFO -   Formula: ERT ~ dyslexic_int * (word_length_scaled + word_frequency_zipf_scaled + surprisal_scaled)
2025-10-17 22:06:18,705 - utils.gap_decomposition - INFO -   M3 fitted successfully
2025-10-17 22:06:18,729 - utils.gap_decomposition - INFO - 
Computing counterfactual gaps...
2025-10-17 22:06:19,436 - utils.gap_decomposition - INFO -   M0: Gap = 4.46ms
2025-10-17 22:06:19,608 - utils.gap_decomposition - INFO -   M1: Gap = -2.71ms
2025-10-17 22:06:19,841 - utils.gap_decomposition - INFO -   M2: Gap = 7.27ms
2025-10-17 22:06:20,226 - utils.gap_decomposition - INFO -   M3: Gap = -0.39ms
2025-10-17 22:06:20,271 - utils.gap_decomposition - INFO - 
Computing marginal R²...
2025-10-17 22:06:20,423 - utils.gap_decomposition - INFO -   M0: R² = -0.6099
2025-10-17 22:06:20,530 - utils.gap_decomposition - INFO -   M1: R² = -0.4924
2025-10-17 22:06:20,656 - utils.gap_decomposition - INFO -   M2: R² = -0.5684
2025-10-17 22:06:20,798 - utils.gap_decomposition - INFO -   M3: R² = -0.3842
2025-10-17 22:06:20,822 - utils.gap_decomposition - INFO - 
GAP DECOMPOSITION SUMMARY:
2025-10-17 22:06:20,822 - utils.gap_decomposition - INFO -   Baseline gap (M0): 4.46ms
2025-10-17 22:06:20,832 - utils.sensitivity_analysis - INFO - ============================================================
2025-10-17 22:06:20,832 - utils.sensitivity_analysis - INFO - SENSITIVITY ANALYSES
2025-10-17 22:06:20,832 - utils.sensitivity_analysis - INFO - ============================================================
2025-10-17 22:06:20,832 - utils.sensitivity_analysis - INFO - 
1. RESIDUALIZED SURPRISAL MODEL
2025-10-17 22:06:20,888 - utils.sensitivity_analysis - INFO -   Formula: ERT ~ dyslexic_int * (word_length_scaled + word_frequency_zipf_scaled + surprisal_resid)
2025-10-17 22:06:21,467 - utils.sensitivity_analysis - INFO -   Residualized surprisal: beta=11.6330, p=0.0000
2025-10-17 22:06:21,481 - utils.sensitivity_analysis - INFO - 
2. SUBJECT-WISE CROSS-VALIDATION
2025-10-17 22:06:21,481 - utils.sensitivity_analysis - INFO -   Running 10-fold subject-wise CV...
2025-10-17 22:06:21,758 - utils.sensitivity_analysis - INFO -     Fold 1/10
2025-10-17 22:06:22,398 - utils.sensitivity_analysis - INFO -     Fold 2/10
2025-10-17 22:06:23,157 - utils.sensitivity_analysis - INFO -     Fold 3/10
2025-10-17 22:06:23,906 - utils.sensitivity_analysis - INFO -     Fold 4/10
2025-10-17 22:06:24,582 - utils.sensitivity_analysis - INFO -     Fold 5/10
2025-10-17 22:06:25,236 - utils.sensitivity_analysis - INFO -     Fold 6/10
2025-10-17 22:06:26,560 - utils.sensitivity_analysis - INFO -     Fold 7/10
2025-10-17 22:06:27,222 - utils.sensitivity_analysis - INFO -     Fold 8/10
2025-10-17 22:06:27,873 - utils.sensitivity_analysis - INFO -     Fold 9/10
2025-10-17 22:06:28,532 - utils.sensitivity_analysis - INFO -     Fold 10/10
2025-10-17 22:06:29,167 - utils.sensitivity_analysis - INFO -   Cross-validation R²: -0.3352 ± 0.2999
2025-10-17 22:06:29,167 - utils.sensitivity_analysis - INFO -   Based on 10 successful folds
2025-10-17 22:06:29,209 - utils.sensitivity_analysis - INFO - 
3. ALTERNATIVE BINNING (Terciles & Quintiles)
2025-10-17 22:06:29,209 - utils.sensitivity_analysis - INFO - 
  Testing terciles...
2025-10-17 22:06:29,570 - utils.sensitivity_analysis - INFO - 
  Testing quintiles...
2025-10-17 22:06:29,812 - utils.hypothesis_visualization - INFO - ============================================================
2025-10-17 22:06:29,813 - utils.hypothesis_visualization - INFO - CREATING VISUALIZATIONS
2025-10-17 22:06:29,813 - utils.hypothesis_visualization - INFO - ============================================================
2025-10-17 22:06:29,818 - utils.hypothesis_visualization - INFO - 
1. Continuous effect curves...
2025-10-17 22:06:31,328 - utils.hypothesis_visualization - INFO -   Saved to results\continuous_effects_with_quartiles.png
2025-10-17 22:06:31,331 - utils.hypothesis_visualization - INFO - 2. Gap decomposition...
2025-10-17 22:06:31,553 - utils.hypothesis_visualization - INFO -   Saved to results\gap_decomposition.png
2025-10-17 22:06:31,554 - utils.hypothesis_visualization - INFO - 3. Slope ratios...
2025-10-17 22:06:31,569 - __main__ - ERROR - Pipeline failed: 'xerr' must not contain negative values
Traceback (most recent call last):
  File "C:\Users\hugos\Desktop\Dyslexia_Time_Paper\Dyslexia_Time_Cost_Analysis\main.py", line 759, in main
    pipeline.run_hypothesis_testing_analysis()  # NEW
  File "C:\Users\hugos\Desktop\Dyslexia_Time_Paper\Dyslexia_Time_Cost_Analysis\main.py", line 434, in run_hypothesis_testing_analysis
    create_hypothesis_testing_visualizations(
  File "C:\Users\hugos\Desktop\Dyslexia_Time_Paper\Dyslexia_Time_Cost_Analysis\utils\hypothesis_visualization.py", line 51, in create_hypothesis_testing_visualizations
    plot_slope_ratios(continuous_results, output_dir / "slope_ratios.png")
  File "C:\Users\hugos\Desktop\Dyslexia_Time_Paper\Dyslexia_Time_Cost_Analysis\utils\hypothesis_visualization.py", line 324, in plot_slope_ratios
    bars = ax.barh(
  File "C:\Users\hugos\miniconda3\envs\dyslexia-time-analysis\lib\site-packages\matplotlib\axes\_axes.py", line 2834, in barh
    patches = self.bar(x=left, height=height, width=width, bottom=y,
  File "C:\Users\hugos\miniconda3\envs\dyslexia-time-analysis\lib\site-packages\matplotlib\__init__.py", line 1524, in inner
    return func(
  File "C:\Users\hugos\miniconda3\envs\dyslexia-time-analysis\lib\site-packages\matplotlib\axes\_axes.py", line 2676, in bar
    errorbar = self.errorbar(ex, ey, yerr=yerr, xerr=xerr, fmt='none',
  File "C:\Users\hugos\miniconda3\envs\dyslexia-time-analysis\lib\site-packages\matplotlib\_api\deprecation.py", line 453, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\hugos\miniconda3\envs\dyslexia-time-analysis\lib\site-packages\matplotlib\__init__.py", line 1524, in inner
    return func(
  File "C:\Users\hugos\miniconda3\envs\dyslexia-time-analysis\lib\site-packages\matplotlib\axes\_axes.py", line 3825, in errorbar
    raise ValueError(
ValueError: 'xerr' must not contain negative values
2025-10-17 22:15:31,664 - __main__ - INFO - Dyslexia Time Analysis Pipeline initialized
2025-10-17 22:15:31,665 - __main__ - INFO - Dyslexia Time Analysis Pipeline initialized
2025-10-17 22:15:36,761 - __main__ - INFO - Running hypothesis testing analysis...
2025-10-17 22:15:36,761 - __main__ - INFO - ================================================================================
2025-10-17 22:15:36,761 - __main__ - INFO - HYPOTHESIS TESTING ANALYSIS
2025-10-17 22:15:36,761 - __main__ - INFO - ================================================================================
2025-10-17 22:15:36,761 - __main__ - INFO - Loading CopCo dataset...
2025-10-17 22:15:36,762 - utils.data_utils - INFO - Loading 57 participant files...
2025-10-17 22:15:38,619 - utils.data_utils - INFO - Starting with 335,203 total word entries
2025-10-17 22:15:38,841 - utils.data_utils - INFO - Word fixation patterns:
2025-10-17 22:15:38,841 - utils.data_utils - INFO -   - Skipped words (0 fixations): 126,302
2025-10-17 22:15:38,841 - utils.data_utils - INFO -   - Fixated words (1+ fixations): 208,901
2025-10-17 22:15:38,842 - utils.data_utils - INFO -   - Unknown fixations (NaN): 0
2025-10-17 22:15:38,878 - utils.data_utils - INFO - Fixated words reading times: median 272ms, 99th percentile 1777ms
2025-10-17 22:15:38,881 - utils.data_utils - INFO - Removed 14 fixated words with extreme reading times (0 too short, 14 too long)
2025-10-17 22:15:38,993 - utils.data_utils - INFO - Removed 23 words longer than 30 characters (likely data errors)
2025-10-17 22:15:39,037 - utils.data_utils - INFO - Final dataset: 126,302 skipped words, 208,864 fixated words
2025-10-17 22:15:39,038 - utils.data_utils - INFO - Data cleaning complete: 335,166 words retained (100.0% of original)
2025-10-17 22:15:39,048 - utils.data_utils - INFO - Groups identified: 19 dyslexic, 39 control
2025-10-17 22:15:39,120 - __main__ - INFO - Calculating skipping probabilities...
2025-10-17 22:15:39,124 - utils.skipping_utils - INFO - Skipping analysis from ExtractedFeatures:
2025-10-17 22:15:39,124 - utils.skipping_utils - INFO -   Total words: 335,166
2025-10-17 22:15:39,124 - utils.skipping_utils - INFO -   Skipped: 126,302 (37.7%)
2025-10-17 22:15:39,124 - utils.skipping_utils - INFO -   Fixated: 208,864 (62.3%)
2025-10-17 22:15:39,173 - __main__ - INFO - Skipping analysis: 37.7% overall rate
2025-10-17 22:15:39,192 - __main__ - INFO - Loaded: 335,166 words from 57 participants
2025-10-17 22:15:39,192 - __main__ - INFO - ============================================================
2025-10-17 22:15:39,192 - __main__ - INFO - COMPUTING LINGUISTIC FEATURES
2025-10-17 22:15:39,193 - __main__ - INFO - ============================================================
2025-10-17 22:15:39,193 - utils.linguistic_features - INFO - Loading Danish frequency list from danish_frequencies\danish_leipzig_for_analysis.txt
2025-10-17 22:15:40,673 - utils.linguistic_features - WARNING - Found 2 duplicate words after lowercasing. 
2025-10-17 22:15:41,101 - utils.linguistic_features - INFO - Loaded 1,499,999 word proportions from Leipzig Corpora
2025-10-17 22:15:41,187 - utils.linguistic_features - INFO - Computing word frequency...
2025-10-17 22:15:41,187 - utils.linguistic_features - INFO -   Stripping punctuation from words before frequency lookup
2025-10-17 22:15:41,871 - utils.linguistic_features - INFO - 13 missing word instances were punctuation-only
2025-10-17 22:15:41,871 - utils.linguistic_features - WARNING - 4,586 word instances (1.4%) not found in frequency list (197 unique valid words)
2025-10-17 22:15:41,871 - utils.linguistic_features - INFO - Sample of 197 missing valid words: ['2000-direktiverne', '3.g-underholdning', 'adunyadet', 'at blomsterstanden er', 'bjergstien', 'cybermind', 'downcycling', 'drengekammeraterne', 'ecodesign-direktivet', 'elevrådsarrangementer', 'en klase med', 'forbrugsopgjorte', 'frederiksavn', 'frejakult', 'født 16', 'grillparties', 'havstrategidirektivets', 'heksejagte', 'henrik (prinsgemalen', 'hetzbølger', 'herne', 'itx-klasse', 'jedi (2017', 'kabeltromlerne', 'kusine, christine', 'lgbtqi-diskrimination', 'lgbtqi-rettigheder', 'lærerindejob', 'lærerstuderene', 'løvmand og', 'med prins', 'midsommeraftner', 'minervafester', 'nabofolkeslag', 'naturlovgivning', 'nul-fejlkultur', 'nyreligiøst', 'palme (1927-1986', 'palme har', 'ph.d.-stilling', 'på charlottenborg', 'skraldefester', 'snaksalighed', 'tilran', 'traume for', 'tscherning (1817-1890', 'vandmiljøindsats', 'vindmølle-testanlægget', 'åbningsriffet', 'årstidshjulet']... (147 more)
2025-10-17 22:15:41,878 - utils.linguistic_features - INFO - Excluding 4,599 word instances (1.4%) with missing frequencies from analysis
2025-10-17 22:15:42,019 - utils.linguistic_features - INFO - Remaining dataset: 330,567 words
2025-10-17 22:15:42,019 - utils.linguistic_features - INFO - Final dataset: 330,567 words with valid frequencies
2025-10-17 22:15:46,551 - utils.linguistic_features - INFO - Loading causal language model: KennethTM/gpt2-medium-danish
2025-10-17 22:15:48,133 - utils.linguistic_features - INFO - Using CPU for surprisal computation
2025-10-17 22:15:48,133 - utils.linguistic_features - INFO - Causal language model loaded successfully
2025-10-17 22:15:48,133 - utils.linguistic_features - INFO - Computing surprisal with causal GPT-2 (left-to-right)...
2025-10-17 22:15:49,424 - utils.linguistic_features - INFO - Dataset statistics:
2025-10-17 22:15:49,424 - utils.linguistic_features - INFO -   Total participant-sentence instances: 20,707
2025-10-17 22:15:49,424 - utils.linguistic_features - INFO -   Unique sentence texts: 1,986
2025-10-17 22:15:49,425 - utils.linguistic_features - INFO -   Average participants per sentence: 10.4
2025-10-17 22:15:49,425 - utils.linguistic_features - INFO - Loading cached surprisal values from word_surprisal\surprisal_cache_gpt2.pkl
2025-10-17 22:15:49,438 - utils.linguistic_features - INFO - Loaded surprisal for 1,986 unique sentences
2025-10-17 22:15:49,439 - utils.linguistic_features - INFO - Broadcasting surprisal values to all participant instances...
2025-10-17 22:15:49,439 - utils.linguistic_features - INFO -   Mapping surprisal to words...
2025-10-17 22:15:52,807 - utils.linguistic_features - INFO -   Mapped 326,496 words
2025-10-17 22:15:52,809 - utils.linguistic_features - INFO - 
Surprisal Computation Results:
2025-10-17 22:15:52,809 - utils.linguistic_features - INFO -   Unique sentences processed: 1,986
2025-10-17 22:15:52,809 - utils.linguistic_features - INFO -   Total words with surprisal: 326,496 / 330,567
2025-10-17 22:15:52,810 - utils.linguistic_features - INFO -   Mean: 6.93 bits
2025-10-17 22:15:52,813 - utils.linguistic_features - INFO -   Median: 5.69 bits
2025-10-17 22:15:52,815 - utils.linguistic_features - INFO -   Std: 5.55 bits
2025-10-17 22:15:52,816 - utils.linguistic_features - INFO -   Range: [0.00, 59.34] bits
2025-10-17 22:15:52,835 - utils.linguistic_features - INFO - Linguistic features added successfully
2025-10-17 22:15:52,836 - utils.linguistic_features - INFO - 
Feature Summary:
2025-10-17 22:15:52,839 - utils.linguistic_features - INFO -   Word length: mean=4.67, std=3.08
2025-10-17 22:15:52,842 - utils.linguistic_features - INFO -   Zipf frequency: mean=5.85, std=1.38, range=[0.91, 7.51]
2025-10-17 22:15:52,845 - utils.linguistic_features - INFO -   Surprisal: mean=6.93, std=5.55
2025-10-17 22:15:52,857 - utils.hypothesis_testing_utils - INFO - Preparing data for hypothesis testing...
2025-10-17 22:15:52,913 - utils.hypothesis_testing_utils - INFO - Creating ERT variable...
2025-10-17 22:15:52,916 - utils.hypothesis_testing_utils - INFO -   ERT created: 123,666 skipped (0ms), 206,901 fixated
2025-10-17 22:15:52,916 - utils.hypothesis_testing_utils - INFO - Centering and scaling predictors...
2025-10-17 22:15:52,934 - utils.hypothesis_testing_utils - INFO -   word_length: mean=4.67, scale=3.08
2025-10-17 22:15:52,949 - utils.hypothesis_testing_utils - INFO -   word_frequency_zipf: mean=5.85, scale=1.38
2025-10-17 22:15:52,965 - utils.hypothesis_testing_utils - INFO -   surprisal: mean=6.93, scale=5.55
2025-10-17 22:15:52,965 - utils.hypothesis_testing_utils - INFO - Checking collinearity (VIF)...
2025-10-17 22:15:53,097 - utils.hypothesis_testing_utils - INFO - VIF Results:
2025-10-17 22:15:53,097 - utils.hypothesis_testing_utils - INFO -   Length: 2.82 (OK)
2025-10-17 22:15:53,097 - utils.hypothesis_testing_utils - INFO -   Frequency: 3.18 (OK)
2025-10-17 22:15:53,098 - utils.hypothesis_testing_utils - INFO -   Surprisal: 1.41 (OK)
2025-10-17 22:15:53,098 - utils.hypothesis_testing_utils - INFO - Creating residualized surprisal...
2025-10-17 22:15:53,113 - utils.hypothesis_testing_utils - INFO -   Correlation (Frequency-Surprisal): r=-0.539
2025-10-17 22:15:53,113 - utils.hypothesis_testing_utils - INFO -   Residualized surprisal created
2025-10-17 22:15:53,113 - utils.hypothesis_testing_utils - INFO - Defining pooled quartiles...
2025-10-17 22:15:53,128 - utils.hypothesis_testing_utils - INFO -   word_length: Q1=2.00, Q3=6.00
2025-10-17 22:15:53,141 - utils.hypothesis_testing_utils - INFO -   word_frequency_zipf: Q1=4.91, Q3=7.10
2025-10-17 22:15:53,154 - utils.hypothesis_testing_utils - INFO -   surprisal: Q1=2.76, Q3=9.97
2025-10-17 22:15:53,154 - utils.hypothesis_testing_utils - INFO - Data preparation complete: 330,567 words ready for analysis
2025-10-17 22:15:53,165 - utils.quartile_analysis - INFO - ============================================================
2025-10-17 22:15:53,166 - utils.quartile_analysis - INFO - PART A: QUARTILE ANALYSIS (Q1 vs Q3)
2025-10-17 22:15:53,166 - utils.quartile_analysis - INFO - ============================================================
2025-10-17 22:15:53,166 - utils.quartile_analysis - INFO - 
Analyzing word_length...
2025-10-17 22:15:53,983 - utils.quartile_analysis - INFO -   Computed means for 57 participants
2025-10-17 22:15:53,984 - utils.quartile_analysis - INFO -     Control Q3-Q1: 259.7ms
2025-10-17 22:15:53,984 - utils.quartile_analysis - INFO -     Dyslexic Q3-Q1: 442.6ms
2025-10-17 22:15:54,044 - utils.quartile_analysis - INFO -   Fitting mixed model on 152,465 words...
2025-10-17 22:15:54,652 - utils.quartile_analysis - INFO -   Group×Bin interaction: beta=134.79, p=0.0000
2025-10-17 22:15:54,678 - utils.quartile_analysis - INFO -   Computing bootstrap CIs (1000 iterations)...
2025-10-17 22:15:56,403 - utils.quartile_analysis - INFO -   Bootstrap 95% CI for interaction: [98.47, 259.71]
2025-10-17 22:15:56,405 - utils.quartile_analysis - INFO - 
Analyzing word_frequency_zipf...
2025-10-17 22:15:57,233 - utils.quartile_analysis - INFO -   Computed means for 57 participants
2025-10-17 22:15:57,234 - utils.quartile_analysis - INFO -     Control Q3-Q1: -225.9ms
2025-10-17 22:15:57,234 - utils.quartile_analysis - INFO -     Dyslexic Q3-Q1: -388.2ms
2025-10-17 22:15:57,298 - utils.quartile_analysis - INFO -   Fitting mixed model on 162,606 words...
2025-10-17 22:16:00,114 - utils.quartile_analysis - INFO -   Group×Bin interaction: beta=-122.40, p=0.0000
2025-10-17 22:16:00,148 - utils.quartile_analysis - INFO -   Computing bootstrap CIs (1000 iterations)...
2025-10-17 22:16:01,901 - utils.quartile_analysis - INFO -   Bootstrap 95% CI for interaction: [-225.59, -87.90]
2025-10-17 22:16:01,902 - utils.quartile_analysis - INFO - 
Analyzing surprisal...
2025-10-17 22:16:02,725 - utils.quartile_analysis - INFO -   Computed means for 57 participants
2025-10-17 22:16:02,726 - utils.quartile_analysis - INFO -     Control Q3-Q1: 135.8ms
2025-10-17 22:16:02,727 - utils.quartile_analysis - INFO -     Dyslexic Q3-Q1: 277.3ms
2025-10-17 22:16:02,792 - utils.quartile_analysis - INFO -   Fitting mixed model on 163,257 words...
2025-10-17 22:16:05,424 - utils.quartile_analysis - INFO -   Group×Bin interaction: beta=105.53, p=0.0000
2025-10-17 22:16:05,460 - utils.quartile_analysis - INFO -   Computing bootstrap CIs (1000 iterations)...
2025-10-17 22:16:07,221 - utils.quartile_analysis - INFO -   Bootstrap 95% CI for interaction: [84.99, 194.82]
2025-10-17 22:16:07,221 - utils.continuous_models - INFO - ============================================================
2025-10-17 22:16:07,221 - utils.continuous_models - INFO - PART B: CONTINUOUS MODELS (TWO-PART)
2025-10-17 22:16:07,222 - utils.continuous_models - INFO - ============================================================
2025-10-17 22:16:07,222 - utils.continuous_models - INFO - 
1. SKIPPING MODEL (Logistic)
2025-10-17 22:16:07,325 - utils.continuous_models - INFO -   Formula: skipped ~ dyslexic_int * (word_length_scaled + word_frequency_zipf_scaled + surprisal_scaled)
2025-10-17 22:16:07,326 - utils.continuous_models - INFO -   Fitting on 326,496 words...
2025-10-17 22:16:07,803 - utils.continuous_models - INFO -   Model fitted successfully
2025-10-17 22:16:07,804 - utils.continuous_models - INFO -     dyslexic_int:word_length_scaled: beta=-0.0250, p=0.2274
2025-10-17 22:16:07,804 - utils.continuous_models - INFO -     dyslexic_int:word_frequency_zipf_scaled: beta=-0.0640, p=0.0004
2025-10-17 22:16:07,805 - utils.continuous_models - INFO -     dyslexic_int:surprisal_scaled: beta=-0.0272, p=0.0203
2025-10-17 22:16:07,814 - utils.continuous_models - INFO - 
2. DURATION MODEL (Log-TRT | Fixated)
2025-10-17 22:16:07,940 - utils.continuous_models - INFO -   Formula: log_TRT ~ dyslexic_int * (word_length_scaled + word_frequency_zipf_scaled + surprisal_scaled)
2025-10-17 22:16:07,941 - utils.continuous_models - INFO -   Fitting on 204,224 fixated words...
2025-10-17 22:16:09,037 - utils.continuous_models - INFO -   Model fitted successfully
2025-10-17 22:16:09,037 - utils.continuous_models - INFO -   Smearing correction factor: 1.1562
2025-10-17 22:16:09,038 - utils.continuous_models - INFO -     dyslexic_int:word_length_scaled: beta=0.0078, p=0.0585
2025-10-17 22:16:09,038 - utils.continuous_models - INFO -     dyslexic_int:word_frequency_zipf_scaled: beta=-0.0084, p=0.0678
2025-10-17 22:16:09,038 - utils.continuous_models - INFO -     dyslexic_int:surprisal_scaled: beta=0.0349, p=0.0000
2025-10-17 22:16:09,048 - utils.continuous_models - INFO - 
3. SLOPE RATIOS (Dyslexic Amplification)
2025-10-17 22:16:09,049 - utils.continuous_models - INFO -   Length: SR = 1.064 (AMPLIFIED)
2025-10-17 22:16:09,049 - utils.continuous_models - INFO -   Frequency: SR = 1.173 (AMPLIFIED)
2025-10-17 22:16:09,049 - utils.continuous_models - INFO -   Surprisal: SR = 2.100 (AMPLIFIED)
2025-10-17 22:16:09,049 - utils.continuous_models - INFO - 
4. BOOTSTRAP CONFIDENCE INTERVALS
2025-10-17 22:16:09,049 - utils.continuous_models - INFO -   Computing bootstrap CIs (100 iterations)...
2025-10-17 22:16:10,359 - utils.continuous_models - INFO -   Length: 95% CI = [1.561, 2.534]
2025-10-17 22:16:10,360 - utils.continuous_models - INFO -   Frequency: 95% CI = [1.645, 2.586]
2025-10-17 22:16:10,360 - utils.continuous_models - INFO -   Surprisal: 95% CI = [1.921, 3.074]
2025-10-17 22:16:10,361 - utils.continuous_models - INFO - 
5. RECOMBINING TO EXPECTED ERT
2025-10-17 22:16:10,404 - utils.continuous_models - INFO -   Predicting expected ERT...
2025-10-17 22:16:10,647 - utils.continuous_models - INFO -   Predicted ERT for 326,496 words
2025-10-17 22:16:10,649 - utils.continuous_models - INFO -     Mean predicted ERT: 143.91ms
2025-10-17 22:16:10,650 - utils.continuous_models - INFO -     Mean observed ERT: 236.03ms
2025-10-17 22:16:10,658 - utils.gap_decomposition - INFO - ============================================================
2025-10-17 22:16:10,659 - utils.gap_decomposition - INFO - PART C: GAP DECOMPOSITION
2025-10-17 22:16:10,659 - utils.gap_decomposition - INFO - ============================================================
2025-10-17 22:16:10,714 - utils.gap_decomposition - INFO - 
Fitting M0...
2025-10-17 22:16:10,715 - utils.gap_decomposition - INFO -   Formula: ERT ~ dyslexic_int
2025-10-17 22:16:11,015 - utils.gap_decomposition - INFO -   M0 fitted successfully
2025-10-17 22:16:11,015 - utils.gap_decomposition - INFO - 
Fitting M1...
2025-10-17 22:16:11,016 - utils.gap_decomposition - INFO -   Formula: ERT ~ dyslexic_int * word_length_scaled
2025-10-17 22:16:11,806 - utils.gap_decomposition - INFO -   M1 fitted successfully
2025-10-17 22:16:11,807 - utils.gap_decomposition - INFO - 
Fitting M2...
2025-10-17 22:16:11,807 - utils.gap_decomposition - INFO -   Formula: ERT ~ dyslexic_int * (word_length_scaled + word_frequency_zipf_scaled)
2025-10-17 22:16:12,397 - utils.gap_decomposition - INFO -   M2 fitted successfully
2025-10-17 22:16:12,398 - utils.gap_decomposition - INFO - 
Fitting M3...
2025-10-17 22:16:12,398 - utils.gap_decomposition - INFO -   Formula: ERT ~ dyslexic_int * (word_length_scaled + word_frequency_zipf_scaled + surprisal_scaled)
2025-10-17 22:16:13,015 - utils.gap_decomposition - INFO -   M3 fitted successfully
2025-10-17 22:16:13,026 - utils.gap_decomposition - INFO - 
Computing counterfactual gaps...
2025-10-17 22:16:13,259 - utils.gap_decomposition - INFO -   M0: Gap = 4.46ms
2025-10-17 22:16:13,438 - utils.gap_decomposition - INFO -   M1: Gap = -2.71ms
2025-10-17 22:16:13,621 - utils.gap_decomposition - INFO -   M2: Gap = 7.27ms
2025-10-17 22:16:13,877 - utils.gap_decomposition - INFO -   M3: Gap = -0.39ms
2025-10-17 22:16:13,920 - utils.gap_decomposition - INFO - 
Computing marginal R²...
2025-10-17 22:16:13,967 - utils.gap_decomposition - INFO -   M0: R² = -0.6099
2025-10-17 22:16:14,002 - utils.gap_decomposition - INFO -   M1: R² = -0.4924
2025-10-17 22:16:14,056 - utils.gap_decomposition - INFO -   M2: R² = -0.5684
2025-10-17 22:16:14,137 - utils.gap_decomposition - INFO -   M3: R² = -0.3842
2025-10-17 22:16:14,137 - utils.gap_decomposition - INFO - 
GAP DECOMPOSITION SUMMARY:
2025-10-17 22:16:14,139 - utils.gap_decomposition - INFO -   Baseline gap (M0): 4.46ms
2025-10-17 22:16:14,139 - utils.gap_decomposition - INFO -   M1: Gap=-2.71ms, Explained=160.7%, DeltaR2=0.1176
2025-10-17 22:16:14,139 - utils.gap_decomposition - INFO -   M2: Gap=7.27ms, Explained=-63.1%, DeltaR2=-0.0760
2025-10-17 22:16:14,139 - utils.gap_decomposition - INFO -   M3: Gap=-0.39ms, Explained=108.7%, DeltaR2=0.1841
2025-10-17 22:16:14,145 - utils.sensitivity_analysis - INFO - ============================================================
2025-10-17 22:16:14,150 - utils.sensitivity_analysis - INFO - SENSITIVITY ANALYSES
2025-10-17 22:16:14,150 - utils.sensitivity_analysis - INFO - ============================================================
2025-10-17 22:16:14,150 - utils.sensitivity_analysis - INFO - 
1. RESIDUALIZED SURPRISAL MODEL
2025-10-17 22:16:14,202 - utils.sensitivity_analysis - INFO -   Formula: ERT ~ dyslexic_int * (word_length_scaled + word_frequency_zipf_scaled + surprisal_resid)
2025-10-17 22:16:14,742 - utils.sensitivity_analysis - INFO -   Residualized surprisal: beta=11.6330, p=0.0000
2025-10-17 22:16:14,761 - utils.sensitivity_analysis - INFO - 
2. SUBJECT-WISE CROSS-VALIDATION
2025-10-17 22:16:14,762 - utils.sensitivity_analysis - INFO -   Running 10-fold subject-wise CV...
2025-10-17 22:16:14,999 - utils.sensitivity_analysis - INFO -     Fold 1/10
2025-10-17 22:16:15,592 - utils.sensitivity_analysis - INFO -     Fold 2/10
2025-10-17 22:16:16,219 - utils.sensitivity_analysis - INFO -     Fold 3/10
2025-10-17 22:16:16,865 - utils.sensitivity_analysis - INFO -     Fold 4/10
2025-10-17 22:16:17,469 - utils.sensitivity_analysis - INFO -     Fold 5/10
2025-10-17 22:16:18,200 - utils.sensitivity_analysis - INFO -     Fold 6/10
2025-10-17 22:16:19,577 - utils.sensitivity_analysis - INFO -     Fold 7/10
2025-10-17 22:16:20,154 - utils.sensitivity_analysis - INFO -     Fold 8/10
2025-10-17 22:16:20,787 - utils.sensitivity_analysis - INFO -     Fold 9/10
2025-10-17 22:16:21,485 - utils.sensitivity_analysis - INFO -     Fold 10/10
2025-10-17 22:16:22,050 - utils.sensitivity_analysis - INFO -   Cross-validation R²: -0.3352 ± 0.2999
2025-10-17 22:16:22,050 - utils.sensitivity_analysis - INFO -   Based on 10 successful folds
2025-10-17 22:16:22,085 - utils.sensitivity_analysis - INFO - 
3. ALTERNATIVE BINNING (Terciles & Quintiles)
2025-10-17 22:16:22,086 - utils.sensitivity_analysis - INFO - 
  Testing terciles...
2025-10-17 22:16:22,450 - utils.sensitivity_analysis - INFO - 
  Testing quintiles...
2025-10-17 22:16:22,704 - utils.hypothesis_visualization - INFO - ============================================================
2025-10-17 22:16:22,704 - utils.hypothesis_visualization - INFO - CREATING VISUALIZATIONS
2025-10-17 22:16:22,704 - utils.hypothesis_visualization - INFO - ============================================================
2025-10-17 22:16:22,707 - utils.hypothesis_visualization - INFO - 
1. Continuous effect curves...
2025-10-17 22:16:24,112 - utils.hypothesis_visualization - INFO -   Saved to results\continuous_effects_with_quartiles.png
2025-10-17 22:16:24,113 - utils.hypothesis_visualization - INFO - 2. Gap decomposition...
2025-10-17 22:16:24,321 - utils.hypothesis_visualization - INFO -   Saved to results\gap_decomposition.png
2025-10-17 22:16:24,321 - utils.hypothesis_visualization - INFO - 3. Slope ratios...
2025-10-17 22:16:24,338 - __main__ - ERROR - Pipeline failed: 'xerr' must not contain negative values
Traceback (most recent call last):
  File "C:\Users\hugos\Desktop\Dyslexia_Time_Paper\Dyslexia_Time_Cost_Analysis\main.py", line 759, in main
    pipeline.run_hypothesis_testing_analysis()  # NEW
  File "C:\Users\hugos\Desktop\Dyslexia_Time_Paper\Dyslexia_Time_Cost_Analysis\main.py", line 434, in run_hypothesis_testing_analysis
    create_hypothesis_testing_visualizations(
  File "C:\Users\hugos\Desktop\Dyslexia_Time_Paper\Dyslexia_Time_Cost_Analysis\utils\hypothesis_visualization.py", line 51, in create_hypothesis_testing_visualizations
    plot_slope_ratios(continuous_results, output_dir / "slope_ratios.png")
  File "C:\Users\hugos\Desktop\Dyslexia_Time_Paper\Dyslexia_Time_Cost_Analysis\utils\hypothesis_visualization.py", line 324, in plot_slope_ratios
    bars = ax.barh(
  File "C:\Users\hugos\miniconda3\envs\dyslexia-time-analysis\lib\site-packages\matplotlib\axes\_axes.py", line 2834, in barh
    patches = self.bar(x=left, height=height, width=width, bottom=y,
  File "C:\Users\hugos\miniconda3\envs\dyslexia-time-analysis\lib\site-packages\matplotlib\__init__.py", line 1524, in inner
    return func(
  File "C:\Users\hugos\miniconda3\envs\dyslexia-time-analysis\lib\site-packages\matplotlib\axes\_axes.py", line 2676, in bar
    errorbar = self.errorbar(ex, ey, yerr=yerr, xerr=xerr, fmt='none',
  File "C:\Users\hugos\miniconda3\envs\dyslexia-time-analysis\lib\site-packages\matplotlib\_api\deprecation.py", line 453, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\hugos\miniconda3\envs\dyslexia-time-analysis\lib\site-packages\matplotlib\__init__.py", line 1524, in inner
    return func(
  File "C:\Users\hugos\miniconda3\envs\dyslexia-time-analysis\lib\site-packages\matplotlib\axes\_axes.py", line 3825, in errorbar
    raise ValueError(
ValueError: 'xerr' must not contain negative values
2025-10-17 22:22:07,811 - __main__ - INFO - Dyslexia Time Analysis Pipeline initialized
2025-10-17 22:22:07,812 - __main__ - INFO - Dyslexia Time Analysis Pipeline initialized
2025-10-17 22:22:10,406 - __main__ - INFO - Running hypothesis testing analysis...
2025-10-17 22:22:10,406 - __main__ - INFO - ================================================================================
2025-10-17 22:22:10,407 - __main__ - INFO - HYPOTHESIS TESTING ANALYSIS
2025-10-17 22:22:10,407 - __main__ - INFO - ================================================================================
2025-10-17 22:22:10,407 - __main__ - INFO - Loading CopCo dataset...
2025-10-17 22:22:10,408 - utils.data_utils - INFO - Loading 57 participant files...
2025-10-17 22:22:12,261 - utils.data_utils - INFO - Starting with 335,203 total word entries
2025-10-17 22:22:12,458 - utils.data_utils - INFO - Word fixation patterns:
2025-10-17 22:22:12,458 - utils.data_utils - INFO -   - Skipped words (0 fixations): 126,302
2025-10-17 22:22:12,458 - utils.data_utils - INFO -   - Fixated words (1+ fixations): 208,901
2025-10-17 22:22:12,459 - utils.data_utils - INFO -   - Unknown fixations (NaN): 0
2025-10-17 22:22:12,492 - utils.data_utils - INFO - Fixated words reading times: median 272ms, 99th percentile 1777ms
2025-10-17 22:22:12,494 - utils.data_utils - INFO - Removed 14 fixated words with extreme reading times (0 too short, 14 too long)
2025-10-17 22:22:12,596 - utils.data_utils - INFO - Removed 23 words longer than 30 characters (likely data errors)
2025-10-17 22:22:12,636 - utils.data_utils - INFO - Final dataset: 126,302 skipped words, 208,864 fixated words
2025-10-17 22:22:12,636 - utils.data_utils - INFO - Data cleaning complete: 335,166 words retained (100.0% of original)
2025-10-17 22:22:12,644 - utils.data_utils - INFO - Groups identified: 19 dyslexic, 39 control
2025-10-17 22:22:12,716 - __main__ - INFO - Calculating skipping probabilities...
2025-10-17 22:22:12,719 - utils.skipping_utils - INFO - Skipping analysis from ExtractedFeatures:
2025-10-17 22:22:12,720 - utils.skipping_utils - INFO -   Total words: 335,166
2025-10-17 22:22:12,720 - utils.skipping_utils - INFO -   Skipped: 126,302 (37.7%)
2025-10-17 22:22:12,720 - utils.skipping_utils - INFO -   Fixated: 208,864 (62.3%)
2025-10-17 22:22:12,768 - __main__ - INFO - Skipping analysis: 37.7% overall rate
2025-10-17 22:22:12,787 - __main__ - INFO - Loaded: 335,166 words from 57 participants
2025-10-17 22:22:12,788 - __main__ - INFO - ============================================================
2025-10-17 22:22:12,788 - __main__ - INFO - COMPUTING LINGUISTIC FEATURES
2025-10-17 22:22:12,788 - __main__ - INFO - ============================================================
2025-10-17 22:22:12,788 - utils.linguistic_features - INFO - Loading Danish frequency list from danish_frequencies\danish_leipzig_for_analysis.txt
2025-10-17 22:22:14,266 - utils.linguistic_features - WARNING - Found 2 duplicate words after lowercasing. 
2025-10-17 22:22:14,690 - utils.linguistic_features - INFO - Loaded 1,499,999 word proportions from Leipzig Corpora
2025-10-17 22:22:14,794 - utils.linguistic_features - INFO - Computing word frequency...
2025-10-17 22:22:14,794 - utils.linguistic_features - INFO -   Stripping punctuation from words before frequency lookup
2025-10-17 22:22:15,510 - utils.linguistic_features - INFO - 13 missing word instances were punctuation-only
2025-10-17 22:22:15,511 - utils.linguistic_features - WARNING - 4,586 word instances (1.4%) not found in frequency list (197 unique valid words)
2025-10-17 22:22:15,511 - utils.linguistic_features - INFO - Sample of 197 missing valid words: ['3.g-underholdning', '9. og dronning', 'af j.j', 'af kong', 'affaldspolitikken', 'alauda', 'at blomsterstanden er', 'blæredygtige', 'broderet messehagler og', 'by-spildevandet', 'cølibatægteskabet', 'drengekammeraterne', 'ecodesign-direktivet', 'finansudspil', 'flensborggården', 'første krigsminister, a.f', 'go-to-ting', 'grillparties', 'hejre (bromus', 'heksejagte', 'højskoledanmark', 'her', 'i græs-familien', 'i star', 'istandgøre', 'kaldet lemma', 'klimatilpasningspakke', 'lederun', 'lgbtqi-familien', 'lgbtqi-personer', 'lgbtqi-rettigheder', 'ligusteragtig', 'livsresultat', 'lysfester', 'midsommeraftner', 'midsommerfælleskabet', 'minervafester', 'nivaagaard-tradition', 'phumiphon', 'på charlottenborg', 'siden margrethe', 'solhversfesten', 'spákona', 'stress-sygdomme', 'tilran', 'traume for', 'tscherning (1817-1890', 'valborgsnatten', 'vindmøllehoveder', 'åbningsriffet']... (147 more)
2025-10-17 22:22:15,525 - utils.linguistic_features - INFO - Excluding 4,599 word instances (1.4%) with missing frequencies from analysis
2025-10-17 22:22:15,659 - utils.linguistic_features - INFO - Remaining dataset: 330,567 words
2025-10-17 22:22:15,660 - utils.linguistic_features - INFO - Final dataset: 330,567 words with valid frequencies
2025-10-17 22:22:19,972 - utils.linguistic_features - INFO - Loading causal language model: KennethTM/gpt2-medium-danish
2025-10-17 22:22:21,584 - utils.linguistic_features - INFO - Using CPU for surprisal computation
2025-10-17 22:22:21,585 - utils.linguistic_features - INFO - Causal language model loaded successfully
2025-10-17 22:22:21,585 - utils.linguistic_features - INFO - Computing surprisal with causal GPT-2 (left-to-right)...
2025-10-17 22:22:22,878 - utils.linguistic_features - INFO - Dataset statistics:
2025-10-17 22:22:22,879 - utils.linguistic_features - INFO -   Total participant-sentence instances: 20,707
2025-10-17 22:22:22,879 - utils.linguistic_features - INFO -   Unique sentence texts: 1,986
2025-10-17 22:22:22,879 - utils.linguistic_features - INFO -   Average participants per sentence: 10.4
2025-10-17 22:22:22,879 - utils.linguistic_features - INFO - Loading cached surprisal values from word_surprisal\surprisal_cache_gpt2.pkl
2025-10-17 22:22:22,892 - utils.linguistic_features - INFO - Loaded surprisal for 1,986 unique sentences
2025-10-17 22:22:22,893 - utils.linguistic_features - INFO - Broadcasting surprisal values to all participant instances...
2025-10-17 22:22:22,893 - utils.linguistic_features - INFO -   Mapping surprisal to words...
2025-10-17 22:22:26,376 - utils.linguistic_features - INFO -   Mapped 326,496 words
2025-10-17 22:22:26,377 - utils.linguistic_features - INFO - 
Surprisal Computation Results:
2025-10-17 22:22:26,378 - utils.linguistic_features - INFO -   Unique sentences processed: 1,986
2025-10-17 22:22:26,378 - utils.linguistic_features - INFO -   Total words with surprisal: 326,496 / 330,567
2025-10-17 22:22:26,379 - utils.linguistic_features - INFO -   Mean: 6.93 bits
2025-10-17 22:22:26,385 - utils.linguistic_features - INFO -   Median: 5.69 bits
2025-10-17 22:22:26,388 - utils.linguistic_features - INFO -   Std: 5.55 bits
2025-10-17 22:22:26,389 - utils.linguistic_features - INFO -   Range: [0.00, 59.34] bits
2025-10-17 22:22:26,412 - utils.linguistic_features - INFO - Linguistic features added successfully
2025-10-17 22:22:26,412 - utils.linguistic_features - INFO - 
Feature Summary:
2025-10-17 22:22:26,415 - utils.linguistic_features - INFO -   Word length: mean=4.67, std=3.08
2025-10-17 22:22:26,418 - utils.linguistic_features - INFO -   Zipf frequency: mean=5.85, std=1.38, range=[0.91, 7.51]
2025-10-17 22:22:26,421 - utils.linguistic_features - INFO -   Surprisal: mean=6.93, std=5.55
2025-10-17 22:22:26,439 - utils.hypothesis_testing_utils - INFO - Preparing data for hypothesis testing...
2025-10-17 22:22:26,489 - utils.hypothesis_testing_utils - INFO - Creating ERT variable...
2025-10-17 22:22:26,493 - utils.hypothesis_testing_utils - INFO -   ERT created: 123,666 skipped (0ms), 206,901 fixated
2025-10-17 22:22:26,493 - utils.hypothesis_testing_utils - INFO - Centering and scaling predictors...
2025-10-17 22:22:26,515 - utils.hypothesis_testing_utils - INFO -   word_length: mean=4.67, scale=3.08
2025-10-17 22:22:26,531 - utils.hypothesis_testing_utils - INFO -   word_frequency_zipf: mean=5.85, scale=1.38
2025-10-17 22:22:26,549 - utils.hypothesis_testing_utils - INFO -   surprisal: mean=6.93, scale=5.55
2025-10-17 22:22:26,550 - utils.hypothesis_testing_utils - INFO - Checking collinearity (VIF)...
2025-10-17 22:22:26,796 - utils.hypothesis_testing_utils - INFO - VIF Results:
2025-10-17 22:22:26,796 - utils.hypothesis_testing_utils - INFO -   Length: 2.82 (OK)
2025-10-17 22:22:26,798 - utils.hypothesis_testing_utils - INFO -   Frequency: 3.18 (OK)
2025-10-17 22:22:26,798 - utils.hypothesis_testing_utils - INFO -   Surprisal: 1.41 (OK)
2025-10-17 22:22:26,798 - utils.hypothesis_testing_utils - INFO - Creating residualized surprisal...
2025-10-17 22:22:26,814 - utils.hypothesis_testing_utils - INFO -   Correlation (Frequency-Surprisal): r=-0.539
2025-10-17 22:22:26,814 - utils.hypothesis_testing_utils - INFO -   Residualized surprisal created
2025-10-17 22:22:26,814 - utils.hypothesis_testing_utils - INFO - Defining pooled quartiles...
2025-10-17 22:22:26,829 - utils.hypothesis_testing_utils - INFO -   word_length: Q1=2.00, Q3=6.00
2025-10-17 22:22:26,842 - utils.hypothesis_testing_utils - INFO -   word_frequency_zipf: Q1=4.91, Q3=7.10
2025-10-17 22:22:26,855 - utils.hypothesis_testing_utils - INFO -   surprisal: Q1=2.76, Q3=9.97
2025-10-17 22:22:26,855 - utils.hypothesis_testing_utils - INFO - Data preparation complete: 330,567 words ready for analysis
2025-10-17 22:22:26,868 - utils.quartile_analysis - INFO - ============================================================
2025-10-17 22:22:26,868 - utils.quartile_analysis - INFO - PART A: QUARTILE ANALYSIS (Q1 vs Q3)
2025-10-17 22:22:26,868 - utils.quartile_analysis - INFO - ============================================================
2025-10-17 22:22:26,869 - utils.quartile_analysis - INFO - 
Analyzing word_length...
2025-10-17 22:22:27,689 - utils.quartile_analysis - INFO -   Computed means for 57 participants
2025-10-17 22:22:27,691 - utils.quartile_analysis - INFO -     Control Q3-Q1: 259.7ms
2025-10-17 22:22:27,691 - utils.quartile_analysis - INFO -     Dyslexic Q3-Q1: 442.6ms
2025-10-17 22:22:27,752 - utils.quartile_analysis - INFO -   Fitting mixed model on 152,465 words...
2025-10-17 22:22:28,420 - utils.quartile_analysis - INFO -   Group×Bin interaction: beta=134.79, p=0.0000
2025-10-17 22:22:28,453 - utils.quartile_analysis - INFO -   Computing bootstrap CIs (1000 iterations)...
2025-10-17 22:22:30,226 - utils.quartile_analysis - INFO -   Bootstrap 95% CI for interaction: [98.47, 259.71]
2025-10-17 22:22:30,226 - utils.quartile_analysis - INFO - 
Analyzing word_frequency_zipf...
2025-10-17 22:22:31,050 - utils.quartile_analysis - INFO -   Computed means for 57 participants
2025-10-17 22:22:31,052 - utils.quartile_analysis - INFO -     Control Q3-Q1: -225.9ms
2025-10-17 22:22:31,052 - utils.quartile_analysis - INFO -     Dyslexic Q3-Q1: -388.2ms
2025-10-17 22:22:31,116 - utils.quartile_analysis - INFO -   Fitting mixed model on 162,606 words...
2025-10-17 22:22:34,056 - utils.quartile_analysis - INFO -   Group×Bin interaction: beta=-122.40, p=0.0000
2025-10-17 22:22:34,092 - utils.quartile_analysis - INFO -   Computing bootstrap CIs (1000 iterations)...
2025-10-17 22:22:35,877 - utils.quartile_analysis - INFO -   Bootstrap 95% CI for interaction: [-225.59, -87.90]
2025-10-17 22:22:35,877 - utils.quartile_analysis - INFO - 
Analyzing surprisal...
2025-10-17 22:22:36,703 - utils.quartile_analysis - INFO -   Computed means for 57 participants
2025-10-17 22:22:36,703 - utils.quartile_analysis - INFO -     Control Q3-Q1: 135.8ms
2025-10-17 22:22:36,704 - utils.quartile_analysis - INFO -     Dyslexic Q3-Q1: 277.3ms
2025-10-17 22:22:36,770 - utils.quartile_analysis - INFO -   Fitting mixed model on 163,257 words...
2025-10-17 22:22:39,541 - utils.quartile_analysis - INFO -   Group×Bin interaction: beta=105.53, p=0.0000
2025-10-17 22:22:39,570 - utils.quartile_analysis - INFO -   Computing bootstrap CIs (1000 iterations)...
2025-10-17 22:22:41,369 - utils.quartile_analysis - INFO -   Bootstrap 95% CI for interaction: [84.99, 194.82]
2025-10-17 22:22:41,370 - utils.continuous_models - INFO - ============================================================
2025-10-17 22:22:41,370 - utils.continuous_models - INFO - PART B: CONTINUOUS MODELS (TWO-PART)
2025-10-17 22:22:41,370 - utils.continuous_models - INFO - ============================================================
2025-10-17 22:22:41,370 - utils.continuous_models - INFO - 
1. SKIPPING MODEL (Logistic)
2025-10-17 22:22:41,473 - utils.continuous_models - INFO -   Formula: skipped ~ dyslexic_int * (word_length_scaled + word_frequency_zipf_scaled + surprisal_scaled)
2025-10-17 22:22:41,474 - utils.continuous_models - INFO -   Fitting on 326,496 words...
2025-10-17 22:22:41,882 - utils.continuous_models - INFO -   Model fitted successfully
2025-10-17 22:22:41,883 - utils.continuous_models - INFO -     dyslexic_int:word_length_scaled: beta=-0.0250, p=0.2274
2025-10-17 22:22:41,883 - utils.continuous_models - INFO -     dyslexic_int:word_frequency_zipf_scaled: beta=-0.0640, p=0.0004
2025-10-17 22:22:41,883 - utils.continuous_models - INFO -     dyslexic_int:surprisal_scaled: beta=-0.0272, p=0.0203
2025-10-17 22:22:41,892 - utils.continuous_models - INFO - 
2. DURATION MODEL (Log-TRT | Fixated)
2025-10-17 22:22:42,012 - utils.continuous_models - INFO -   Formula: log_TRT ~ dyslexic_int * (word_length_scaled + word_frequency_zipf_scaled + surprisal_scaled)
2025-10-17 22:22:42,012 - utils.continuous_models - INFO -   Fitting on 204,224 fixated words...
2025-10-17 22:22:43,234 - utils.continuous_models - INFO -   Model fitted successfully
2025-10-17 22:22:43,235 - utils.continuous_models - INFO -   Smearing correction factor: 1.1562
2025-10-17 22:22:43,235 - utils.continuous_models - INFO -     dyslexic_int:word_length_scaled: beta=0.0078, p=0.0585
2025-10-17 22:22:43,236 - utils.continuous_models - INFO -     dyslexic_int:word_frequency_zipf_scaled: beta=-0.0084, p=0.0678
2025-10-17 22:22:43,236 - utils.continuous_models - INFO -     dyslexic_int:surprisal_scaled: beta=0.0349, p=0.0000
2025-10-17 22:22:43,245 - utils.continuous_models - INFO - 
3. SLOPE RATIOS (Dyslexic Amplification)
2025-10-17 22:22:43,246 - utils.continuous_models - INFO -   Length: SR = 1.064 (AMPLIFIED)
2025-10-17 22:22:43,246 - utils.continuous_models - INFO -   Frequency: SR = 1.173 (AMPLIFIED)
2025-10-17 22:22:43,247 - utils.continuous_models - INFO -   Surprisal: SR = 2.100 (AMPLIFIED)
2025-10-17 22:22:43,247 - utils.continuous_models - INFO - 
4. BOOTSTRAP CONFIDENCE INTERVALS
2025-10-17 22:22:43,247 - utils.continuous_models - INFO -   Computing bootstrap CIs (100 iterations)...
2025-10-17 22:22:44,566 - utils.continuous_models - INFO -   Length: 95% CI = [1.561, 2.534]
2025-10-17 22:22:44,567 - utils.continuous_models - INFO -   Frequency: 95% CI = [1.645, 2.586]
2025-10-17 22:22:44,567 - utils.continuous_models - INFO -   Surprisal: 95% CI = [1.921, 3.074]
2025-10-17 22:22:44,567 - utils.continuous_models - INFO - 
5. RECOMBINING TO EXPECTED ERT
2025-10-17 22:22:44,632 - utils.continuous_models - INFO -   Predicting expected ERT...
2025-10-17 22:22:44,905 - utils.continuous_models - INFO -   Predicted ERT for 326,496 words
2025-10-17 22:22:44,907 - utils.continuous_models - INFO -     Mean predicted ERT: 143.91ms
2025-10-17 22:22:44,908 - utils.continuous_models - INFO -     Mean observed ERT: 236.03ms
2025-10-17 22:22:44,922 - utils.gap_decomposition - INFO - ============================================================
2025-10-17 22:22:44,922 - utils.gap_decomposition - INFO - PART C: GAP DECOMPOSITION
2025-10-17 22:22:44,922 - utils.gap_decomposition - INFO - ============================================================
2025-10-17 22:22:44,997 - utils.gap_decomposition - INFO - 
Fitting M0...
2025-10-17 22:22:44,997 - utils.gap_decomposition - INFO -   Formula: ERT ~ dyslexic_int
2025-10-17 22:22:45,382 - utils.gap_decomposition - INFO -   M0 fitted successfully
2025-10-17 22:22:45,382 - utils.gap_decomposition - INFO - 
Fitting M1...
2025-10-17 22:22:45,383 - utils.gap_decomposition - INFO -   Formula: ERT ~ dyslexic_int * word_length_scaled
2025-10-17 22:22:45,917 - utils.gap_decomposition - INFO -   M1 fitted successfully
2025-10-17 22:22:45,917 - utils.gap_decomposition - INFO - 
Fitting M2...
2025-10-17 22:22:45,917 - utils.gap_decomposition - INFO -   Formula: ERT ~ dyslexic_int * (word_length_scaled + word_frequency_zipf_scaled)
2025-10-17 22:22:46,603 - utils.gap_decomposition - INFO -   M2 fitted successfully
2025-10-17 22:22:46,604 - utils.gap_decomposition - INFO - 
Fitting M3...
2025-10-17 22:22:46,604 - utils.gap_decomposition - INFO -   Formula: ERT ~ dyslexic_int * (word_length_scaled + word_frequency_zipf_scaled + surprisal_scaled)
2025-10-17 22:22:47,234 - utils.gap_decomposition - INFO -   M3 fitted successfully
2025-10-17 22:22:47,254 - utils.gap_decomposition - INFO - 
Computing counterfactual gaps...
2025-10-17 22:22:47,441 - utils.gap_decomposition - INFO -   M0: Gap = 4.46ms
2025-10-17 22:22:47,742 - utils.gap_decomposition - INFO -   M1: Gap = -2.71ms
2025-10-17 22:22:48,067 - utils.gap_decomposition - INFO -   M2: Gap = 7.27ms
2025-10-17 22:22:48,574 - utils.gap_decomposition - INFO -   M3: Gap = -0.39ms
2025-10-17 22:22:48,601 - utils.gap_decomposition - INFO - 
Computing marginal R²...
2025-10-17 22:22:48,605 - utils.gap_decomposition - ERROR -   M0 R² computation failed: Cannot predict random effects from singular covariance structure.
2025-10-17 22:22:48,702 - utils.gap_decomposition - ERROR -   M1 R² computation failed: Cannot predict random effects from singular covariance structure.
2025-10-17 22:22:48,710 - utils.gap_decomposition - ERROR -   M2 R² computation failed: Cannot predict random effects from singular covariance structure.
2025-10-17 22:22:48,713 - utils.gap_decomposition - ERROR -   M3 R² computation failed: Cannot predict random effects from singular covariance structure.
2025-10-17 22:22:48,713 - utils.gap_decomposition - INFO - 
GAP DECOMPOSITION SUMMARY:
2025-10-17 22:22:48,714 - utils.gap_decomposition - INFO -   Baseline gap (M0): 4.46ms
2025-10-17 22:22:48,714 - utils.gap_decomposition - INFO -   M1: Gap=-2.71ms, Explained=160.7%, DeltaR2=nan
2025-10-17 22:22:48,714 - utils.gap_decomposition - INFO -   M2: Gap=7.27ms, Explained=-63.1%, DeltaR2=nan
2025-10-17 22:22:48,714 - utils.gap_decomposition - INFO -   M3: Gap=-0.39ms, Explained=108.7%, DeltaR2=nan
2025-10-17 22:22:48,718 - utils.sensitivity_analysis - INFO - ============================================================
2025-10-17 22:22:48,720 - utils.sensitivity_analysis - INFO - SENSITIVITY ANALYSES
2025-10-17 22:22:48,720 - utils.sensitivity_analysis - INFO - ============================================================
2025-10-17 22:22:48,720 - utils.sensitivity_analysis - INFO - 
1. RESIDUALIZED SURPRISAL MODEL
2025-10-17 22:22:48,936 - utils.sensitivity_analysis - INFO -   Formula: ERT ~ dyslexic_int * (word_length_scaled + word_frequency_zipf_scaled + surprisal_resid)
2025-10-17 22:22:49,538 - utils.sensitivity_analysis - INFO -   Residualized surprisal: beta=11.6330, p=0.0000
2025-10-17 22:22:49,538 - utils.sensitivity_analysis - INFO -   [OK] Surprisal effect robust to frequency collinearity
2025-10-17 22:22:49,552 - utils.sensitivity_analysis - INFO - 
2. SUBJECT-WISE CROSS-VALIDATION
2025-10-17 22:22:49,553 - utils.sensitivity_analysis - INFO -   Running 10-fold subject-wise CV...
2025-10-17 22:22:49,788 - utils.sensitivity_analysis - INFO -     Fold 1/10
2025-10-17 22:22:50,398 - utils.sensitivity_analysis - INFO -     Fold 2/10
2025-10-17 22:22:51,114 - utils.sensitivity_analysis - INFO -     Fold 3/10
2025-10-17 22:22:51,784 - utils.sensitivity_analysis - INFO -     Fold 4/10
2025-10-17 22:22:52,503 - utils.sensitivity_analysis - INFO -     Fold 5/10
2025-10-17 22:22:53,138 - utils.sensitivity_analysis - INFO -     Fold 6/10
2025-10-17 22:22:54,430 - utils.sensitivity_analysis - INFO -     Fold 7/10
2025-10-17 22:22:55,024 - utils.sensitivity_analysis - INFO -     Fold 8/10
2025-10-17 22:22:55,656 - utils.sensitivity_analysis - INFO -     Fold 9/10
2025-10-17 22:22:56,239 - utils.sensitivity_analysis - INFO -     Fold 10/10
2025-10-17 22:22:56,792 - utils.sensitivity_analysis - INFO -   Cross-validation R²: -0.3352 ± 0.2999
2025-10-17 22:22:56,792 - utils.sensitivity_analysis - INFO -   Based on 10 successful folds
2025-10-17 22:22:56,833 - utils.sensitivity_analysis - INFO - 
3. ALTERNATIVE BINNING (Terciles & Quintiles)
2025-10-17 22:22:56,835 - utils.sensitivity_analysis - INFO - 
  Testing terciles...
2025-10-17 22:22:57,192 - utils.sensitivity_analysis - INFO - 
  Testing quintiles...
2025-10-17 22:22:57,442 - utils.hypothesis_visualization - INFO - ============================================================
2025-10-17 22:22:57,442 - utils.hypothesis_visualization - INFO - CREATING VISUALIZATIONS
2025-10-17 22:22:57,443 - utils.hypothesis_visualization - INFO - ============================================================
2025-10-17 22:22:57,444 - utils.hypothesis_visualization - INFO - 
1. Continuous effect curves...
2025-10-17 22:22:58,959 - utils.hypothesis_visualization - INFO -   Saved to results\continuous_effects_with_quartiles.png
2025-10-17 22:22:58,961 - utils.hypothesis_visualization - INFO - 2. Gap decomposition...
2025-10-17 22:22:59,175 - utils.hypothesis_visualization - INFO -   Saved to results\gap_decomposition.png
2025-10-17 22:22:59,175 - utils.hypothesis_visualization - INFO - 3. Slope ratios...
2025-10-17 22:22:59,191 - __main__ - ERROR - Pipeline failed: 'xerr' must not contain negative values
Traceback (most recent call last):
  File "C:\Users\hugos\Desktop\Dyslexia_Time_Paper\Dyslexia_Time_Cost_Analysis\main.py", line 759, in main
    pipeline.run_hypothesis_testing_analysis()  # NEW
  File "C:\Users\hugos\Desktop\Dyslexia_Time_Paper\Dyslexia_Time_Cost_Analysis\main.py", line 434, in run_hypothesis_testing_analysis
    create_hypothesis_testing_visualizations(
  File "C:\Users\hugos\Desktop\Dyslexia_Time_Paper\Dyslexia_Time_Cost_Analysis\utils\hypothesis_visualization.py", line 51, in create_hypothesis_testing_visualizations
    plot_slope_ratios(continuous_results, output_dir / "slope_ratios.png")
  File "C:\Users\hugos\Desktop\Dyslexia_Time_Paper\Dyslexia_Time_Cost_Analysis\utils\hypothesis_visualization.py", line 324, in plot_slope_ratios
    bars = ax.barh(
  File "C:\Users\hugos\miniconda3\envs\dyslexia-time-analysis\lib\site-packages\matplotlib\axes\_axes.py", line 2834, in barh
    patches = self.bar(x=left, height=height, width=width, bottom=y,
  File "C:\Users\hugos\miniconda3\envs\dyslexia-time-analysis\lib\site-packages\matplotlib\__init__.py", line 1524, in inner
    return func(
  File "C:\Users\hugos\miniconda3\envs\dyslexia-time-analysis\lib\site-packages\matplotlib\axes\_axes.py", line 2676, in bar
    errorbar = self.errorbar(ex, ey, yerr=yerr, xerr=xerr, fmt='none',
  File "C:\Users\hugos\miniconda3\envs\dyslexia-time-analysis\lib\site-packages\matplotlib\_api\deprecation.py", line 453, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\hugos\miniconda3\envs\dyslexia-time-analysis\lib\site-packages\matplotlib\__init__.py", line 1524, in inner
    return func(
  File "C:\Users\hugos\miniconda3\envs\dyslexia-time-analysis\lib\site-packages\matplotlib\axes\_axes.py", line 3825, in errorbar
    raise ValueError(
ValueError: 'xerr' must not contain negative values
2025-10-17 22:25:30,179 - __main__ - INFO - Dyslexia Time Analysis Pipeline initialized
2025-10-17 22:25:30,180 - __main__ - INFO - Dyslexia Time Analysis Pipeline initialized
2025-10-17 22:25:31,835 - __main__ - INFO - Running hypothesis testing analysis...
2025-10-17 22:25:31,835 - __main__ - INFO - ================================================================================
2025-10-17 22:25:31,835 - __main__ - INFO - HYPOTHESIS TESTING ANALYSIS
2025-10-17 22:25:31,835 - __main__ - INFO - ================================================================================
2025-10-17 22:25:31,835 - __main__ - INFO - Loading CopCo dataset...
2025-10-17 22:25:31,836 - utils.data_utils - INFO - Loading 57 participant files...
2025-10-17 22:25:33,333 - utils.data_utils - INFO - Starting with 335,203 total word entries
2025-10-17 22:25:33,537 - utils.data_utils - INFO - Word fixation patterns:
2025-10-17 22:25:33,538 - utils.data_utils - INFO -   - Skipped words (0 fixations): 126,302
2025-10-17 22:25:33,538 - utils.data_utils - INFO -   - Fixated words (1+ fixations): 208,901
2025-10-17 22:25:33,538 - utils.data_utils - INFO -   - Unknown fixations (NaN): 0
2025-10-17 22:25:33,571 - utils.data_utils - INFO - Fixated words reading times: median 272ms, 99th percentile 1777ms
2025-10-17 22:25:33,572 - utils.data_utils - INFO - Removed 14 fixated words with extreme reading times (0 too short, 14 too long)
2025-10-17 22:25:33,672 - utils.data_utils - INFO - Removed 23 words longer than 30 characters (likely data errors)
2025-10-17 22:25:33,710 - utils.data_utils - INFO - Final dataset: 126,302 skipped words, 208,864 fixated words
2025-10-17 22:25:33,710 - utils.data_utils - INFO - Data cleaning complete: 335,166 words retained (100.0% of original)
2025-10-17 22:25:33,719 - utils.data_utils - INFO - Groups identified: 19 dyslexic, 39 control
2025-10-17 22:25:33,791 - __main__ - INFO - Calculating skipping probabilities...
2025-10-17 22:25:33,795 - utils.skipping_utils - INFO - Skipping analysis from ExtractedFeatures:
2025-10-17 22:25:33,795 - utils.skipping_utils - INFO -   Total words: 335,166
2025-10-17 22:25:33,795 - utils.skipping_utils - INFO -   Skipped: 126,302 (37.7%)
2025-10-17 22:25:33,796 - utils.skipping_utils - INFO -   Fixated: 208,864 (62.3%)
2025-10-17 22:25:33,838 - __main__ - INFO - Skipping analysis: 37.7% overall rate
2025-10-17 22:25:33,857 - __main__ - INFO - Loaded: 335,166 words from 57 participants
2025-10-17 22:25:33,857 - __main__ - INFO - ============================================================
2025-10-17 22:25:33,857 - __main__ - INFO - COMPUTING LINGUISTIC FEATURES
2025-10-17 22:25:33,857 - __main__ - INFO - ============================================================
2025-10-17 22:25:33,857 - utils.linguistic_features - INFO - Loading Danish frequency list from danish_frequencies\danish_leipzig_for_analysis.txt
2025-10-17 22:25:35,359 - utils.linguistic_features - WARNING - Found 2 duplicate words after lowercasing. 
2025-10-17 22:25:35,766 - utils.linguistic_features - INFO - Loaded 1,499,999 word proportions from Leipzig Corpora
2025-10-17 22:25:35,860 - utils.linguistic_features - INFO - Computing word frequency...
2025-10-17 22:25:35,861 - utils.linguistic_features - INFO -   Stripping punctuation from words before frequency lookup
2025-10-17 22:25:36,564 - utils.linguistic_features - INFO - 13 missing word instances were punctuation-only
2025-10-17 22:25:36,564 - utils.linguistic_features - WARNING - 4,586 word instances (1.4%) not found in frequency list (197 unique valid words)
2025-10-17 22:25:36,564 - utils.linguistic_features - INFO - Sample of 197 missing valid words: ['1926-2016', 'adspredelsens', 'alauda', 'amokkacino', 'at blomsterstanden er', 'bjergstien', 'bliniopskrifter', 'blotgydje', 'blæredygtige', 'broderet messehagler og', 'certeau', 'elevrådsarrangementer', 'er stakbærende', 'et nationalt', 'forårsudstilling i', 'frederiksavn', 'go-to-ting', 'hetzbølger', 'htx-fag', 'idahot-forum', 'intersex-inkluderende', 'istandgøre', 'itx-klassen', 'kusine, christine', 'kvantepartiklerne', 'leartess', 'lgbtqi-familien', 'livsresultat', 'lærerstuderene', 'midsommeraftner', 'minervafester', 'og star', 'palme (1927-1986', 'palme har', 'pinsesalmerne', 'rekrutteringsindsatsen', 'sankthansormen', 'skraldefester', 'slomo', 'spådomsevner', 'subapikalt', 'takstfinansiere', 'terracottafabrik', 'tilran', 'topgræsser', 'tscherning (1817-1890', 'valborgsnatten', 'åbningsriffet', 'årstidshjulet', 'æg-lancetformede']... (147 more)
2025-10-17 22:25:36,573 - utils.linguistic_features - INFO - Excluding 4,599 word instances (1.4%) with missing frequencies from analysis
2025-10-17 22:25:36,714 - utils.linguistic_features - INFO - Remaining dataset: 330,567 words
2025-10-17 22:25:36,714 - utils.linguistic_features - INFO - Final dataset: 330,567 words with valid frequencies
2025-10-17 22:25:40,620 - utils.linguistic_features - INFO - Loading causal language model: KennethTM/gpt2-medium-danish
2025-10-17 22:25:42,134 - utils.linguistic_features - INFO - Using CPU for surprisal computation
2025-10-17 22:25:42,135 - utils.linguistic_features - INFO - Causal language model loaded successfully
2025-10-17 22:25:42,135 - utils.linguistic_features - INFO - Computing surprisal with causal GPT-2 (left-to-right)...
2025-10-17 22:25:43,420 - utils.linguistic_features - INFO - Dataset statistics:
2025-10-17 22:25:43,421 - utils.linguistic_features - INFO -   Total participant-sentence instances: 20,707
2025-10-17 22:25:43,421 - utils.linguistic_features - INFO -   Unique sentence texts: 1,986
2025-10-17 22:25:43,421 - utils.linguistic_features - INFO -   Average participants per sentence: 10.4
2025-10-17 22:25:43,421 - utils.linguistic_features - INFO - Loading cached surprisal values from word_surprisal\surprisal_cache_gpt2.pkl
2025-10-17 22:25:43,433 - utils.linguistic_features - INFO - Loaded surprisal for 1,986 unique sentences
2025-10-17 22:25:43,434 - utils.linguistic_features - INFO - Broadcasting surprisal values to all participant instances...
2025-10-17 22:25:43,434 - utils.linguistic_features - INFO -   Mapping surprisal to words...
2025-10-17 22:25:46,490 - utils.linguistic_features - INFO -   Mapped 326,496 words
2025-10-17 22:25:46,491 - utils.linguistic_features - INFO - 
Surprisal Computation Results:
2025-10-17 22:25:46,491 - utils.linguistic_features - INFO -   Unique sentences processed: 1,986
2025-10-17 22:25:46,492 - utils.linguistic_features - INFO -   Total words with surprisal: 326,496 / 330,567
2025-10-17 22:25:46,492 - utils.linguistic_features - INFO -   Mean: 6.93 bits
2025-10-17 22:25:46,496 - utils.linguistic_features - INFO -   Median: 5.69 bits
2025-10-17 22:25:46,497 - utils.linguistic_features - INFO -   Std: 5.55 bits
2025-10-17 22:25:46,498 - utils.linguistic_features - INFO -   Range: [0.00, 59.34] bits
2025-10-17 22:25:46,513 - utils.linguistic_features - INFO - Linguistic features added successfully
2025-10-17 22:25:46,514 - utils.linguistic_features - INFO - 
Feature Summary:
2025-10-17 22:25:46,515 - utils.linguistic_features - INFO -   Word length: mean=4.67, std=3.08
2025-10-17 22:25:46,519 - utils.linguistic_features - INFO -   Zipf frequency: mean=5.85, std=1.38, range=[0.91, 7.51]
2025-10-17 22:25:46,522 - utils.linguistic_features - INFO -   Surprisal: mean=6.93, std=5.55
2025-10-17 22:25:46,537 - utils.hypothesis_testing_utils - INFO - Preparing data for hypothesis testing...
2025-10-17 22:25:46,593 - utils.hypothesis_testing_utils - INFO - Creating ERT variable...
2025-10-17 22:25:46,597 - utils.hypothesis_testing_utils - INFO -   ERT created: 123,666 skipped (0ms), 206,901 fixated
2025-10-17 22:25:46,598 - utils.hypothesis_testing_utils - INFO - Centering and scaling predictors...
2025-10-17 22:25:46,616 - utils.hypothesis_testing_utils - INFO -   word_length: mean=4.67, scale=3.08
2025-10-17 22:25:46,629 - utils.hypothesis_testing_utils - INFO -   word_frequency_zipf: mean=5.85, scale=1.38
2025-10-17 22:25:46,643 - utils.hypothesis_testing_utils - INFO -   surprisal: mean=6.93, scale=5.55
2025-10-17 22:25:46,643 - utils.hypothesis_testing_utils - INFO - Checking collinearity (VIF)...
2025-10-17 22:25:46,744 - utils.hypothesis_testing_utils - INFO - VIF Results:
2025-10-17 22:25:46,744 - utils.hypothesis_testing_utils - INFO -   Length: 2.82 (OK)
2025-10-17 22:25:46,744 - utils.hypothesis_testing_utils - INFO -   Frequency: 3.18 (OK)
2025-10-17 22:25:46,745 - utils.hypothesis_testing_utils - INFO -   Surprisal: 1.41 (OK)
2025-10-17 22:25:46,745 - utils.hypothesis_testing_utils - INFO - Creating residualized surprisal...
2025-10-17 22:25:46,761 - utils.hypothesis_testing_utils - INFO -   Correlation (Frequency-Surprisal): r=-0.539
2025-10-17 22:25:46,761 - utils.hypothesis_testing_utils - INFO -   Residualized surprisal created
2025-10-17 22:25:46,762 - utils.hypothesis_testing_utils - INFO - Defining pooled quartiles...
2025-10-17 22:25:46,773 - utils.hypothesis_testing_utils - INFO -   word_length: Q1=2.00, Q3=6.00
2025-10-17 22:25:46,785 - utils.hypothesis_testing_utils - INFO -   word_frequency_zipf: Q1=4.91, Q3=7.10
2025-10-17 22:25:46,797 - utils.hypothesis_testing_utils - INFO -   surprisal: Q1=2.76, Q3=9.97
2025-10-17 22:25:46,798 - utils.hypothesis_testing_utils - INFO - Data preparation complete: 330,567 words ready for analysis
2025-10-17 22:25:46,812 - utils.quartile_analysis - INFO - ============================================================
2025-10-17 22:25:46,812 - utils.quartile_analysis - INFO - PART A: QUARTILE ANALYSIS (Q1 vs Q3)
2025-10-17 22:25:46,812 - utils.quartile_analysis - INFO - ============================================================
2025-10-17 22:25:46,812 - utils.quartile_analysis - INFO - 
Analyzing word_length...
2025-10-17 22:25:47,645 - utils.quartile_analysis - INFO -   Computed means for 57 participants
2025-10-17 22:25:47,646 - utils.quartile_analysis - INFO -     Control Q3-Q1: 259.7ms
2025-10-17 22:25:47,646 - utils.quartile_analysis - INFO -     Dyslexic Q3-Q1: 442.6ms
2025-10-17 22:25:47,709 - utils.quartile_analysis - INFO -   Fitting mixed model on 152,465 words...
2025-10-17 22:25:48,447 - utils.quartile_analysis - INFO -   Group×Bin interaction: beta=134.79, p=0.0000
2025-10-17 22:25:48,475 - utils.quartile_analysis - INFO -   Computing bootstrap CIs (1000 iterations)...
2025-10-17 22:25:50,172 - utils.quartile_analysis - INFO -   Bootstrap 95% CI for interaction: [98.47, 259.71]
2025-10-17 22:25:50,173 - utils.quartile_analysis - INFO - 
Analyzing word_frequency_zipf...
2025-10-17 22:25:50,967 - utils.quartile_analysis - INFO -   Computed means for 57 participants
2025-10-17 22:25:50,968 - utils.quartile_analysis - INFO -     Control Q3-Q1: -225.9ms
2025-10-17 22:25:50,969 - utils.quartile_analysis - INFO -     Dyslexic Q3-Q1: -388.2ms
2025-10-17 22:25:51,032 - utils.quartile_analysis - INFO -   Fitting mixed model on 162,606 words...
2025-10-17 22:25:54,085 - utils.quartile_analysis - INFO -   Group×Bin interaction: beta=-122.40, p=0.0000
2025-10-17 22:25:54,119 - utils.quartile_analysis - INFO -   Computing bootstrap CIs (1000 iterations)...
2025-10-17 22:25:55,882 - utils.quartile_analysis - INFO -   Bootstrap 95% CI for interaction: [-225.59, -87.90]
2025-10-17 22:25:55,883 - utils.quartile_analysis - INFO - 
Analyzing surprisal...
2025-10-17 22:25:56,670 - utils.quartile_analysis - INFO -   Computed means for 57 participants
2025-10-17 22:25:56,671 - utils.quartile_analysis - INFO -     Control Q3-Q1: 135.8ms
2025-10-17 22:25:56,672 - utils.quartile_analysis - INFO -     Dyslexic Q3-Q1: 277.3ms
2025-10-17 22:25:56,734 - utils.quartile_analysis - INFO -   Fitting mixed model on 163,257 words...
2025-10-17 22:25:59,341 - utils.quartile_analysis - INFO -   Group×Bin interaction: beta=105.53, p=0.0000
2025-10-17 22:25:59,376 - utils.quartile_analysis - INFO -   Computing bootstrap CIs (1000 iterations)...
2025-10-17 22:26:01,115 - utils.quartile_analysis - INFO -   Bootstrap 95% CI for interaction: [84.99, 194.82]
2025-10-17 22:26:01,115 - utils.continuous_models - INFO - ============================================================
2025-10-17 22:26:01,115 - utils.continuous_models - INFO - PART B: CONTINUOUS MODELS (TWO-PART)
2025-10-17 22:26:01,115 - utils.continuous_models - INFO - ============================================================
2025-10-17 22:26:01,116 - utils.continuous_models - INFO - 
1. SKIPPING MODEL (Logistic)
2025-10-17 22:26:01,222 - utils.continuous_models - INFO -   Formula: skipped ~ dyslexic_int * (word_length_scaled + word_frequency_zipf_scaled + surprisal_scaled)
2025-10-17 22:26:01,222 - utils.continuous_models - INFO -   Fitting on 326,496 words...
2025-10-17 22:26:01,639 - utils.continuous_models - INFO -   Model fitted successfully
2025-10-17 22:26:01,640 - utils.continuous_models - INFO -     dyslexic_int:word_length_scaled: beta=-0.0250, p=0.2274
2025-10-17 22:26:01,640 - utils.continuous_models - INFO -     dyslexic_int:word_frequency_zipf_scaled: beta=-0.0640, p=0.0004
2025-10-17 22:26:01,640 - utils.continuous_models - INFO -     dyslexic_int:surprisal_scaled: beta=-0.0272, p=0.0203
2025-10-17 22:26:01,647 - utils.continuous_models - INFO - 
2. DURATION MODEL (Log-TRT | Fixated)
2025-10-17 22:26:01,764 - utils.continuous_models - INFO -   Formula: log_TRT ~ dyslexic_int * (word_length_scaled + word_frequency_zipf_scaled + surprisal_scaled)
2025-10-17 22:26:01,764 - utils.continuous_models - INFO -   Fitting on 204,224 fixated words...
2025-10-17 22:26:02,852 - utils.continuous_models - INFO -   Model fitted successfully
2025-10-17 22:26:02,852 - utils.continuous_models - INFO -   Smearing correction factor: 1.1562
2025-10-17 22:26:02,853 - utils.continuous_models - INFO -     dyslexic_int:word_length_scaled: beta=0.0078, p=0.0585
2025-10-17 22:26:02,854 - utils.continuous_models - INFO -     dyslexic_int:word_frequency_zipf_scaled: beta=-0.0084, p=0.0678
2025-10-17 22:26:02,854 - utils.continuous_models - INFO -     dyslexic_int:surprisal_scaled: beta=0.0349, p=0.0000
2025-10-17 22:26:02,864 - utils.continuous_models - INFO - 
3. SLOPE RATIOS (Dyslexic Amplification)
2025-10-17 22:26:02,865 - utils.continuous_models - INFO -   Length: SR = 1.064 (AMPLIFIED)
2025-10-17 22:26:02,865 - utils.continuous_models - INFO -   Frequency: SR = 1.173 (AMPLIFIED)
2025-10-17 22:26:02,865 - utils.continuous_models - INFO -   Surprisal: SR = 2.100 (AMPLIFIED)
2025-10-17 22:26:02,865 - utils.continuous_models - INFO - 
4. BOOTSTRAP CONFIDENCE INTERVALS
2025-10-17 22:26:02,865 - utils.continuous_models - INFO -   Computing bootstrap CIs (100 iterations)...
2025-10-17 22:26:04,151 - utils.continuous_models - INFO -   Length: 95% CI = [1.561, 2.534]
2025-10-17 22:26:04,151 - utils.continuous_models - INFO -   Frequency: 95% CI = [1.645, 2.586]
2025-10-17 22:26:04,152 - utils.continuous_models - INFO -   Surprisal: 95% CI = [1.921, 3.074]
2025-10-17 22:26:04,152 - utils.continuous_models - INFO - 
5. RECOMBINING TO EXPECTED ERT
2025-10-17 22:26:04,207 - utils.continuous_models - INFO -   Predicting expected ERT...
2025-10-17 22:26:04,465 - utils.continuous_models - INFO -   Predicted ERT for 326,496 words
2025-10-17 22:26:04,467 - utils.continuous_models - INFO -     Mean predicted ERT: 143.91ms
2025-10-17 22:26:04,468 - utils.continuous_models - INFO -     Mean observed ERT: 236.03ms
2025-10-17 22:26:04,477 - utils.gap_decomposition - INFO - ============================================================
2025-10-17 22:26:04,477 - utils.gap_decomposition - INFO - PART C: GAP DECOMPOSITION
2025-10-17 22:26:04,477 - utils.gap_decomposition - INFO - ============================================================
2025-10-17 22:26:04,534 - utils.gap_decomposition - INFO - 
Fitting M0...
2025-10-17 22:26:04,534 - utils.gap_decomposition - INFO -   Formula: ERT ~ dyslexic_int
2025-10-17 22:26:04,874 - utils.gap_decomposition - INFO -   M0 fitted successfully
2025-10-17 22:26:04,874 - utils.gap_decomposition - INFO - 
Fitting M1...
2025-10-17 22:26:04,874 - utils.gap_decomposition - INFO -   Formula: ERT ~ dyslexic_int * word_length_scaled
2025-10-17 22:26:05,283 - utils.gap_decomposition - INFO -   M1 fitted successfully
2025-10-17 22:26:05,283 - utils.gap_decomposition - INFO - 
Fitting M2...
2025-10-17 22:26:05,283 - utils.gap_decomposition - INFO -   Formula: ERT ~ dyslexic_int * (word_length_scaled + word_frequency_zipf_scaled)
2025-10-17 22:26:05,752 - utils.gap_decomposition - INFO -   M2 fitted successfully
2025-10-17 22:26:05,752 - utils.gap_decomposition - INFO - 
Fitting M3...
2025-10-17 22:26:05,752 - utils.gap_decomposition - INFO -   Formula: ERT ~ dyslexic_int * (word_length_scaled + word_frequency_zipf_scaled + surprisal_scaled)
2025-10-17 22:26:06,290 - utils.gap_decomposition - INFO -   M3 fitted successfully
2025-10-17 22:26:06,301 - utils.gap_decomposition - INFO - 
Computing counterfactual gaps...
2025-10-17 22:26:06,416 - utils.gap_decomposition - INFO -   M0: Gap = 4.46ms
2025-10-17 22:26:06,565 - utils.gap_decomposition - INFO -   M1: Gap = -2.71ms
2025-10-17 22:26:06,743 - utils.gap_decomposition - INFO -   M2: Gap = 7.27ms
2025-10-17 22:26:07,002 - utils.gap_decomposition - INFO -   M3: Gap = -0.39ms
2025-10-17 22:26:07,025 - utils.gap_decomposition - INFO - 
Computing marginal R²...
2025-10-17 22:26:07,027 - utils.gap_decomposition - ERROR -   M0 R² computation failed: Cannot predict random effects from singular covariance structure.
2025-10-17 22:26:07,029 - utils.gap_decomposition - ERROR -   M1 R² computation failed: Cannot predict random effects from singular covariance structure.
2025-10-17 22:26:07,031 - utils.gap_decomposition - ERROR -   M2 R² computation failed: Cannot predict random effects from singular covariance structure.
2025-10-17 22:26:07,034 - utils.gap_decomposition - ERROR -   M3 R² computation failed: Cannot predict random effects from singular covariance structure.
2025-10-17 22:26:07,035 - utils.gap_decomposition - INFO - 
GAP DECOMPOSITION SUMMARY:
2025-10-17 22:26:07,035 - utils.gap_decomposition - INFO -   Baseline gap (M0): 4.46ms
2025-10-17 22:26:07,035 - utils.gap_decomposition - INFO -   M1: Gap=-2.71ms, Explained=160.7%, DeltaR2=nan
2025-10-17 22:26:07,035 - utils.gap_decomposition - INFO -   M2: Gap=7.27ms, Explained=-63.1%, DeltaR2=nan
2025-10-17 22:26:07,035 - utils.gap_decomposition - INFO -   M3: Gap=-0.39ms, Explained=108.7%, DeltaR2=nan
2025-10-17 22:26:07,036 - utils.sensitivity_analysis - INFO - ============================================================
2025-10-17 22:26:07,036 - utils.sensitivity_analysis - INFO - SENSITIVITY ANALYSES
2025-10-17 22:26:07,036 - utils.sensitivity_analysis - INFO - ============================================================
2025-10-17 22:26:07,036 - utils.sensitivity_analysis - INFO - 
1. RESIDUALIZED SURPRISAL MODEL
2025-10-17 22:26:07,085 - utils.sensitivity_analysis - INFO -   Formula: ERT ~ dyslexic_int * (word_length_scaled + word_frequency_zipf_scaled + surprisal_resid)
2025-10-17 22:26:07,569 - utils.sensitivity_analysis - INFO -   Residualized surprisal: beta=11.6330, p=0.0000
2025-10-17 22:26:07,570 - utils.sensitivity_analysis - INFO -   [OK] Surprisal effect robust to frequency collinearity
2025-10-17 22:26:07,580 - utils.sensitivity_analysis - INFO - 
2. SUBJECT-WISE CROSS-VALIDATION
2025-10-17 22:26:07,580 - utils.sensitivity_analysis - INFO -   Running 10-fold subject-wise CV...
2025-10-17 22:26:07,769 - utils.sensitivity_analysis - INFO -     Fold 1/10
2025-10-17 22:26:08,288 - utils.sensitivity_analysis - INFO -     Fold 2/10
2025-10-17 22:26:08,866 - utils.sensitivity_analysis - INFO -     Fold 3/10
2025-10-17 22:26:09,453 - utils.sensitivity_analysis - INFO -     Fold 4/10
2025-10-17 22:26:10,051 - utils.sensitivity_analysis - INFO -     Fold 5/10
2025-10-17 22:26:10,648 - utils.sensitivity_analysis - INFO -     Fold 6/10
2025-10-17 22:26:11,820 - utils.sensitivity_analysis - INFO -     Fold 7/10
2025-10-17 22:26:12,429 - utils.sensitivity_analysis - INFO -     Fold 8/10
2025-10-17 22:26:13,041 - utils.sensitivity_analysis - INFO -     Fold 9/10
2025-10-17 22:26:13,649 - utils.sensitivity_analysis - INFO -     Fold 10/10
2025-10-17 22:26:14,273 - utils.sensitivity_analysis - INFO -   Cross-validation R²: -0.3352 ± 0.2999
2025-10-17 22:26:14,273 - utils.sensitivity_analysis - INFO -   Based on 10 successful folds
2025-10-17 22:26:14,318 - utils.sensitivity_analysis - INFO - 
3. ALTERNATIVE BINNING (Terciles & Quintiles)
2025-10-17 22:26:14,319 - utils.sensitivity_analysis - INFO - 
  Testing terciles...
2025-10-17 22:26:14,430 - utils.sensitivity_analysis - INFO -     word_length: Control Delta=202.4ms, Dyslexic Delta=304.4ms
2025-10-17 22:26:14,534 - utils.sensitivity_analysis - INFO -     word_frequency_zipf: Control Delta=-187.4ms, Dyslexic Delta=-283.4ms
2025-10-17 22:26:14,636 - utils.sensitivity_analysis - INFO -     surprisal: Control Delta=112.9ms, Dyslexic Delta=200.7ms
2025-10-17 22:26:14,637 - utils.sensitivity_analysis - INFO - 
  Testing quintiles...
2025-10-17 22:26:14,712 - utils.sensitivity_analysis - INFO -     word_length: Control Delta=284.7ms, Dyslexic Delta=452.5ms
2025-10-17 22:26:14,789 - utils.sensitivity_analysis - INFO -     word_frequency_zipf: Control Delta=-242.1ms, Dyslexic Delta=-393.1ms
2025-10-17 22:26:14,874 - utils.sensitivity_analysis - INFO -     surprisal: Control Delta=150.5ms, Dyslexic Delta=270.2ms
2025-10-17 22:26:14,880 - utils.hypothesis_visualization - INFO - ============================================================
2025-10-17 22:26:14,881 - utils.hypothesis_visualization - INFO - CREATING VISUALIZATIONS
2025-10-17 22:26:14,881 - utils.hypothesis_visualization - INFO - ============================================================
2025-10-17 22:26:14,882 - utils.hypothesis_visualization - INFO - 
1. Continuous effect curves...
2025-10-17 22:26:16,119 - utils.hypothesis_visualization - INFO -   Saved to results\continuous_effects_with_quartiles.png
2025-10-17 22:26:16,121 - utils.hypothesis_visualization - INFO - 2. Gap decomposition...
2025-10-17 22:26:16,324 - utils.hypothesis_visualization - INFO -   Saved to results\gap_decomposition.png
2025-10-17 22:26:16,325 - utils.hypothesis_visualization - INFO - 3. Slope ratios...
2025-10-17 22:26:16,341 - __main__ - ERROR - Pipeline failed: 'xerr' must not contain negative values
Traceback (most recent call last):
  File "C:\Users\hugos\Desktop\Dyslexia_Time_Paper\Dyslexia_Time_Cost_Analysis\main.py", line 759, in main
    pipeline.run_hypothesis_testing_analysis()  # NEW
  File "C:\Users\hugos\Desktop\Dyslexia_Time_Paper\Dyslexia_Time_Cost_Analysis\main.py", line 434, in run_hypothesis_testing_analysis
    create_hypothesis_testing_visualizations(
  File "C:\Users\hugos\Desktop\Dyslexia_Time_Paper\Dyslexia_Time_Cost_Analysis\utils\hypothesis_visualization.py", line 51, in create_hypothesis_testing_visualizations
    plot_slope_ratios(continuous_results, output_dir / "slope_ratios.png")
  File "C:\Users\hugos\Desktop\Dyslexia_Time_Paper\Dyslexia_Time_Cost_Analysis\utils\hypothesis_visualization.py", line 324, in plot_slope_ratios
    bars = ax.barh(
  File "C:\Users\hugos\miniconda3\envs\dyslexia-time-analysis\lib\site-packages\matplotlib\axes\_axes.py", line 2834, in barh
    patches = self.bar(x=left, height=height, width=width, bottom=y,
  File "C:\Users\hugos\miniconda3\envs\dyslexia-time-analysis\lib\site-packages\matplotlib\__init__.py", line 1524, in inner
    return func(
  File "C:\Users\hugos\miniconda3\envs\dyslexia-time-analysis\lib\site-packages\matplotlib\axes\_axes.py", line 2676, in bar
    errorbar = self.errorbar(ex, ey, yerr=yerr, xerr=xerr, fmt='none',
  File "C:\Users\hugos\miniconda3\envs\dyslexia-time-analysis\lib\site-packages\matplotlib\_api\deprecation.py", line 453, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\hugos\miniconda3\envs\dyslexia-time-analysis\lib\site-packages\matplotlib\__init__.py", line 1524, in inner
    return func(
  File "C:\Users\hugos\miniconda3\envs\dyslexia-time-analysis\lib\site-packages\matplotlib\axes\_axes.py", line 3825, in errorbar
    raise ValueError(
ValueError: 'xerr' must not contain negative values
2025-10-17 22:30:59,408 - __main__ - INFO - Dyslexia Time Analysis Pipeline initialized
2025-10-17 22:30:59,409 - __main__ - INFO - Dyslexia Time Analysis Pipeline initialized
2025-10-17 22:31:01,836 - __main__ - INFO - Running hypothesis testing analysis...
2025-10-17 22:31:01,837 - __main__ - INFO - ================================================================================
2025-10-17 22:31:01,837 - __main__ - INFO - HYPOTHESIS TESTING ANALYSIS
2025-10-17 22:31:01,837 - __main__ - INFO - ================================================================================
2025-10-17 22:31:01,837 - __main__ - INFO - Loading CopCo dataset...
2025-10-17 22:31:01,838 - utils.data_utils - INFO - Loading 57 participant files...
2025-10-17 22:31:03,562 - utils.data_utils - INFO - Starting with 335,203 total word entries
2025-10-17 22:31:03,750 - utils.data_utils - INFO - Word fixation patterns:
2025-10-17 22:31:03,751 - utils.data_utils - INFO -   - Skipped words (0 fixations): 126,302
2025-10-17 22:31:03,751 - utils.data_utils - INFO -   - Fixated words (1+ fixations): 208,901
2025-10-17 22:31:03,751 - utils.data_utils - INFO -   - Unknown fixations (NaN): 0
2025-10-17 22:31:03,781 - utils.data_utils - INFO - Fixated words reading times: median 272ms, 99th percentile 1777ms
2025-10-17 22:31:03,784 - utils.data_utils - INFO - Removed 14 fixated words with extreme reading times (0 too short, 14 too long)
2025-10-17 22:31:03,883 - utils.data_utils - INFO - Removed 23 words longer than 30 characters (likely data errors)
2025-10-17 22:31:03,920 - utils.data_utils - INFO - Final dataset: 126,302 skipped words, 208,864 fixated words
2025-10-17 22:31:03,920 - utils.data_utils - INFO - Data cleaning complete: 335,166 words retained (100.0% of original)
2025-10-17 22:31:03,928 - utils.data_utils - INFO - Groups identified: 19 dyslexic, 39 control
2025-10-17 22:31:03,997 - __main__ - INFO - Calculating skipping probabilities...
2025-10-17 22:31:04,000 - utils.skipping_utils - INFO - Skipping analysis from ExtractedFeatures:
2025-10-17 22:31:04,000 - utils.skipping_utils - INFO -   Total words: 335,166
2025-10-17 22:31:04,000 - utils.skipping_utils - INFO -   Skipped: 126,302 (37.7%)
2025-10-17 22:31:04,001 - utils.skipping_utils - INFO -   Fixated: 208,864 (62.3%)
2025-10-17 22:31:04,043 - __main__ - INFO - Skipping analysis: 37.7% overall rate
2025-10-17 22:31:04,062 - __main__ - INFO - Loaded: 335,166 words from 57 participants
2025-10-17 22:31:04,062 - __main__ - INFO - ============================================================
2025-10-17 22:31:04,062 - __main__ - INFO - COMPUTING LINGUISTIC FEATURES
2025-10-17 22:31:04,062 - __main__ - INFO - ============================================================
2025-10-17 22:31:04,063 - utils.linguistic_features - INFO - Loading Danish frequency list from danish_frequencies\danish_leipzig_for_analysis.txt
2025-10-17 22:31:05,497 - utils.linguistic_features - WARNING - Found 2 duplicate words after lowercasing. 
2025-10-17 22:31:05,979 - utils.linguistic_features - INFO - Loaded 1,499,999 word proportions from Leipzig Corpora
2025-10-17 22:31:06,068 - utils.linguistic_features - INFO - Computing word frequency...
2025-10-17 22:31:06,069 - utils.linguistic_features - INFO -   Stripping punctuation from words before frequency lookup
2025-10-17 22:31:06,744 - utils.linguistic_features - INFO - 13 missing word instances were punctuation-only
2025-10-17 22:31:06,745 - utils.linguistic_features - WARNING - 4,586 word instances (1.4%) not found in frequency list (197 unique valid words)
2025-10-17 22:31:06,745 - utils.linguistic_features - INFO - Sample of 197 missing valid words: ['1986. mordet', '2. (margrethe', '2000-direktiverne', '3.g-underholdning', '9. og dronning', 'adunyadet', 'af imperialismen', 'af kong', 'at blomsterstanden er', 'bliniopskrifter', 'broder-søsterligt', 'cølibatægteskabet', 'dambrugsområdet', 'demonstrationsland', 'downcycling', 'drengekammeraterne', 'efter star', 'elevrådsarrangementer', 'fattigdomsfængel', 'født 16', 'glædesblussene', 'græssteppefugl', 'herne', 'ingrid, danmarks', 'initiativlyst', 'it-mulighederne', 'itx-klasse', 'jedi (2017', 'klimatilpasningspakke', 'kridtrende', 'lederun', 'ligusteragtig', 'live-action-udgaven', 'palme har', 'pinsesalmerne', 'på p', 'sankthanstraditioner', 'sejdkunst', 'solhversfesten', 'som blomstermaler', 'som star', 'songkla', 'spejder-juniorer', 'spákona', 'subapikalt', 'svenske velfærdsstat og', 'traume for', 'vandmiljøindsats', 'vindmølle-testanlægget', 'vindmøllehoveder']... (147 more)
2025-10-17 22:31:06,755 - utils.linguistic_features - INFO - Excluding 4,599 word instances (1.4%) with missing frequencies from analysis
2025-10-17 22:31:06,897 - utils.linguistic_features - INFO - Remaining dataset: 330,567 words
2025-10-17 22:31:06,898 - utils.linguistic_features - INFO - Final dataset: 330,567 words with valid frequencies
2025-10-17 22:31:10,890 - utils.linguistic_features - INFO - Loading causal language model: KennethTM/gpt2-medium-danish
2025-10-17 22:31:12,484 - utils.linguistic_features - INFO - Using CPU for surprisal computation
2025-10-17 22:31:12,485 - utils.linguistic_features - INFO - Causal language model loaded successfully
2025-10-17 22:31:12,485 - utils.linguistic_features - INFO - Computing surprisal with causal GPT-2 (left-to-right)...
2025-10-17 22:31:13,740 - utils.linguistic_features - INFO - Dataset statistics:
2025-10-17 22:31:13,740 - utils.linguistic_features - INFO -   Total participant-sentence instances: 20,707
2025-10-17 22:31:13,740 - utils.linguistic_features - INFO -   Unique sentence texts: 1,986
2025-10-17 22:31:13,740 - utils.linguistic_features - INFO -   Average participants per sentence: 10.4
2025-10-17 22:31:13,741 - utils.linguistic_features - INFO - Loading cached surprisal values from word_surprisal\surprisal_cache_gpt2.pkl
2025-10-17 22:31:13,754 - utils.linguistic_features - INFO - Loaded surprisal for 1,986 unique sentences
2025-10-17 22:31:13,755 - utils.linguistic_features - INFO - Broadcasting surprisal values to all participant instances...
2025-10-17 22:31:13,755 - utils.linguistic_features - INFO -   Mapping surprisal to words...
2025-10-17 22:31:16,989 - utils.linguistic_features - INFO -   Mapped 326,496 words
2025-10-17 22:31:16,990 - utils.linguistic_features - INFO - 
Surprisal Computation Results:
2025-10-17 22:31:16,990 - utils.linguistic_features - INFO -   Unique sentences processed: 1,986
2025-10-17 22:31:16,991 - utils.linguistic_features - INFO -   Total words with surprisal: 326,496 / 330,567
2025-10-17 22:31:16,991 - utils.linguistic_features - INFO -   Mean: 6.93 bits
2025-10-17 22:31:16,995 - utils.linguistic_features - INFO -   Median: 5.69 bits
2025-10-17 22:31:16,998 - utils.linguistic_features - INFO -   Std: 5.55 bits
2025-10-17 22:31:16,998 - utils.linguistic_features - INFO -   Range: [0.00, 59.34] bits
2025-10-17 22:31:17,016 - utils.linguistic_features - INFO - Linguistic features added successfully
2025-10-17 22:31:17,017 - utils.linguistic_features - INFO - 
Feature Summary:
2025-10-17 22:31:17,019 - utils.linguistic_features - INFO -   Word length: mean=4.67, std=3.08
2025-10-17 22:31:17,022 - utils.linguistic_features - INFO -   Zipf frequency: mean=5.85, std=1.38, range=[0.91, 7.51]
2025-10-17 22:31:17,025 - utils.linguistic_features - INFO -   Surprisal: mean=6.93, std=5.55
2025-10-17 22:31:17,037 - utils.hypothesis_testing_utils - INFO - Preparing data for hypothesis testing...
2025-10-17 22:31:17,087 - utils.hypothesis_testing_utils - INFO - Creating ERT variable...
2025-10-17 22:31:17,090 - utils.hypothesis_testing_utils - INFO -   ERT created: 123,666 skipped (0ms), 206,901 fixated
2025-10-17 22:31:17,090 - utils.hypothesis_testing_utils - INFO - Centering and scaling predictors...
2025-10-17 22:31:17,107 - utils.hypothesis_testing_utils - INFO -   word_length: mean=4.67, scale=3.08
2025-10-17 22:31:17,121 - utils.hypothesis_testing_utils - INFO -   word_frequency_zipf: mean=5.85, scale=1.38
2025-10-17 22:31:17,135 - utils.hypothesis_testing_utils - INFO -   surprisal: mean=6.93, scale=5.55
2025-10-17 22:31:17,136 - utils.hypothesis_testing_utils - INFO - Checking collinearity (VIF)...
2025-10-17 22:31:17,260 - utils.hypothesis_testing_utils - INFO - VIF Results:
2025-10-17 22:31:17,261 - utils.hypothesis_testing_utils - INFO -   Length: 2.82 (OK)
2025-10-17 22:31:17,261 - utils.hypothesis_testing_utils - INFO -   Frequency: 3.18 (OK)
2025-10-17 22:31:17,262 - utils.hypothesis_testing_utils - INFO -   Surprisal: 1.41 (OK)
2025-10-17 22:31:17,262 - utils.hypothesis_testing_utils - INFO - Creating residualized surprisal...
2025-10-17 22:31:17,280 - utils.hypothesis_testing_utils - INFO -   Correlation (Frequency-Surprisal): r=-0.539
2025-10-17 22:31:17,280 - utils.hypothesis_testing_utils - INFO -   Residualized surprisal created
2025-10-17 22:31:17,280 - utils.hypothesis_testing_utils - INFO - Defining pooled quartiles...
2025-10-17 22:31:17,294 - utils.hypothesis_testing_utils - INFO -   word_length: Q1=2.00, Q3=6.00
2025-10-17 22:31:17,308 - utils.hypothesis_testing_utils - INFO -   word_frequency_zipf: Q1=4.91, Q3=7.10
2025-10-17 22:31:17,320 - utils.hypothesis_testing_utils - INFO -   surprisal: Q1=2.76, Q3=9.97
2025-10-17 22:31:17,321 - utils.hypothesis_testing_utils - INFO - Data preparation complete: 330,567 words ready for analysis
2025-10-17 22:31:17,332 - utils.quartile_analysis - INFO - ============================================================
2025-10-17 22:31:17,332 - utils.quartile_analysis - INFO - PART A: QUARTILE ANALYSIS (Q1 vs Q3)
2025-10-17 22:31:17,332 - utils.quartile_analysis - INFO - ============================================================
2025-10-17 22:31:17,332 - utils.quartile_analysis - INFO - 
Analyzing word_length...
2025-10-17 22:31:18,143 - utils.quartile_analysis - INFO -   Computed means for 57 participants
2025-10-17 22:31:18,144 - utils.quartile_analysis - INFO -     Control Q3-Q1: 259.7ms
2025-10-17 22:31:18,145 - utils.quartile_analysis - INFO -     Dyslexic Q3-Q1: 442.6ms
2025-10-17 22:31:18,210 - utils.quartile_analysis - INFO -   Fitting mixed model on 152,465 words...
2025-10-17 22:31:18,922 - utils.quartile_analysis - INFO -   Group×Bin interaction: beta=134.79, p=0.0000
2025-10-17 22:31:18,956 - utils.quartile_analysis - INFO -   Computing bootstrap CIs (1000 iterations)...
2025-10-17 22:31:20,696 - utils.quartile_analysis - INFO -   Bootstrap 95% CI for interaction: [98.47, 259.71]
2025-10-17 22:31:20,696 - utils.quartile_analysis - INFO - 
Analyzing word_frequency_zipf...
2025-10-17 22:31:21,509 - utils.quartile_analysis - INFO -   Computed means for 57 participants
2025-10-17 22:31:21,510 - utils.quartile_analysis - INFO -     Control Q3-Q1: -225.9ms
2025-10-17 22:31:21,510 - utils.quartile_analysis - INFO -     Dyslexic Q3-Q1: -388.2ms
2025-10-17 22:31:21,573 - utils.quartile_analysis - INFO -   Fitting mixed model on 162,606 words...
2025-10-17 22:31:24,484 - utils.quartile_analysis - INFO -   Group×Bin interaction: beta=-122.40, p=0.0000
2025-10-17 22:31:24,520 - utils.quartile_analysis - INFO -   Computing bootstrap CIs (1000 iterations)...
2025-10-17 22:31:26,260 - utils.quartile_analysis - INFO -   Bootstrap 95% CI for interaction: [-225.59, -87.90]
2025-10-17 22:31:26,261 - utils.quartile_analysis - INFO - 
Analyzing surprisal...
2025-10-17 22:31:27,121 - utils.quartile_analysis - INFO -   Computed means for 57 participants
2025-10-17 22:31:27,122 - utils.quartile_analysis - INFO -     Control Q3-Q1: 135.8ms
2025-10-17 22:31:27,123 - utils.quartile_analysis - INFO -     Dyslexic Q3-Q1: 277.3ms
2025-10-17 22:31:27,205 - utils.quartile_analysis - INFO -   Fitting mixed model on 163,257 words...
2025-10-17 22:31:29,915 - utils.quartile_analysis - INFO -   Group×Bin interaction: beta=105.53, p=0.0000
2025-10-17 22:31:29,946 - utils.quartile_analysis - INFO -   Computing bootstrap CIs (1000 iterations)...
2025-10-17 22:31:31,735 - utils.quartile_analysis - INFO -   Bootstrap 95% CI for interaction: [84.99, 194.82]
2025-10-17 22:31:31,735 - utils.continuous_models - INFO - ============================================================
2025-10-17 22:31:31,736 - utils.continuous_models - INFO - PART B: CONTINUOUS MODELS (TWO-PART)
2025-10-17 22:31:31,736 - utils.continuous_models - INFO - ============================================================
2025-10-17 22:31:31,736 - utils.continuous_models - INFO - 
1. SKIPPING MODEL (Logistic)
2025-10-17 22:31:31,839 - utils.continuous_models - INFO -   Formula: skipped ~ dyslexic_int * (word_length_scaled + word_frequency_zipf_scaled + surprisal_scaled)
2025-10-17 22:31:31,841 - utils.continuous_models - INFO -   Fitting on 326,496 words...
2025-10-17 22:31:32,234 - utils.continuous_models - INFO -   Model fitted successfully
2025-10-17 22:31:32,235 - utils.continuous_models - INFO -     dyslexic_int:word_length_scaled: beta=-0.0250, p=0.2274
2025-10-17 22:31:32,235 - utils.continuous_models - INFO -     dyslexic_int:word_frequency_zipf_scaled: beta=-0.0640, p=0.0004
2025-10-17 22:31:32,236 - utils.continuous_models - INFO -     dyslexic_int:surprisal_scaled: beta=-0.0272, p=0.0203
2025-10-17 22:31:32,246 - utils.continuous_models - INFO - 
2. DURATION MODEL (Log-TRT | Fixated)
2025-10-17 22:31:32,362 - utils.continuous_models - INFO -   Formula: log_TRT ~ dyslexic_int * (word_length_scaled + word_frequency_zipf_scaled + surprisal_scaled)
2025-10-17 22:31:32,362 - utils.continuous_models - INFO -   Fitting on 204,224 fixated words...
2025-10-17 22:31:33,505 - utils.continuous_models - INFO -   Model fitted successfully
2025-10-17 22:31:33,505 - utils.continuous_models - INFO -   Smearing correction factor: 1.1562
2025-10-17 22:31:33,506 - utils.continuous_models - INFO -     dyslexic_int:word_length_scaled: beta=0.0078, p=0.0585
2025-10-17 22:31:33,506 - utils.continuous_models - INFO -     dyslexic_int:word_frequency_zipf_scaled: beta=-0.0084, p=0.0678
2025-10-17 22:31:33,506 - utils.continuous_models - INFO -     dyslexic_int:surprisal_scaled: beta=0.0349, p=0.0000
2025-10-17 22:31:33,514 - utils.continuous_models - INFO - 
3. SLOPE RATIOS (Dyslexic Amplification)
2025-10-17 22:31:33,514 - utils.continuous_models - INFO -   Length: SR = 1.064 (AMPLIFIED)
2025-10-17 22:31:33,515 - utils.continuous_models - INFO -   Frequency: SR = 1.173 (AMPLIFIED)
2025-10-17 22:31:33,515 - utils.continuous_models - INFO -   Surprisal: SR = 2.100 (AMPLIFIED)
2025-10-17 22:31:33,515 - utils.continuous_models - INFO - 
4. BOOTSTRAP CONFIDENCE INTERVALS
2025-10-17 22:31:33,516 - utils.continuous_models - INFO -   Computing bootstrap CIs (100 iterations)...
2025-10-17 22:31:34,899 - utils.continuous_models - INFO -   Length: 95% CI = [1.561, 2.534]
2025-10-17 22:31:34,899 - utils.continuous_models - INFO -   Frequency: 95% CI = [1.645, 2.586]
2025-10-17 22:31:34,899 - utils.continuous_models - INFO -   Surprisal: 95% CI = [1.921, 3.074]
2025-10-17 22:31:34,901 - utils.continuous_models - INFO - 
5. RECOMBINING TO EXPECTED ERT
2025-10-17 22:31:34,970 - utils.continuous_models - INFO -   Predicting expected ERT...
2025-10-17 22:31:35,226 - utils.continuous_models - INFO -   Predicted ERT for 326,496 words
2025-10-17 22:31:35,228 - utils.continuous_models - INFO -     Mean predicted ERT: 143.91ms
2025-10-17 22:31:35,228 - utils.continuous_models - INFO -     Mean observed ERT: 236.03ms
2025-10-17 22:31:35,238 - utils.gap_decomposition - INFO - ============================================================
2025-10-17 22:31:35,238 - utils.gap_decomposition - INFO - PART C: GAP DECOMPOSITION
2025-10-17 22:31:35,238 - utils.gap_decomposition - INFO - ============================================================
2025-10-17 22:31:35,304 - utils.gap_decomposition - INFO - 
Fitting M0...
2025-10-17 22:31:35,305 - utils.gap_decomposition - INFO -   Formula: ERT ~ dyslexic_int
2025-10-17 22:31:35,657 - utils.gap_decomposition - INFO -   M0 fitted successfully
2025-10-17 22:31:35,658 - utils.gap_decomposition - INFO - 
Fitting M1...
2025-10-17 22:31:35,658 - utils.gap_decomposition - INFO -   Formula: ERT ~ dyslexic_int * word_length_scaled
2025-10-17 22:31:36,056 - utils.gap_decomposition - INFO -   M1 fitted successfully
2025-10-17 22:31:36,057 - utils.gap_decomposition - INFO - 
Fitting M2...
2025-10-17 22:31:36,057 - utils.gap_decomposition - INFO -   Formula: ERT ~ dyslexic_int * (word_length_scaled + word_frequency_zipf_scaled)
2025-10-17 22:31:36,683 - utils.gap_decomposition - INFO -   M2 fitted successfully
2025-10-17 22:31:36,683 - utils.gap_decomposition - INFO - 
Fitting M3...
2025-10-17 22:31:36,683 - utils.gap_decomposition - INFO -   Formula: ERT ~ dyslexic_int * (word_length_scaled + word_frequency_zipf_scaled + surprisal_scaled)
2025-10-17 22:31:37,319 - utils.gap_decomposition - INFO -   M3 fitted successfully
2025-10-17 22:31:37,332 - utils.gap_decomposition - INFO - 
Computing counterfactual gaps (fixed effects only)...
2025-10-17 22:31:37,504 - utils.gap_decomposition - INFO -   M0: Gap = 4.46ms
2025-10-17 22:31:38,180 - utils.gap_decomposition - INFO -   M1: Gap = -2.71ms
2025-10-17 22:31:38,432 - utils.gap_decomposition - INFO -   M2: Gap = 7.27ms
2025-10-17 22:31:38,757 - utils.gap_decomposition - INFO -   M3: Gap = -0.39ms
2025-10-17 22:31:38,785 - utils.gap_decomposition - INFO - 
Computing marginal R² (fixed effects only)...
2025-10-17 22:31:38,851 - utils.gap_decomposition - INFO -   M0: R² = -0.6099
2025-10-17 22:31:38,882 - utils.gap_decomposition - INFO -   M1: R² = -0.4924
2025-10-17 22:31:38,939 - utils.gap_decomposition - INFO -   M2: R² = -0.5684
2025-10-17 22:31:39,027 - utils.gap_decomposition - INFO -   M3: R² = -0.3842
2025-10-17 22:31:39,029 - utils.gap_decomposition - INFO - 
GAP DECOMPOSITION SUMMARY:
2025-10-17 22:31:39,029 - utils.gap_decomposition - INFO -   Baseline gap (M0): 4.46ms
2025-10-17 22:31:39,030 - utils.gap_decomposition - INFO -   M1: Gap=-2.71ms, Explained=160.7%, DeltaR2=0.1176
2025-10-17 22:31:39,030 - utils.gap_decomposition - INFO -   M2: Gap=7.27ms, Explained=-63.1%, DeltaR2=-0.0760
2025-10-17 22:31:39,030 - utils.gap_decomposition - INFO -   M3: Gap=-0.39ms, Explained=108.7%, DeltaR2=0.1841
2025-10-17 22:31:39,031 - utils.sensitivity_analysis - INFO - ============================================================
2025-10-17 22:31:39,031 - utils.sensitivity_analysis - INFO - SENSITIVITY ANALYSES
2025-10-17 22:31:39,031 - utils.sensitivity_analysis - INFO - ============================================================
2025-10-17 22:31:39,031 - utils.sensitivity_analysis - INFO - 
1. RESIDUALIZED SURPRISAL MODEL
2025-10-17 22:31:39,291 - utils.sensitivity_analysis - INFO -   Formula: ERT ~ dyslexic_int * (word_length_scaled + word_frequency_zipf_scaled + surprisal_resid)
2025-10-17 22:31:39,833 - utils.sensitivity_analysis - INFO -   Residualized surprisal: beta=11.6330, p=0.0000
2025-10-17 22:31:39,834 - utils.sensitivity_analysis - INFO -   [OK] Surprisal effect robust to frequency collinearity
2025-10-17 22:31:39,848 - utils.sensitivity_analysis - INFO - 
2. SUBJECT-WISE CROSS-VALIDATION
2025-10-17 22:31:39,848 - utils.sensitivity_analysis - INFO -   Running 10-fold subject-wise CV...
2025-10-17 22:31:40,106 - utils.sensitivity_analysis - INFO -     Fold 1/10
2025-10-17 22:31:40,736 - utils.sensitivity_analysis - INFO -     Fold 2/10
2025-10-17 22:31:41,403 - utils.sensitivity_analysis - INFO -     Fold 3/10
2025-10-17 22:31:41,997 - utils.sensitivity_analysis - INFO -     Fold 4/10
2025-10-17 22:31:42,655 - utils.sensitivity_analysis - INFO -     Fold 5/10
2025-10-17 22:31:43,250 - utils.sensitivity_analysis - INFO -     Fold 6/10
2025-10-17 22:31:44,460 - utils.sensitivity_analysis - INFO -     Fold 7/10
2025-10-17 22:31:45,058 - utils.sensitivity_analysis - INFO -     Fold 8/10
2025-10-17 22:31:45,678 - utils.sensitivity_analysis - INFO -     Fold 9/10
2025-10-17 22:31:46,268 - utils.sensitivity_analysis - INFO -     Fold 10/10
2025-10-17 22:31:46,874 - utils.sensitivity_analysis - INFO -   Cross-validation R²: -0.3352 ± 0.2999
2025-10-17 22:31:46,874 - utils.sensitivity_analysis - INFO -   Based on 10 successful folds
2025-10-17 22:31:46,917 - utils.sensitivity_analysis - INFO - 
3. ALTERNATIVE BINNING (Terciles & Quintiles)
2025-10-17 22:31:46,917 - utils.sensitivity_analysis - INFO - 
  Testing terciles...
2025-10-17 22:31:47,041 - utils.sensitivity_analysis - INFO -     word_length: Control Delta=202.4ms, Dyslexic Delta=304.4ms
2025-10-17 22:31:47,150 - utils.sensitivity_analysis - INFO -     word_frequency_zipf: Control Delta=-187.4ms, Dyslexic Delta=-283.4ms
2025-10-17 22:31:47,277 - utils.sensitivity_analysis - INFO -     surprisal: Control Delta=112.9ms, Dyslexic Delta=200.7ms
2025-10-17 22:31:47,277 - utils.sensitivity_analysis - INFO - 
  Testing quintiles...
2025-10-17 22:31:47,398 - utils.sensitivity_analysis - INFO -     word_length: Control Delta=284.7ms, Dyslexic Delta=452.5ms
2025-10-17 22:31:47,513 - utils.sensitivity_analysis - INFO -     word_frequency_zipf: Control Delta=-242.1ms, Dyslexic Delta=-393.1ms
2025-10-17 22:31:47,606 - utils.sensitivity_analysis - INFO -     surprisal: Control Delta=150.5ms, Dyslexic Delta=270.2ms
2025-10-17 22:31:47,611 - utils.hypothesis_visualization - INFO - ============================================================
2025-10-17 22:31:47,612 - utils.hypothesis_visualization - INFO - CREATING VISUALIZATIONS
2025-10-17 22:31:47,612 - utils.hypothesis_visualization - INFO - ============================================================
2025-10-17 22:31:47,613 - utils.hypothesis_visualization - INFO - 
1. Continuous effect curves...
2025-10-17 22:31:49,041 - utils.hypothesis_visualization - INFO -   Saved to results\continuous_effects_with_quartiles.png
2025-10-17 22:31:49,043 - utils.hypothesis_visualization - INFO - 2. Gap decomposition...
2025-10-17 22:31:49,254 - utils.hypothesis_visualization - INFO -   Saved to results\gap_decomposition.png
2025-10-17 22:31:49,254 - utils.hypothesis_visualization - INFO - 3. Slope ratios...
2025-10-17 22:31:49,268 - __main__ - ERROR - Pipeline failed: 'xerr' must not contain negative values
Traceback (most recent call last):
  File "C:\Users\hugos\Desktop\Dyslexia_Time_Paper\Dyslexia_Time_Cost_Analysis\main.py", line 759, in main
    pipeline.run_hypothesis_testing_analysis()  # NEW
  File "C:\Users\hugos\Desktop\Dyslexia_Time_Paper\Dyslexia_Time_Cost_Analysis\main.py", line 434, in run_hypothesis_testing_analysis
    create_hypothesis_testing_visualizations(
  File "C:\Users\hugos\Desktop\Dyslexia_Time_Paper\Dyslexia_Time_Cost_Analysis\utils\hypothesis_visualization.py", line 51, in create_hypothesis_testing_visualizations
    plot_slope_ratios(continuous_results, output_dir / "slope_ratios.png")
  File "C:\Users\hugos\Desktop\Dyslexia_Time_Paper\Dyslexia_Time_Cost_Analysis\utils\hypothesis_visualization.py", line 324, in plot_slope_ratios
    bars = ax.barh(
  File "C:\Users\hugos\miniconda3\envs\dyslexia-time-analysis\lib\site-packages\matplotlib\axes\_axes.py", line 2834, in barh
    patches = self.bar(x=left, height=height, width=width, bottom=y,
  File "C:\Users\hugos\miniconda3\envs\dyslexia-time-analysis\lib\site-packages\matplotlib\__init__.py", line 1524, in inner
    return func(
  File "C:\Users\hugos\miniconda3\envs\dyslexia-time-analysis\lib\site-packages\matplotlib\axes\_axes.py", line 2676, in bar
    errorbar = self.errorbar(ex, ey, yerr=yerr, xerr=xerr, fmt='none',
  File "C:\Users\hugos\miniconda3\envs\dyslexia-time-analysis\lib\site-packages\matplotlib\_api\deprecation.py", line 453, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\hugos\miniconda3\envs\dyslexia-time-analysis\lib\site-packages\matplotlib\__init__.py", line 1524, in inner
    return func(
  File "C:\Users\hugos\miniconda3\envs\dyslexia-time-analysis\lib\site-packages\matplotlib\axes\_axes.py", line 3825, in errorbar
    raise ValueError(
ValueError: 'xerr' must not contain negative values
2025-10-17 22:34:51,224 - __main__ - INFO - Dyslexia Time Analysis Pipeline initialized
2025-10-17 22:34:51,226 - __main__ - INFO - Dyslexia Time Analysis Pipeline initialized
2025-10-17 22:34:53,655 - __main__ - INFO - Running hypothesis testing analysis...
2025-10-17 22:34:53,655 - __main__ - INFO - ================================================================================
2025-10-17 22:34:53,655 - __main__ - INFO - HYPOTHESIS TESTING ANALYSIS
2025-10-17 22:34:53,656 - __main__ - INFO - ================================================================================
2025-10-17 22:34:53,656 - __main__ - INFO - Loading CopCo dataset...
2025-10-17 22:34:53,657 - utils.data_utils - INFO - Loading 57 participant files...
2025-10-17 22:34:55,467 - utils.data_utils - INFO - Starting with 335,203 total word entries
2025-10-17 22:34:55,679 - utils.data_utils - INFO - Word fixation patterns:
2025-10-17 22:34:55,680 - utils.data_utils - INFO -   - Skipped words (0 fixations): 126,302
2025-10-17 22:34:55,680 - utils.data_utils - INFO -   - Fixated words (1+ fixations): 208,901
2025-10-17 22:34:55,680 - utils.data_utils - INFO -   - Unknown fixations (NaN): 0
2025-10-17 22:34:55,715 - utils.data_utils - INFO - Fixated words reading times: median 272ms, 99th percentile 1777ms
2025-10-17 22:34:55,719 - utils.data_utils - INFO - Removed 14 fixated words with extreme reading times (0 too short, 14 too long)
2025-10-17 22:34:55,826 - utils.data_utils - INFO - Removed 23 words longer than 30 characters (likely data errors)
2025-10-17 22:34:55,864 - utils.data_utils - INFO - Final dataset: 126,302 skipped words, 208,864 fixated words
2025-10-17 22:34:55,864 - utils.data_utils - INFO - Data cleaning complete: 335,166 words retained (100.0% of original)
2025-10-17 22:34:55,873 - utils.data_utils - INFO - Groups identified: 19 dyslexic, 39 control
2025-10-17 22:34:55,945 - __main__ - INFO - Calculating skipping probabilities...
2025-10-17 22:34:55,948 - utils.skipping_utils - INFO - Skipping analysis from ExtractedFeatures:
2025-10-17 22:34:55,948 - utils.skipping_utils - INFO -   Total words: 335,166
2025-10-17 22:34:55,948 - utils.skipping_utils - INFO -   Skipped: 126,302 (37.7%)
2025-10-17 22:34:55,949 - utils.skipping_utils - INFO -   Fixated: 208,864 (62.3%)
2025-10-17 22:34:55,992 - __main__ - INFO - Skipping analysis: 37.7% overall rate
2025-10-17 22:34:56,012 - __main__ - INFO - Loaded: 335,166 words from 57 participants
2025-10-17 22:34:56,012 - __main__ - INFO - ============================================================
2025-10-17 22:34:56,013 - __main__ - INFO - COMPUTING LINGUISTIC FEATURES
2025-10-17 22:34:56,013 - __main__ - INFO - ============================================================
2025-10-17 22:34:56,013 - utils.linguistic_features - INFO - Loading Danish frequency list from danish_frequencies\danish_leipzig_for_analysis.txt
2025-10-17 22:34:57,330 - utils.linguistic_features - WARNING - Found 2 duplicate words after lowercasing. 
2025-10-17 22:34:57,778 - utils.linguistic_features - INFO - Loaded 1,499,999 word proportions from Leipzig Corpora
2025-10-17 22:34:57,863 - utils.linguistic_features - INFO - Computing word frequency...
2025-10-17 22:34:57,863 - utils.linguistic_features - INFO -   Stripping punctuation from words before frequency lookup
2025-10-17 22:34:58,496 - utils.linguistic_features - INFO - 13 missing word instances were punctuation-only
2025-10-17 22:34:58,496 - utils.linguistic_features - WARNING - 4,586 word instances (1.4%) not found in frequency list (197 unique valid words)
2025-10-17 22:34:58,497 - utils.linguistic_features - INFO - Sample of 197 missing valid words: ['1926-2016', '2. (margrethe', 'abrams efter', 'adunyadet', 'at blomsterstanden er', 'blotgydje', 'blæredygtige', 'broderet messehagler og', 'bygnings-konstruktioner', 'chakri-dynasti', 'dallis', 'downcycling', 'efter star', 'er stakbærende', 'frederik og prins', 'frejakult', 'geografilærers', 'glædesblussene', 'havstrategier', 'herne', 'idahot-forum', 'intersex-inkluderende', 'isotropic', 'it-mulighederne', 'itx-klassen', 'jedi (2017', 'kaldet lemma', 'lgbtqi-miljøet', 'lgbtqi-personer', 'ligusteragtig', 'lærerindejob', 'lærerstuderene', 'løvmand og', 'med prins', 'meduddannere', 'midsommeraftner', 'nabofolkeslag', 'nyreligiøst', 'sankthansormen', 'skywalker også', 'svenske velfærdsstat og', 'tilran', 'top-omstillingsparate', 'traume for', 'vandmiljøindsats', 'vandmiljøindsatsen', 'vk-ånden', 'åbningsriffet', 'årshjulets', 'ættesamfund']... (147 more)
2025-10-17 22:34:58,504 - utils.linguistic_features - INFO - Excluding 4,599 word instances (1.4%) with missing frequencies from analysis
2025-10-17 22:34:58,642 - utils.linguistic_features - INFO - Remaining dataset: 330,567 words
2025-10-17 22:34:58,643 - utils.linguistic_features - INFO - Final dataset: 330,567 words with valid frequencies
2025-10-17 22:35:02,561 - utils.linguistic_features - INFO - Loading causal language model: KennethTM/gpt2-medium-danish
2025-10-17 22:35:04,206 - utils.linguistic_features - INFO - Using CPU for surprisal computation
2025-10-17 22:35:04,206 - utils.linguistic_features - INFO - Causal language model loaded successfully
2025-10-17 22:35:04,206 - utils.linguistic_features - INFO - Computing surprisal with causal GPT-2 (left-to-right)...
2025-10-17 22:35:05,512 - utils.linguistic_features - INFO - Dataset statistics:
2025-10-17 22:35:05,512 - utils.linguistic_features - INFO -   Total participant-sentence instances: 20,707
2025-10-17 22:35:05,513 - utils.linguistic_features - INFO -   Unique sentence texts: 1,986
2025-10-17 22:35:05,513 - utils.linguistic_features - INFO -   Average participants per sentence: 10.4
2025-10-17 22:35:05,513 - utils.linguistic_features - INFO - Loading cached surprisal values from word_surprisal\surprisal_cache_gpt2.pkl
2025-10-17 22:35:05,523 - utils.linguistic_features - INFO - Loaded surprisal for 1,986 unique sentences
2025-10-17 22:35:05,524 - utils.linguistic_features - INFO - Broadcasting surprisal values to all participant instances...
2025-10-17 22:35:05,524 - utils.linguistic_features - INFO -   Mapping surprisal to words...
2025-10-17 22:35:08,657 - utils.linguistic_features - INFO -   Mapped 326,496 words
2025-10-17 22:35:08,659 - utils.linguistic_features - INFO - 
Surprisal Computation Results:
2025-10-17 22:35:08,659 - utils.linguistic_features - INFO -   Unique sentences processed: 1,986
2025-10-17 22:35:08,659 - utils.linguistic_features - INFO -   Total words with surprisal: 326,496 / 330,567
2025-10-17 22:35:08,660 - utils.linguistic_features - INFO -   Mean: 6.93 bits
2025-10-17 22:35:08,663 - utils.linguistic_features - INFO -   Median: 5.69 bits
2025-10-17 22:35:08,665 - utils.linguistic_features - INFO -   Std: 5.55 bits
2025-10-17 22:35:08,665 - utils.linguistic_features - INFO -   Range: [0.00, 59.34] bits
2025-10-17 22:35:08,681 - utils.linguistic_features - INFO - Linguistic features added successfully
2025-10-17 22:35:08,682 - utils.linguistic_features - INFO - 
Feature Summary:
2025-10-17 22:35:08,684 - utils.linguistic_features - INFO -   Word length: mean=4.67, std=3.08
2025-10-17 22:35:08,686 - utils.linguistic_features - INFO -   Zipf frequency: mean=5.85, std=1.38, range=[0.91, 7.51]
2025-10-17 22:35:08,688 - utils.linguistic_features - INFO -   Surprisal: mean=6.93, std=5.55
2025-10-17 22:35:08,696 - utils.hypothesis_testing_utils - INFO - Preparing data for hypothesis testing...
2025-10-17 22:35:08,739 - utils.hypothesis_testing_utils - INFO - Creating ERT variable...
2025-10-17 22:35:08,742 - utils.hypothesis_testing_utils - INFO -   ERT created: 123,666 skipped (0ms), 206,901 fixated
2025-10-17 22:35:08,743 - utils.hypothesis_testing_utils - INFO - Centering and scaling predictors...
2025-10-17 22:35:08,759 - utils.hypothesis_testing_utils - INFO -   word_length: mean=4.67, scale=3.08
2025-10-17 22:35:08,776 - utils.hypothesis_testing_utils - INFO -   word_frequency_zipf: mean=5.85, scale=1.38
2025-10-17 22:35:08,793 - utils.hypothesis_testing_utils - INFO -   surprisal: mean=6.93, scale=5.55
2025-10-17 22:35:08,793 - utils.hypothesis_testing_utils - INFO - Checking collinearity (VIF)...
2025-10-17 22:35:08,911 - utils.hypothesis_testing_utils - INFO - VIF Results:
2025-10-17 22:35:08,912 - utils.hypothesis_testing_utils - INFO -   Length: 2.82 (OK)
2025-10-17 22:35:08,912 - utils.hypothesis_testing_utils - INFO -   Frequency: 3.18 (OK)
2025-10-17 22:35:08,912 - utils.hypothesis_testing_utils - INFO -   Surprisal: 1.41 (OK)
2025-10-17 22:35:08,913 - utils.hypothesis_testing_utils - INFO - Creating residualized surprisal...
2025-10-17 22:35:08,929 - utils.hypothesis_testing_utils - INFO -   Correlation (Frequency-Surprisal): r=-0.539
2025-10-17 22:35:08,929 - utils.hypothesis_testing_utils - INFO -   Residualized surprisal created
2025-10-17 22:35:08,930 - utils.hypothesis_testing_utils - INFO - Defining pooled quartiles...
2025-10-17 22:35:08,944 - utils.hypothesis_testing_utils - INFO -   word_length: Q1=2.00, Q3=6.00
2025-10-17 22:35:08,959 - utils.hypothesis_testing_utils - INFO -   word_frequency_zipf: Q1=4.91, Q3=7.10
2025-10-17 22:35:08,975 - utils.hypothesis_testing_utils - INFO -   surprisal: Q1=2.76, Q3=9.97
2025-10-17 22:35:08,976 - utils.hypothesis_testing_utils - INFO - Data preparation complete: 330,567 words ready for analysis
2025-10-17 22:35:08,997 - utils.quartile_analysis - INFO - ============================================================
2025-10-17 22:35:08,997 - utils.quartile_analysis - INFO - PART A: QUARTILE ANALYSIS (Q1 vs Q3)
2025-10-17 22:35:08,997 - utils.quartile_analysis - INFO - ============================================================
2025-10-17 22:35:08,998 - utils.quartile_analysis - INFO - 
Analyzing word_length...
2025-10-17 22:35:09,876 - utils.quartile_analysis - INFO -   Computed means for 57 participants
2025-10-17 22:35:09,877 - utils.quartile_analysis - INFO -     Control Q3-Q1: 259.7ms
2025-10-17 22:35:09,877 - utils.quartile_analysis - INFO -     Dyslexic Q3-Q1: 442.6ms
2025-10-17 22:35:09,939 - utils.quartile_analysis - INFO -   Fitting mixed model on 152,465 words...
2025-10-17 22:35:10,614 - utils.quartile_analysis - INFO -   Group×Bin interaction: beta=134.79, p=0.0000
2025-10-17 22:35:10,650 - utils.quartile_analysis - INFO -   Computing bootstrap CIs (1000 iterations)...
2025-10-17 22:35:12,454 - utils.quartile_analysis - INFO -   Bootstrap 95% CI for interaction: [98.47, 259.71]
2025-10-17 22:35:12,454 - utils.quartile_analysis - INFO - 
Analyzing word_frequency_zipf...
2025-10-17 22:35:13,293 - utils.quartile_analysis - INFO -   Computed means for 57 participants
2025-10-17 22:35:13,294 - utils.quartile_analysis - INFO -     Control Q3-Q1: -225.9ms
2025-10-17 22:35:13,295 - utils.quartile_analysis - INFO -     Dyslexic Q3-Q1: -388.2ms
2025-10-17 22:35:13,356 - utils.quartile_analysis - INFO -   Fitting mixed model on 162,606 words...
2025-10-17 22:35:16,220 - utils.quartile_analysis - INFO -   Group×Bin interaction: beta=-122.40, p=0.0000
2025-10-17 22:35:16,249 - utils.quartile_analysis - INFO -   Computing bootstrap CIs (1000 iterations)...
2025-10-17 22:35:17,921 - utils.quartile_analysis - INFO -   Bootstrap 95% CI for interaction: [-225.59, -87.90]
2025-10-17 22:35:17,921 - utils.quartile_analysis - INFO - 
Analyzing surprisal...
2025-10-17 22:35:18,694 - utils.quartile_analysis - INFO -   Computed means for 57 participants
2025-10-17 22:35:18,694 - utils.quartile_analysis - INFO -     Control Q3-Q1: 135.8ms
2025-10-17 22:35:18,695 - utils.quartile_analysis - INFO -     Dyslexic Q3-Q1: 277.3ms
2025-10-17 22:35:18,757 - utils.quartile_analysis - INFO -   Fitting mixed model on 163,257 words...
2025-10-17 22:35:21,389 - utils.quartile_analysis - INFO -   Group×Bin interaction: beta=105.53, p=0.0000
2025-10-17 22:35:21,425 - utils.quartile_analysis - INFO -   Computing bootstrap CIs (1000 iterations)...
2025-10-17 22:35:23,163 - utils.quartile_analysis - INFO -   Bootstrap 95% CI for interaction: [84.99, 194.82]
2025-10-17 22:35:23,163 - utils.continuous_models - INFO - ============================================================
2025-10-17 22:35:23,163 - utils.continuous_models - INFO - PART B: CONTINUOUS MODELS (TWO-PART)
2025-10-17 22:35:23,164 - utils.continuous_models - INFO - ============================================================
2025-10-17 22:35:23,164 - utils.continuous_models - INFO - 
1. SKIPPING MODEL (Logistic)
2025-10-17 22:35:23,277 - utils.continuous_models - INFO -   Formula: skipped ~ dyslexic_int * (word_length_scaled + word_frequency_zipf_scaled + surprisal_scaled)
2025-10-17 22:35:23,278 - utils.continuous_models - INFO -   Fitting on 326,496 words...
2025-10-17 22:35:23,716 - utils.continuous_models - INFO -   Model fitted successfully
2025-10-17 22:35:23,717 - utils.continuous_models - INFO -     dyslexic_int:word_length_scaled: beta=-0.0250, p=0.2274
2025-10-17 22:35:23,717 - utils.continuous_models - INFO -     dyslexic_int:word_frequency_zipf_scaled: beta=-0.0640, p=0.0004
2025-10-17 22:35:23,717 - utils.continuous_models - INFO -     dyslexic_int:surprisal_scaled: beta=-0.0272, p=0.0203
2025-10-17 22:35:23,727 - utils.continuous_models - INFO - 
2. DURATION MODEL (Log-TRT | Fixated)
2025-10-17 22:35:23,836 - utils.continuous_models - INFO -   Formula: log_TRT ~ dyslexic_int * (word_length_scaled + word_frequency_zipf_scaled + surprisal_scaled)
2025-10-17 22:35:23,837 - utils.continuous_models - INFO -   Fitting on 204,224 fixated words...
2025-10-17 22:35:24,854 - utils.continuous_models - INFO -   Model fitted successfully
2025-10-17 22:35:24,854 - utils.continuous_models - INFO -   Smearing correction factor: 1.1562
2025-10-17 22:35:24,855 - utils.continuous_models - INFO -     dyslexic_int:word_length_scaled: beta=0.0078, p=0.0585
2025-10-17 22:35:24,855 - utils.continuous_models - INFO -     dyslexic_int:word_frequency_zipf_scaled: beta=-0.0084, p=0.0678
2025-10-17 22:35:24,856 - utils.continuous_models - INFO -     dyslexic_int:surprisal_scaled: beta=0.0349, p=0.0000
2025-10-17 22:35:24,865 - utils.continuous_models - INFO - 
3. SLOPE RATIOS (Dyslexic Amplification)
2025-10-17 22:35:24,865 - utils.continuous_models - INFO -   Length: SR = 1.064 (AMPLIFIED)
2025-10-17 22:35:24,865 - utils.continuous_models - INFO -   Frequency: SR = 1.173 (AMPLIFIED)
2025-10-17 22:35:24,866 - utils.continuous_models - INFO -   Surprisal: SR = 2.100 (AMPLIFIED)
2025-10-17 22:35:24,866 - utils.continuous_models - INFO - 
4. BOOTSTRAP CONFIDENCE INTERVALS
2025-10-17 22:35:24,866 - utils.continuous_models - INFO -   Computing bootstrap CIs (100 iterations)...
2025-10-17 22:35:26,176 - utils.continuous_models - INFO -   Length: 95% CI = [1.561, 2.534]
2025-10-17 22:35:26,177 - utils.continuous_models - INFO -   Frequency: 95% CI = [1.645, 2.586]
2025-10-17 22:35:26,177 - utils.continuous_models - INFO -   Surprisal: 95% CI = [1.921, 3.074]
2025-10-17 22:35:26,177 - utils.continuous_models - INFO - 
5. RECOMBINING TO EXPECTED ERT
2025-10-17 22:35:26,235 - utils.continuous_models - INFO -   Predicting expected ERT...
2025-10-17 22:35:26,492 - utils.continuous_models - INFO -   Predicted ERT for 326,496 words
2025-10-17 22:35:26,494 - utils.continuous_models - INFO -     Mean predicted ERT: 143.91ms
2025-10-17 22:35:26,495 - utils.continuous_models - INFO -     Mean observed ERT: 236.03ms
2025-10-17 22:35:26,509 - utils.gap_decomposition - INFO - ============================================================
2025-10-17 22:35:26,509 - utils.gap_decomposition - INFO - PART C: GAP DECOMPOSITION
2025-10-17 22:35:26,509 - utils.gap_decomposition - INFO - ============================================================
2025-10-17 22:35:26,576 - utils.gap_decomposition - INFO - 
Fitting M0...
2025-10-17 22:35:26,576 - utils.gap_decomposition - INFO -   Formula: ERT ~ dyslexic_int
2025-10-17 22:35:27,022 - utils.gap_decomposition - INFO -   M0 fitted successfully (OLS with clustered SEs)
2025-10-17 22:35:27,022 - utils.gap_decomposition - INFO - 
Fitting M1...
2025-10-17 22:35:27,022 - utils.gap_decomposition - INFO -   Formula: ERT ~ dyslexic_int * word_length_scaled
2025-10-17 22:35:27,430 - utils.gap_decomposition - INFO -   M1 fitted successfully (OLS with clustered SEs)
2025-10-17 22:35:27,430 - utils.gap_decomposition - INFO - 
Fitting M2...
2025-10-17 22:35:27,430 - utils.gap_decomposition - INFO -   Formula: ERT ~ dyslexic_int * (word_length_scaled + word_frequency_zipf_scaled)
2025-10-17 22:35:27,972 - utils.gap_decomposition - INFO -   M2 fitted successfully (OLS with clustered SEs)
2025-10-17 22:35:27,973 - utils.gap_decomposition - INFO - 
Fitting M3...
2025-10-17 22:35:27,973 - utils.gap_decomposition - INFO -   Formula: ERT ~ dyslexic_int * (word_length_scaled + word_frequency_zipf_scaled + surprisal_scaled)
2025-10-17 22:35:28,504 - utils.gap_decomposition - INFO -   M3 fitted successfully (OLS with clustered SEs)
2025-10-17 22:35:28,516 - utils.gap_decomposition - INFO - 
Computing counterfactual gaps (fixed effects only)...
2025-10-17 22:35:28,517 - utils.gap_decomposition - ERROR -   M0 gap computation failed: 'OLSResults' object has no attribute 'fe_params'
2025-10-17 22:35:28,517 - utils.gap_decomposition - ERROR -   M1 gap computation failed: 'OLSResults' object has no attribute 'fe_params'
2025-10-17 22:35:28,517 - utils.gap_decomposition - ERROR -   M2 gap computation failed: 'OLSResults' object has no attribute 'fe_params'
2025-10-17 22:35:28,517 - utils.gap_decomposition - ERROR -   M3 gap computation failed: 'OLSResults' object has no attribute 'fe_params'
2025-10-17 22:35:28,517 - utils.gap_decomposition - INFO - 
Computing R²...
2025-10-17 22:35:28,527 - utils.gap_decomposition - INFO -   M0: R² = 0.0352
2025-10-17 22:35:28,538 - utils.gap_decomposition - INFO -   M1: R² = 0.1672
2025-10-17 22:35:28,548 - utils.gap_decomposition - INFO -   M2: R² = 0.1716
2025-10-17 22:35:28,559 - utils.gap_decomposition - INFO -   M3: R² = 0.1741
2025-10-17 22:35:28,559 - utils.gap_decomposition - WARNING - Baseline gap is 0 or NaN, cannot compute % explained
2025-10-17 22:35:28,559 - utils.gap_decomposition - INFO - 
GAP DECOMPOSITION SUMMARY:
2025-10-17 22:35:28,559 - utils.gap_decomposition - INFO -   Baseline gap (M0): nanms
2025-10-17 22:35:28,559 - utils.gap_decomposition - INFO -   M1: Gap=nanms, Explained=nan%, DeltaR2=0.1320
2025-10-17 22:35:28,560 - utils.gap_decomposition - INFO -   M2: Gap=nanms, Explained=nan%, DeltaR2=0.0044
2025-10-17 22:35:28,560 - utils.gap_decomposition - INFO -   M3: Gap=nanms, Explained=nan%, DeltaR2=0.0025
2025-10-17 22:35:28,560 - utils.sensitivity_analysis - INFO - ============================================================
2025-10-17 22:35:28,560 - utils.sensitivity_analysis - INFO - SENSITIVITY ANALYSES
2025-10-17 22:35:28,560 - utils.sensitivity_analysis - INFO - ============================================================
2025-10-17 22:35:28,560 - utils.sensitivity_analysis - INFO - 
1. RESIDUALIZED SURPRISAL MODEL
2025-10-17 22:35:28,648 - utils.sensitivity_analysis - INFO -   Formula: ERT ~ dyslexic_int * (word_length_scaled + word_frequency_zipf_scaled + surprisal_resid)
2025-10-17 22:35:29,160 - utils.sensitivity_analysis - INFO -   Residualized surprisal: beta=11.6330, p=0.0000
2025-10-17 22:35:29,160 - utils.sensitivity_analysis - INFO -   [OK] Surprisal effect robust to frequency collinearity
2025-10-17 22:35:29,175 - utils.sensitivity_analysis - INFO - 
2. SUBJECT-WISE CROSS-VALIDATION
2025-10-17 22:35:29,175 - utils.sensitivity_analysis - INFO -   Running 10-fold subject-wise CV...
2025-10-17 22:35:29,427 - utils.sensitivity_analysis - INFO -     Fold 1/10
2025-10-17 22:35:30,225 - utils.sensitivity_analysis - INFO -     Fold 2/10
2025-10-17 22:35:30,790 - utils.sensitivity_analysis - INFO -     Fold 3/10
2025-10-17 22:35:31,339 - utils.sensitivity_analysis - INFO -     Fold 4/10
2025-10-17 22:35:31,938 - utils.sensitivity_analysis - INFO -     Fold 5/10
2025-10-17 22:35:32,616 - utils.sensitivity_analysis - INFO -     Fold 6/10
2025-10-17 22:35:34,042 - utils.sensitivity_analysis - INFO -     Fold 7/10
2025-10-17 22:35:34,763 - utils.sensitivity_analysis - INFO -     Fold 8/10
2025-10-17 22:35:35,371 - utils.sensitivity_analysis - INFO -     Fold 9/10
2025-10-17 22:35:35,979 - utils.sensitivity_analysis - INFO -     Fold 10/10
2025-10-17 22:35:36,597 - utils.sensitivity_analysis - INFO -   Cross-validation R²: -0.3352 ± 0.2999
2025-10-17 22:35:36,597 - utils.sensitivity_analysis - INFO -   Based on 10 successful folds
2025-10-17 22:35:36,646 - utils.sensitivity_analysis - INFO - 
3. ALTERNATIVE BINNING (Terciles & Quintiles)
2025-10-17 22:35:36,646 - utils.sensitivity_analysis - INFO - 
  Testing terciles...
2025-10-17 22:35:36,780 - utils.sensitivity_analysis - INFO -     word_length: Control Delta=202.4ms, Dyslexic Delta=304.4ms
2025-10-17 22:35:36,881 - utils.sensitivity_analysis - INFO -     word_frequency_zipf: Control Delta=-187.4ms, Dyslexic Delta=-283.4ms
2025-10-17 22:35:36,983 - utils.sensitivity_analysis - INFO -     surprisal: Control Delta=112.9ms, Dyslexic Delta=200.7ms
2025-10-17 22:35:36,984 - utils.sensitivity_analysis - INFO - 
  Testing quintiles...
2025-10-17 22:35:37,059 - utils.sensitivity_analysis - INFO -     word_length: Control Delta=284.7ms, Dyslexic Delta=452.5ms
2025-10-17 22:35:37,138 - utils.sensitivity_analysis - INFO -     word_frequency_zipf: Control Delta=-242.1ms, Dyslexic Delta=-393.1ms
2025-10-17 22:35:37,220 - utils.sensitivity_analysis - INFO -     surprisal: Control Delta=150.5ms, Dyslexic Delta=270.2ms
2025-10-17 22:35:37,226 - utils.hypothesis_visualization - INFO - ============================================================
2025-10-17 22:35:37,227 - utils.hypothesis_visualization - INFO - CREATING VISUALIZATIONS
2025-10-17 22:35:37,227 - utils.hypothesis_visualization - INFO - ============================================================
2025-10-17 22:35:37,227 - utils.hypothesis_visualization - INFO - 
1. Continuous effect curves...
2025-10-17 22:35:38,493 - utils.hypothesis_visualization - INFO -   Saved to results\continuous_effects_with_quartiles.png
2025-10-17 22:35:38,495 - utils.hypothesis_visualization - INFO - 2. Gap decomposition...
2025-10-17 22:35:38,755 - utils.hypothesis_visualization - INFO -   Saved to results\gap_decomposition.png
2025-10-17 22:35:38,756 - utils.hypothesis_visualization - INFO - 3. Slope ratios...
2025-10-17 22:35:38,771 - __main__ - ERROR - Pipeline failed: 'xerr' must not contain negative values
Traceback (most recent call last):
  File "C:\Users\hugos\Desktop\Dyslexia_Time_Paper\Dyslexia_Time_Cost_Analysis\main.py", line 759, in main
    pipeline.run_hypothesis_testing_analysis()  # NEW
  File "C:\Users\hugos\Desktop\Dyslexia_Time_Paper\Dyslexia_Time_Cost_Analysis\main.py", line 434, in run_hypothesis_testing_analysis
    create_hypothesis_testing_visualizations(
  File "C:\Users\hugos\Desktop\Dyslexia_Time_Paper\Dyslexia_Time_Cost_Analysis\utils\hypothesis_visualization.py", line 51, in create_hypothesis_testing_visualizations
    plot_slope_ratios(continuous_results, output_dir / "slope_ratios.png")
  File "C:\Users\hugos\Desktop\Dyslexia_Time_Paper\Dyslexia_Time_Cost_Analysis\utils\hypothesis_visualization.py", line 324, in plot_slope_ratios
    bars = ax.barh(
  File "C:\Users\hugos\miniconda3\envs\dyslexia-time-analysis\lib\site-packages\matplotlib\axes\_axes.py", line 2834, in barh
    patches = self.bar(x=left, height=height, width=width, bottom=y,
  File "C:\Users\hugos\miniconda3\envs\dyslexia-time-analysis\lib\site-packages\matplotlib\__init__.py", line 1524, in inner
    return func(
  File "C:\Users\hugos\miniconda3\envs\dyslexia-time-analysis\lib\site-packages\matplotlib\axes\_axes.py", line 2676, in bar
    errorbar = self.errorbar(ex, ey, yerr=yerr, xerr=xerr, fmt='none',
  File "C:\Users\hugos\miniconda3\envs\dyslexia-time-analysis\lib\site-packages\matplotlib\_api\deprecation.py", line 453, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\hugos\miniconda3\envs\dyslexia-time-analysis\lib\site-packages\matplotlib\__init__.py", line 1524, in inner
    return func(
  File "C:\Users\hugos\miniconda3\envs\dyslexia-time-analysis\lib\site-packages\matplotlib\axes\_axes.py", line 3825, in errorbar
    raise ValueError(
ValueError: 'xerr' must not contain negative values
2025-10-17 22:38:14,327 - __main__ - INFO - Dyslexia Time Analysis Pipeline initialized
2025-10-17 22:38:14,327 - __main__ - INFO - Dyslexia Time Analysis Pipeline initialized
2025-10-17 22:38:22,994 - __main__ - INFO - Running hypothesis testing analysis...
2025-10-17 22:38:22,995 - __main__ - INFO - ================================================================================
2025-10-17 22:38:22,995 - __main__ - INFO - HYPOTHESIS TESTING ANALYSIS
2025-10-17 22:38:22,995 - __main__ - INFO - ================================================================================
2025-10-17 22:38:22,995 - __main__ - INFO - Loading CopCo dataset...
2025-10-17 22:38:22,996 - utils.data_utils - INFO - Loading 57 participant files...
2025-10-17 22:38:24,761 - utils.data_utils - INFO - Starting with 335,203 total word entries
2025-10-17 22:38:24,957 - utils.data_utils - INFO - Word fixation patterns:
2025-10-17 22:38:24,958 - utils.data_utils - INFO -   - Skipped words (0 fixations): 126,302
2025-10-17 22:38:24,958 - utils.data_utils - INFO -   - Fixated words (1+ fixations): 208,901
2025-10-17 22:38:24,959 - utils.data_utils - INFO -   - Unknown fixations (NaN): 0
2025-10-17 22:38:24,992 - utils.data_utils - INFO - Fixated words reading times: median 272ms, 99th percentile 1777ms
2025-10-17 22:38:24,994 - utils.data_utils - INFO - Removed 14 fixated words with extreme reading times (0 too short, 14 too long)
2025-10-17 22:38:25,100 - utils.data_utils - INFO - Removed 23 words longer than 30 characters (likely data errors)
2025-10-17 22:38:25,138 - utils.data_utils - INFO - Final dataset: 126,302 skipped words, 208,864 fixated words
2025-10-17 22:38:25,138 - utils.data_utils - INFO - Data cleaning complete: 335,166 words retained (100.0% of original)
2025-10-17 22:38:25,148 - utils.data_utils - INFO - Groups identified: 19 dyslexic, 39 control
2025-10-17 22:38:25,232 - __main__ - INFO - Calculating skipping probabilities...
2025-10-17 22:38:25,237 - utils.skipping_utils - INFO - Skipping analysis from ExtractedFeatures:
2025-10-17 22:38:25,237 - utils.skipping_utils - INFO -   Total words: 335,166
2025-10-17 22:38:25,237 - utils.skipping_utils - INFO -   Skipped: 126,302 (37.7%)
2025-10-17 22:38:25,237 - utils.skipping_utils - INFO -   Fixated: 208,864 (62.3%)
2025-10-17 22:38:25,289 - __main__ - INFO - Skipping analysis: 37.7% overall rate
2025-10-17 22:38:25,306 - __main__ - INFO - Loaded: 335,166 words from 57 participants
2025-10-17 22:38:25,307 - __main__ - INFO - ============================================================
2025-10-17 22:38:25,307 - __main__ - INFO - COMPUTING LINGUISTIC FEATURES
2025-10-17 22:38:25,307 - __main__ - INFO - ============================================================
2025-10-17 22:38:25,307 - utils.linguistic_features - INFO - Loading Danish frequency list from danish_frequencies\danish_leipzig_for_analysis.txt
2025-10-17 22:38:26,669 - utils.linguistic_features - WARNING - Found 2 duplicate words after lowercasing. 
2025-10-17 22:38:27,075 - utils.linguistic_features - INFO - Loaded 1,499,999 word proportions from Leipzig Corpora
2025-10-17 22:38:27,167 - utils.linguistic_features - INFO - Computing word frequency...
2025-10-17 22:38:27,168 - utils.linguistic_features - INFO -   Stripping punctuation from words before frequency lookup
2025-10-17 22:38:27,849 - utils.linguistic_features - INFO - 13 missing word instances were punctuation-only
2025-10-17 22:38:27,849 - utils.linguistic_features - WARNING - 4,586 word instances (1.4%) not found in frequency list (197 unique valid words)
2025-10-17 22:38:27,849 - utils.linguistic_features - INFO - Sample of 197 missing valid words: ['af christian', 'af imperialismen', 'affaldspolitikken', 'alauda', 'april 1940 på amalienborg', 'blotgydje', 'broder-søsterligt', 'bygnings-konstruktioner', 'elevrådsarrangementer', 'emancipationskravet', 'flensborggården', 'fosforressourcer', 'første krigsminister, a.f', 'geografilærers', 'glædesblussene', 'græssteppefugl', 'havstrategidirektivets', 'havtema', 'hejre (bromus', 'i græs-familien', 'ingrid, danmarks', 'isotropic', 'jedi (2017', 'kabeltromlerne', 'kentauerhaven', 'klimatilpasningspakke', 'kvantepartiklerne', 'lgbtqi-miljøet', 'lgbtqi-personer', 'løvmand og', 'minervafester', 'palme (1927-1986', 'phumiphon', 'pinsesalmerne', 'rekrutteringsindsatsen', 'renæssancekongen', 'sankthansormen', 'sejdkunst', 'skraldefester', 'snaksalighed', 'som star', 'spejder-juniorer', 'spådomsevner', 'sønnerne kronprins', 'tilran', 'vandmiljøindsatsen', 'vaneslægt', 'vindmølle-testanlægget', 'vindmøllehoveder', 'ættesamfund']... (147 more)
2025-10-17 22:38:27,855 - utils.linguistic_features - INFO - Excluding 4,599 word instances (1.4%) with missing frequencies from analysis
2025-10-17 22:38:27,978 - utils.linguistic_features - INFO - Remaining dataset: 330,567 words
2025-10-17 22:38:27,979 - utils.linguistic_features - INFO - Final dataset: 330,567 words with valid frequencies
2025-10-17 22:38:31,826 - utils.linguistic_features - INFO - Loading causal language model: KennethTM/gpt2-medium-danish
2025-10-17 22:38:33,258 - utils.linguistic_features - INFO - Using CPU for surprisal computation
2025-10-17 22:38:33,259 - utils.linguistic_features - INFO - Causal language model loaded successfully
2025-10-17 22:38:33,259 - utils.linguistic_features - INFO - Computing surprisal with causal GPT-2 (left-to-right)...
2025-10-17 22:38:34,577 - utils.linguistic_features - INFO - Dataset statistics:
2025-10-17 22:38:34,577 - utils.linguistic_features - INFO -   Total participant-sentence instances: 20,707
2025-10-17 22:38:34,577 - utils.linguistic_features - INFO -   Unique sentence texts: 1,986
2025-10-17 22:38:34,578 - utils.linguistic_features - INFO -   Average participants per sentence: 10.4
2025-10-17 22:38:34,578 - utils.linguistic_features - INFO - Loading cached surprisal values from word_surprisal\surprisal_cache_gpt2.pkl
2025-10-17 22:38:34,590 - utils.linguistic_features - INFO - Loaded surprisal for 1,986 unique sentences
2025-10-17 22:38:34,590 - utils.linguistic_features - INFO - Broadcasting surprisal values to all participant instances...
2025-10-17 22:38:34,591 - utils.linguistic_features - INFO -   Mapping surprisal to words...
2025-10-17 22:38:37,731 - utils.linguistic_features - INFO -   Mapped 326,496 words
2025-10-17 22:38:37,732 - utils.linguistic_features - INFO - 
Surprisal Computation Results:
2025-10-17 22:38:37,732 - utils.linguistic_features - INFO -   Unique sentences processed: 1,986
2025-10-17 22:38:37,733 - utils.linguistic_features - INFO -   Total words with surprisal: 326,496 / 330,567
2025-10-17 22:38:37,733 - utils.linguistic_features - INFO -   Mean: 6.93 bits
2025-10-17 22:38:37,737 - utils.linguistic_features - INFO -   Median: 5.69 bits
2025-10-17 22:38:37,738 - utils.linguistic_features - INFO -   Std: 5.55 bits
2025-10-17 22:38:37,738 - utils.linguistic_features - INFO -   Range: [0.00, 59.34] bits
2025-10-17 22:38:37,754 - utils.linguistic_features - INFO - Linguistic features added successfully
2025-10-17 22:38:37,754 - utils.linguistic_features - INFO - 
Feature Summary:
2025-10-17 22:38:37,756 - utils.linguistic_features - INFO -   Word length: mean=4.67, std=3.08
2025-10-17 22:38:37,758 - utils.linguistic_features - INFO -   Zipf frequency: mean=5.85, std=1.38, range=[0.91, 7.51]
2025-10-17 22:38:37,760 - utils.linguistic_features - INFO -   Surprisal: mean=6.93, std=5.55
2025-10-17 22:38:37,770 - utils.hypothesis_testing_utils - INFO - Preparing data for hypothesis testing...
2025-10-17 22:38:37,816 - utils.hypothesis_testing_utils - INFO - Creating ERT variable...
2025-10-17 22:38:37,820 - utils.hypothesis_testing_utils - INFO -   ERT created: 123,666 skipped (0ms), 206,901 fixated
2025-10-17 22:38:37,820 - utils.hypothesis_testing_utils - INFO - Centering and scaling predictors...
2025-10-17 22:38:37,836 - utils.hypothesis_testing_utils - INFO -   word_length: mean=4.67, scale=3.08
2025-10-17 22:38:37,852 - utils.hypothesis_testing_utils - INFO -   word_frequency_zipf: mean=5.85, scale=1.38
2025-10-17 22:38:37,868 - utils.hypothesis_testing_utils - INFO -   surprisal: mean=6.93, scale=5.55
2025-10-17 22:38:37,868 - utils.hypothesis_testing_utils - INFO - Checking collinearity (VIF)...
2025-10-17 22:38:37,952 - utils.hypothesis_testing_utils - INFO - VIF Results:
2025-10-17 22:38:37,952 - utils.hypothesis_testing_utils - INFO -   Length: 2.82 (OK)
2025-10-17 22:38:37,952 - utils.hypothesis_testing_utils - INFO -   Frequency: 3.18 (OK)
2025-10-17 22:38:37,953 - utils.hypothesis_testing_utils - INFO -   Surprisal: 1.41 (OK)
2025-10-17 22:38:37,953 - utils.hypothesis_testing_utils - INFO - Creating residualized surprisal...
2025-10-17 22:38:37,967 - utils.hypothesis_testing_utils - INFO -   Correlation (Frequency-Surprisal): r=-0.539
2025-10-17 22:38:37,967 - utils.hypothesis_testing_utils - INFO -   Residualized surprisal created
2025-10-17 22:38:37,968 - utils.hypothesis_testing_utils - INFO - Defining pooled quartiles...
2025-10-17 22:38:37,981 - utils.hypothesis_testing_utils - INFO -   word_length: Q1=2.00, Q3=6.00
2025-10-17 22:38:37,992 - utils.hypothesis_testing_utils - INFO -   word_frequency_zipf: Q1=4.91, Q3=7.10
2025-10-17 22:38:38,004 - utils.hypothesis_testing_utils - INFO -   surprisal: Q1=2.76, Q3=9.97
2025-10-17 22:38:38,005 - utils.hypothesis_testing_utils - INFO - Data preparation complete: 330,567 words ready for analysis
2025-10-17 22:38:38,019 - utils.quartile_analysis - INFO - ============================================================
2025-10-17 22:38:38,019 - utils.quartile_analysis - INFO - PART A: QUARTILE ANALYSIS (Q1 vs Q3)
2025-10-17 22:38:38,019 - utils.quartile_analysis - INFO - ============================================================
2025-10-17 22:38:38,020 - utils.quartile_analysis - INFO - 
Analyzing word_length...
2025-10-17 22:38:38,843 - utils.quartile_analysis - INFO -   Computed means for 57 participants
2025-10-17 22:38:38,845 - utils.quartile_analysis - INFO -     Control Q3-Q1: 259.7ms
2025-10-17 22:38:38,845 - utils.quartile_analysis - INFO -     Dyslexic Q3-Q1: 442.6ms
2025-10-17 22:38:38,907 - utils.quartile_analysis - INFO -   Fitting mixed model on 152,465 words...
2025-10-17 22:38:39,606 - utils.quartile_analysis - INFO -   Group×Bin interaction: beta=134.79, p=0.0000
2025-10-17 22:38:39,642 - utils.quartile_analysis - INFO -   Computing bootstrap CIs (1000 iterations)...
2025-10-17 22:38:41,460 - utils.quartile_analysis - INFO -   Bootstrap 95% CI for interaction: [98.47, 259.71]
2025-10-17 22:38:41,461 - utils.quartile_analysis - INFO - 
Analyzing word_frequency_zipf...
2025-10-17 22:38:42,303 - utils.quartile_analysis - INFO -   Computed means for 57 participants
2025-10-17 22:38:42,303 - utils.quartile_analysis - INFO -     Control Q3-Q1: -225.9ms
2025-10-17 22:38:42,304 - utils.quartile_analysis - INFO -     Dyslexic Q3-Q1: -388.2ms
2025-10-17 22:38:42,365 - utils.quartile_analysis - INFO -   Fitting mixed model on 162,606 words...
2025-10-17 22:38:45,645 - utils.quartile_analysis - INFO -   Group×Bin interaction: beta=-122.40, p=0.0000
2025-10-17 22:38:45,676 - utils.quartile_analysis - INFO -   Computing bootstrap CIs (1000 iterations)...
2025-10-17 22:38:47,451 - utils.quartile_analysis - INFO -   Bootstrap 95% CI for interaction: [-225.59, -87.90]
2025-10-17 22:38:47,452 - utils.quartile_analysis - INFO - 
Analyzing surprisal...
2025-10-17 22:38:48,302 - utils.quartile_analysis - INFO -   Computed means for 57 participants
2025-10-17 22:38:48,303 - utils.quartile_analysis - INFO -     Control Q3-Q1: 135.8ms
2025-10-17 22:38:48,304 - utils.quartile_analysis - INFO -     Dyslexic Q3-Q1: 277.3ms
2025-10-17 22:38:48,370 - utils.quartile_analysis - INFO -   Fitting mixed model on 163,257 words...
2025-10-17 22:38:51,317 - utils.quartile_analysis - INFO -   Group×Bin interaction: beta=105.53, p=0.0000
2025-10-17 22:38:51,350 - utils.quartile_analysis - INFO -   Computing bootstrap CIs (1000 iterations)...
2025-10-17 22:38:53,110 - utils.quartile_analysis - INFO -   Bootstrap 95% CI for interaction: [84.99, 194.82]
2025-10-17 22:38:53,112 - utils.continuous_models - INFO - ============================================================
2025-10-17 22:38:53,112 - utils.continuous_models - INFO - PART B: CONTINUOUS MODELS (TWO-PART)
2025-10-17 22:38:53,112 - utils.continuous_models - INFO - ============================================================
2025-10-17 22:38:53,112 - utils.continuous_models - INFO - 
1. SKIPPING MODEL (Logistic)
2025-10-17 22:38:53,214 - utils.continuous_models - INFO -   Formula: skipped ~ dyslexic_int * (word_length_scaled + word_frequency_zipf_scaled + surprisal_scaled)
2025-10-17 22:38:53,215 - utils.continuous_models - INFO -   Fitting on 326,496 words...
2025-10-17 22:38:53,605 - utils.continuous_models - INFO -   Model fitted successfully
2025-10-17 22:38:53,606 - utils.continuous_models - INFO -     dyslexic_int:word_length_scaled: beta=-0.0250, p=0.2274
2025-10-17 22:38:53,606 - utils.continuous_models - INFO -     dyslexic_int:word_frequency_zipf_scaled: beta=-0.0640, p=0.0004
2025-10-17 22:38:53,606 - utils.continuous_models - INFO -     dyslexic_int:surprisal_scaled: beta=-0.0272, p=0.0203
2025-10-17 22:38:53,616 - utils.continuous_models - INFO - 
2. DURATION MODEL (Log-TRT | Fixated)
2025-10-17 22:38:53,742 - utils.continuous_models - INFO -   Formula: log_TRT ~ dyslexic_int * (word_length_scaled + word_frequency_zipf_scaled + surprisal_scaled)
2025-10-17 22:38:53,742 - utils.continuous_models - INFO -   Fitting on 204,224 fixated words...
2025-10-17 22:38:54,818 - utils.continuous_models - INFO -   Model fitted successfully
2025-10-17 22:38:54,819 - utils.continuous_models - INFO -   Smearing correction factor: 1.1562
2025-10-17 22:38:54,820 - utils.continuous_models - INFO -     dyslexic_int:word_length_scaled: beta=0.0078, p=0.0585
2025-10-17 22:38:54,820 - utils.continuous_models - INFO -     dyslexic_int:word_frequency_zipf_scaled: beta=-0.0084, p=0.0678
2025-10-17 22:38:54,820 - utils.continuous_models - INFO -     dyslexic_int:surprisal_scaled: beta=0.0349, p=0.0000
2025-10-17 22:38:54,828 - utils.continuous_models - INFO - 
3. SLOPE RATIOS (Dyslexic Amplification)
2025-10-17 22:38:54,828 - utils.continuous_models - INFO -   Length: SR = 1.064 (AMPLIFIED)
2025-10-17 22:38:54,829 - utils.continuous_models - INFO -   Frequency: SR = 1.173 (AMPLIFIED)
2025-10-17 22:38:54,829 - utils.continuous_models - INFO -   Surprisal: SR = 2.100 (AMPLIFIED)
2025-10-17 22:38:54,829 - utils.continuous_models - INFO - 
4. BOOTSTRAP CONFIDENCE INTERVALS
2025-10-17 22:38:54,829 - utils.continuous_models - INFO -   Computing bootstrap CIs (100 iterations)...
2025-10-17 22:38:56,167 - utils.continuous_models - INFO -   Length: 95% CI = [1.561, 2.534]
2025-10-17 22:38:56,167 - utils.continuous_models - INFO -   Frequency: 95% CI = [1.645, 2.586]
2025-10-17 22:38:56,168 - utils.continuous_models - INFO -   Surprisal: 95% CI = [1.921, 3.074]
2025-10-17 22:38:56,168 - utils.continuous_models - INFO - 
5. RECOMBINING TO EXPECTED ERT
2025-10-17 22:38:56,220 - utils.continuous_models - INFO -   Predicting expected ERT...
2025-10-17 22:38:56,470 - utils.continuous_models - INFO -   Predicted ERT for 326,496 words
2025-10-17 22:38:56,472 - utils.continuous_models - INFO -     Mean predicted ERT: 143.91ms
2025-10-17 22:38:56,472 - utils.continuous_models - INFO -     Mean observed ERT: 236.03ms
2025-10-17 22:38:56,481 - utils.gap_decomposition - INFO - ============================================================
2025-10-17 22:38:56,481 - utils.gap_decomposition - INFO - PART C: GAP DECOMPOSITION
2025-10-17 22:38:56,481 - utils.gap_decomposition - INFO - ============================================================
2025-10-17 22:38:56,542 - utils.gap_decomposition - INFO - 
Fitting M0...
2025-10-17 22:38:56,542 - utils.gap_decomposition - INFO -   Formula: ERT ~ dyslexic_int
2025-10-17 22:38:56,986 - utils.gap_decomposition - INFO -   M0 fitted successfully (OLS with clustered SEs)
2025-10-17 22:38:56,987 - utils.gap_decomposition - INFO - 
Fitting M1...
2025-10-17 22:38:56,987 - utils.gap_decomposition - INFO -   Formula: ERT ~ dyslexic_int * word_length_scaled
2025-10-17 22:38:57,429 - utils.gap_decomposition - INFO -   M1 fitted successfully (OLS with clustered SEs)
2025-10-17 22:38:57,429 - utils.gap_decomposition - INFO - 
Fitting M2...
2025-10-17 22:38:57,429 - utils.gap_decomposition - INFO -   Formula: ERT ~ dyslexic_int * (word_length_scaled + word_frequency_zipf_scaled)
2025-10-17 22:38:57,959 - utils.gap_decomposition - INFO -   M2 fitted successfully (OLS with clustered SEs)
2025-10-17 22:38:57,959 - utils.gap_decomposition - INFO - 
Fitting M3...
2025-10-17 22:38:57,960 - utils.gap_decomposition - INFO -   Formula: ERT ~ dyslexic_int * (word_length_scaled + word_frequency_zipf_scaled + surprisal_scaled)
2025-10-17 22:38:58,503 - utils.gap_decomposition - INFO -   M3 fitted successfully (OLS with clustered SEs)
2025-10-17 22:38:58,518 - utils.gap_decomposition - INFO - 
Computing counterfactual gaps...
2025-10-17 22:38:58,632 - utils.gap_decomposition - INFO -   M0: Gap = 142.65ms
2025-10-17 22:38:58,768 - utils.gap_decomposition - INFO -   M1: Gap = 141.24ms
2025-10-17 22:38:58,949 - utils.gap_decomposition - INFO -   M2: Gap = 141.42ms
2025-10-17 22:38:59,200 - utils.gap_decomposition - INFO -   M3: Gap = 141.60ms
2025-10-17 22:38:59,223 - utils.gap_decomposition - INFO - 
Computing R²...
2025-10-17 22:38:59,231 - utils.gap_decomposition - INFO -   M0: R² = 0.0352
2025-10-17 22:38:59,241 - utils.gap_decomposition - INFO -   M1: R² = 0.1672
2025-10-17 22:38:59,253 - utils.gap_decomposition - INFO -   M2: R² = 0.1716
2025-10-17 22:38:59,261 - utils.gap_decomposition - INFO -   M3: R² = 0.1741
2025-10-17 22:38:59,261 - utils.gap_decomposition - INFO - 
GAP DECOMPOSITION SUMMARY:
2025-10-17 22:38:59,261 - utils.gap_decomposition - INFO -   Baseline gap (M0): 142.65ms
2025-10-17 22:38:59,261 - utils.gap_decomposition - INFO -   M1: Gap=141.24ms, Explained=1.0%, DeltaR2=0.1320
2025-10-17 22:38:59,261 - utils.gap_decomposition - INFO -   M2: Gap=141.42ms, Explained=0.9%, DeltaR2=0.0044
2025-10-17 22:38:59,262 - utils.gap_decomposition - INFO -   M3: Gap=141.60ms, Explained=0.7%, DeltaR2=0.0025
2025-10-17 22:38:59,262 - utils.sensitivity_analysis - INFO - ============================================================
2025-10-17 22:38:59,262 - utils.sensitivity_analysis - INFO - SENSITIVITY ANALYSES
2025-10-17 22:38:59,262 - utils.sensitivity_analysis - INFO - ============================================================
2025-10-17 22:38:59,262 - utils.sensitivity_analysis - INFO - 
1. RESIDUALIZED SURPRISAL MODEL
2025-10-17 22:38:59,322 - utils.sensitivity_analysis - INFO -   Formula: ERT ~ dyslexic_int * (word_length_scaled + word_frequency_zipf_scaled + surprisal_resid)
2025-10-17 22:38:59,844 - utils.sensitivity_analysis - INFO -   Residualized surprisal: beta=11.6330, p=0.0000
2025-10-17 22:38:59,845 - utils.sensitivity_analysis - INFO -   [OK] Surprisal effect robust to frequency collinearity
2025-10-17 22:38:59,856 - utils.sensitivity_analysis - INFO - 
2. SUBJECT-WISE CROSS-VALIDATION
2025-10-17 22:38:59,857 - utils.sensitivity_analysis - INFO -   Running 10-fold subject-wise CV...
2025-10-17 22:39:00,087 - utils.sensitivity_analysis - INFO -     Fold 1/10
2025-10-17 22:39:00,663 - utils.sensitivity_analysis - INFO -     Fold 2/10
2025-10-17 22:39:01,293 - utils.sensitivity_analysis - INFO -     Fold 3/10
2025-10-17 22:39:01,990 - utils.sensitivity_analysis - INFO -     Fold 4/10
2025-10-17 22:39:02,633 - utils.sensitivity_analysis - INFO -     Fold 5/10
2025-10-17 22:39:03,308 - utils.sensitivity_analysis - INFO -     Fold 6/10
2025-10-17 22:39:04,538 - utils.sensitivity_analysis - INFO -     Fold 7/10
2025-10-17 22:39:05,164 - utils.sensitivity_analysis - INFO -     Fold 8/10
2025-10-17 22:39:05,827 - utils.sensitivity_analysis - INFO -     Fold 9/10
2025-10-17 22:39:06,582 - utils.sensitivity_analysis - INFO -     Fold 10/10
2025-10-17 22:39:07,249 - utils.sensitivity_analysis - INFO -   Cross-validation R²: -0.3352 ± 0.2999
2025-10-17 22:39:07,250 - utils.sensitivity_analysis - INFO -   Based on 10 successful folds
2025-10-17 22:39:07,302 - utils.sensitivity_analysis - INFO - 
3. ALTERNATIVE BINNING (Terciles & Quintiles)
2025-10-17 22:39:07,302 - utils.sensitivity_analysis - INFO - 
  Testing terciles...
2025-10-17 22:39:07,445 - utils.sensitivity_analysis - INFO -     word_length: Control Delta=202.4ms, Dyslexic Delta=304.4ms
2025-10-17 22:39:07,565 - utils.sensitivity_analysis - INFO -     word_frequency_zipf: Control Delta=-187.4ms, Dyslexic Delta=-283.4ms
2025-10-17 22:39:07,680 - utils.sensitivity_analysis - INFO -     surprisal: Control Delta=112.9ms, Dyslexic Delta=200.7ms
2025-10-17 22:39:07,680 - utils.sensitivity_analysis - INFO - 
  Testing quintiles...
2025-10-17 22:39:07,758 - utils.sensitivity_analysis - INFO -     word_length: Control Delta=284.7ms, Dyslexic Delta=452.5ms
2025-10-17 22:39:07,833 - utils.sensitivity_analysis - INFO -     word_frequency_zipf: Control Delta=-242.1ms, Dyslexic Delta=-393.1ms
2025-10-17 22:39:07,915 - utils.sensitivity_analysis - INFO -     surprisal: Control Delta=150.5ms, Dyslexic Delta=270.2ms
2025-10-17 22:39:07,923 - utils.hypothesis_visualization - INFO - ============================================================
2025-10-17 22:39:07,924 - utils.hypothesis_visualization - INFO - CREATING VISUALIZATIONS
2025-10-17 22:39:07,924 - utils.hypothesis_visualization - INFO - ============================================================
2025-10-17 22:39:07,925 - utils.hypothesis_visualization - INFO - 
1. Continuous effect curves...
2025-10-17 22:39:09,225 - utils.hypothesis_visualization - INFO -   Saved to results\continuous_effects_with_quartiles.png
2025-10-17 22:39:09,227 - utils.hypothesis_visualization - INFO - 2. Gap decomposition...
2025-10-17 22:39:09,540 - utils.hypothesis_visualization - INFO -   Saved to results\gap_decomposition.png
2025-10-17 22:39:09,541 - utils.hypothesis_visualization - INFO - 3. Slope ratios...
2025-10-17 22:39:09,555 - __main__ - ERROR - Pipeline failed: 'xerr' must not contain negative values
Traceback (most recent call last):
  File "C:\Users\hugos\Desktop\Dyslexia_Time_Paper\Dyslexia_Time_Cost_Analysis\main.py", line 759, in main
    pipeline.run_hypothesis_testing_analysis()  # NEW
  File "C:\Users\hugos\Desktop\Dyslexia_Time_Paper\Dyslexia_Time_Cost_Analysis\main.py", line 434, in run_hypothesis_testing_analysis
    create_hypothesis_testing_visualizations(
  File "C:\Users\hugos\Desktop\Dyslexia_Time_Paper\Dyslexia_Time_Cost_Analysis\utils\hypothesis_visualization.py", line 51, in create_hypothesis_testing_visualizations
    plot_slope_ratios(continuous_results, output_dir / "slope_ratios.png")
  File "C:\Users\hugos\Desktop\Dyslexia_Time_Paper\Dyslexia_Time_Cost_Analysis\utils\hypothesis_visualization.py", line 324, in plot_slope_ratios
    bars = ax.barh(
  File "C:\Users\hugos\miniconda3\envs\dyslexia-time-analysis\lib\site-packages\matplotlib\axes\_axes.py", line 2834, in barh
    patches = self.bar(x=left, height=height, width=width, bottom=y,
  File "C:\Users\hugos\miniconda3\envs\dyslexia-time-analysis\lib\site-packages\matplotlib\__init__.py", line 1524, in inner
    return func(
  File "C:\Users\hugos\miniconda3\envs\dyslexia-time-analysis\lib\site-packages\matplotlib\axes\_axes.py", line 2676, in bar
    errorbar = self.errorbar(ex, ey, yerr=yerr, xerr=xerr, fmt='none',
  File "C:\Users\hugos\miniconda3\envs\dyslexia-time-analysis\lib\site-packages\matplotlib\_api\deprecation.py", line 453, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\hugos\miniconda3\envs\dyslexia-time-analysis\lib\site-packages\matplotlib\__init__.py", line 1524, in inner
    return func(
  File "C:\Users\hugos\miniconda3\envs\dyslexia-time-analysis\lib\site-packages\matplotlib\axes\_axes.py", line 3825, in errorbar
    raise ValueError(
ValueError: 'xerr' must not contain negative values
2025-10-17 22:59:33,432 - __main__ - INFO - Dyslexia Time Analysis Pipeline initialized
2025-10-17 22:59:33,432 - __main__ - INFO - Dyslexia Time Analysis Pipeline initialized
2025-10-17 22:59:34,432 - __main__ - INFO - Running hypothesis testing analysis...
2025-10-17 22:59:34,433 - __main__ - INFO - ================================================================================
2025-10-17 22:59:34,433 - __main__ - INFO - HYPOTHESIS TESTING ANALYSIS
2025-10-17 22:59:34,433 - __main__ - INFO - ================================================================================
2025-10-17 22:59:34,433 - __main__ - INFO - Loading CopCo dataset...
2025-10-17 22:59:34,440 - utils.data_utils - INFO - Loading 57 participant files...
2025-10-17 22:59:36,398 - utils.data_utils - INFO - Starting with 335,203 total word entries
2025-10-17 22:59:36,617 - utils.data_utils - INFO - Word fixation patterns:
2025-10-17 22:59:36,618 - utils.data_utils - INFO -   - Skipped words (0 fixations): 126,302
2025-10-17 22:59:36,618 - utils.data_utils - INFO -   - Fixated words (1+ fixations): 208,901
2025-10-17 22:59:36,618 - utils.data_utils - INFO -   - Unknown fixations (NaN): 0
2025-10-17 22:59:36,658 - utils.data_utils - INFO - Fixated words reading times: median 272ms, 99th percentile 1777ms
2025-10-17 22:59:36,661 - utils.data_utils - INFO - Removed 14 fixated words with extreme reading times (0 too short, 14 too long)
2025-10-17 22:59:36,776 - utils.data_utils - INFO - Removed 23 words longer than 30 characters (likely data errors)
2025-10-17 22:59:36,817 - utils.data_utils - INFO - Final dataset: 126,302 skipped words, 208,864 fixated words
2025-10-17 22:59:36,817 - utils.data_utils - INFO - Data cleaning complete: 335,166 words retained (100.0% of original)
2025-10-17 22:59:36,828 - utils.data_utils - INFO - Groups identified: 19 dyslexic, 39 control
2025-10-17 22:59:36,902 - __main__ - INFO - Calculating skipping probabilities...
2025-10-17 22:59:36,906 - utils.skipping_utils - INFO - Skipping analysis from ExtractedFeatures:
2025-10-17 22:59:36,906 - utils.skipping_utils - INFO -   Total words: 335,166
2025-10-17 22:59:36,906 - utils.skipping_utils - INFO -   Skipped: 126,302 (37.7%)
2025-10-17 22:59:36,906 - utils.skipping_utils - INFO -   Fixated: 208,864 (62.3%)
2025-10-17 22:59:36,959 - __main__ - INFO - Skipping analysis: 37.7% overall rate
2025-10-17 22:59:36,977 - __main__ - INFO - Loaded: 335,166 words from 57 participants
2025-10-17 22:59:36,978 - __main__ - INFO - ============================================================
2025-10-17 22:59:36,978 - __main__ - INFO - COMPUTING LINGUISTIC FEATURES
2025-10-17 22:59:36,978 - __main__ - INFO - ============================================================
2025-10-17 22:59:36,979 - utils.linguistic_features - INFO - Loading Danish frequency list from danish_frequencies\danish_leipzig_for_analysis.txt
2025-10-17 22:59:38,555 - utils.linguistic_features - WARNING - Found 2 duplicate words after lowercasing. 
2025-10-17 22:59:39,137 - utils.linguistic_features - INFO - Loaded 1,499,999 word proportions from Leipzig Corpora
2025-10-17 22:59:39,272 - utils.linguistic_features - INFO - Computing word frequency...
2025-10-17 22:59:39,272 - utils.linguistic_features - INFO -   Stripping punctuation from words before frequency lookup
2025-10-17 22:59:40,061 - utils.linguistic_features - INFO - 13 missing word instances were punctuation-only
2025-10-17 22:59:40,062 - utils.linguistic_features - WARNING - 4,586 word instances (1.4%) not found in frequency list (197 unique valid words)
2025-10-17 22:59:40,062 - utils.linguistic_features - INFO - Sample of 197 missing valid words: ['1986. mordet', '2. (margrethe', '2000-direktiverne', '3.g-underholdning', 'af imperialismen', 'amerikansk science', 'april 1940 på amalienborg', 'bliniopskrifter', 'blintzes', 'by-spildevandet', 'bygnings-konstruktioner', 'chakri-dynasti', 'cølibatægteskabet', 'dambrugsområdet', 'demonstrationsland', 'entrébeløb', 'forårsbebudning', 'frejakult', 'glædesblussene', 'go-to-ting', 'grillparties', 'itx-klasse', 'jernalderkulturen', 'klimatilpasningslov', 'klimatilpasningspakke', 'leartess', 'lederun', 'lgbtqi-miljøet', 'livsgrøden', 'm.a.r.s', 'majestæt dronning', 'melatoninen', 'miljøsejr', 'nivaagaard-tradition', 'palme har', 'regnvandsbidrag', 'rekrutteringsindsatsen', 'renæssancekongen', 'sankthansormen', 'skraldepigerne', 'spákona', 'spådomsevner', 'stærk lup', 'takstfinansiere', 'til landskabsmaleri', 'vandmiljøindsatsen', 'vk-ånden', 'wadup', 'åbningsriffet', 'årshjulets']... (147 more)
2025-10-17 22:59:40,073 - utils.linguistic_features - INFO - Excluding 4,599 word instances (1.4%) with missing frequencies from analysis
2025-10-17 22:59:40,281 - utils.linguistic_features - INFO - Remaining dataset: 330,567 words
2025-10-17 22:59:40,281 - utils.linguistic_features - INFO - Final dataset: 330,567 words with valid frequencies
2025-10-17 22:59:45,462 - utils.linguistic_features - INFO - Loading causal language model: KennethTM/gpt2-medium-danish
2025-10-17 22:59:47,095 - utils.linguistic_features - INFO - Using CPU for surprisal computation
2025-10-17 22:59:47,095 - utils.linguistic_features - INFO - Causal language model loaded successfully
2025-10-17 22:59:47,095 - utils.linguistic_features - INFO - Computing surprisal with causal GPT-2 (left-to-right)...
2025-10-17 22:59:48,523 - utils.linguistic_features - INFO - Dataset statistics:
2025-10-17 22:59:48,524 - utils.linguistic_features - INFO -   Total participant-sentence instances: 20,707
2025-10-17 22:59:48,524 - utils.linguistic_features - INFO -   Unique sentence texts: 1,986
2025-10-17 22:59:48,524 - utils.linguistic_features - INFO -   Average participants per sentence: 10.4
2025-10-17 22:59:48,524 - utils.linguistic_features - INFO - Loading cached surprisal values from word_surprisal\surprisal_cache_gpt2.pkl
2025-10-17 22:59:48,536 - utils.linguistic_features - INFO - Loaded surprisal for 1,986 unique sentences
2025-10-17 22:59:48,536 - utils.linguistic_features - INFO - Broadcasting surprisal values to all participant instances...
2025-10-17 22:59:48,537 - utils.linguistic_features - INFO -   Mapping surprisal to words...
2025-10-17 22:59:52,241 - utils.linguistic_features - INFO -   Mapped 326,496 words
2025-10-17 22:59:52,243 - utils.linguistic_features - INFO - 
Surprisal Computation Results:
2025-10-17 22:59:52,243 - utils.linguistic_features - INFO -   Unique sentences processed: 1,986
2025-10-17 22:59:52,243 - utils.linguistic_features - INFO -   Total words with surprisal: 326,496 / 330,567
2025-10-17 22:59:52,244 - utils.linguistic_features - INFO -   Mean: 6.93 bits
2025-10-17 22:59:52,254 - utils.linguistic_features - INFO -   Median: 5.69 bits
2025-10-17 22:59:52,256 - utils.linguistic_features - INFO -   Std: 5.55 bits
2025-10-17 22:59:52,257 - utils.linguistic_features - INFO -   Range: [0.00, 59.34] bits
2025-10-17 22:59:52,292 - utils.linguistic_features - INFO - Linguistic features added successfully
2025-10-17 22:59:52,292 - utils.linguistic_features - INFO - 
Feature Summary:
2025-10-17 22:59:52,298 - utils.linguistic_features - INFO -   Word length: mean=4.67, std=3.08
2025-10-17 22:59:52,301 - utils.linguistic_features - INFO -   Zipf frequency: mean=5.85, std=1.38, range=[0.91, 7.51]
2025-10-17 22:59:52,303 - utils.linguistic_features - INFO -   Surprisal: mean=6.93, std=5.55
2025-10-17 22:59:52,334 - utils.hypothesis_testing_utils - INFO - Preparing data for hypothesis testing...
2025-10-17 22:59:52,401 - utils.hypothesis_testing_utils - INFO - Creating ERT variable...
2025-10-17 22:59:52,408 - utils.hypothesis_testing_utils - INFO -   ERT created: 123,666 skipped (0ms), 206,901 fixated
2025-10-17 22:59:52,409 - utils.hypothesis_testing_utils - INFO - Centering and scaling predictors...
2025-10-17 22:59:52,445 - utils.hypothesis_testing_utils - INFO -   word_length: mean=4.67, scale=3.08
2025-10-17 22:59:52,464 - utils.hypothesis_testing_utils - INFO -   word_frequency_zipf: mean=5.85, scale=1.38
2025-10-17 22:59:52,482 - utils.hypothesis_testing_utils - INFO -   surprisal: mean=6.93, scale=5.55
2025-10-17 22:59:52,483 - utils.hypothesis_testing_utils - INFO - Checking collinearity (VIF)...
2025-10-17 22:59:52,763 - utils.hypothesis_testing_utils - INFO - VIF Results:
2025-10-17 22:59:52,763 - utils.hypothesis_testing_utils - INFO -   Length: 2.82 (OK)
2025-10-17 22:59:52,763 - utils.hypothesis_testing_utils - INFO -   Frequency: 3.18 (OK)
2025-10-17 22:59:52,764 - utils.hypothesis_testing_utils - INFO -   Surprisal: 1.41 (OK)
2025-10-17 22:59:52,764 - utils.hypothesis_testing_utils - INFO - Creating residualized surprisal...
2025-10-17 22:59:52,786 - utils.hypothesis_testing_utils - INFO -   Correlation (Frequency-Surprisal): r=-0.539
2025-10-17 22:59:52,786 - utils.hypothesis_testing_utils - INFO -   Residualized surprisal created
2025-10-17 22:59:52,786 - utils.hypothesis_testing_utils - INFO - Defining pooled quartiles...
2025-10-17 22:59:52,809 - utils.hypothesis_testing_utils - INFO -   word_length: Q1=2.00, Q3=6.00
2025-10-17 22:59:52,822 - utils.hypothesis_testing_utils - INFO -   word_frequency_zipf: Q1=4.91, Q3=7.10
2025-10-17 22:59:52,836 - utils.hypothesis_testing_utils - INFO -   surprisal: Q1=2.76, Q3=9.97
2025-10-17 22:59:52,836 - utils.hypothesis_testing_utils - INFO - Data preparation complete: 330,567 words ready for analysis
2025-10-17 22:59:52,851 - utils.quartile_analysis - INFO - ============================================================
2025-10-17 22:59:52,851 - utils.quartile_analysis - INFO - PART A: QUARTILE ANALYSIS (Q1 vs Q3)
2025-10-17 22:59:52,851 - utils.quartile_analysis - INFO - ============================================================
2025-10-17 22:59:52,851 - utils.quartile_analysis - INFO - 
Analyzing word_length...
2025-10-17 22:59:53,737 - utils.quartile_analysis - INFO -   Computed means for 57 participants
2025-10-17 22:59:53,738 - utils.quartile_analysis - INFO -     Control Q3-Q1: 259.7ms
2025-10-17 22:59:53,738 - utils.quartile_analysis - INFO -     Dyslexic Q3-Q1: 442.6ms
2025-10-17 22:59:53,799 - utils.quartile_analysis - INFO -   Fitting mixed model on 152,465 words...
2025-10-17 22:59:54,590 - utils.quartile_analysis - INFO -   Group×Bin interaction: beta=134.79, p=0.0000
2025-10-17 22:59:54,618 - utils.quartile_analysis - INFO -   Computing bootstrap CIs (1000 iterations)...
2025-10-17 22:59:56,474 - utils.quartile_analysis - INFO -   Bootstrap 95% CI for interaction: [98.47, 259.71]
2025-10-17 22:59:56,475 - utils.quartile_analysis - INFO - 
Analyzing word_frequency_zipf...
2025-10-17 22:59:57,336 - utils.quartile_analysis - INFO -   Computed means for 57 participants
2025-10-17 22:59:57,337 - utils.quartile_analysis - INFO -     Control Q3-Q1: -225.9ms
2025-10-17 22:59:57,338 - utils.quartile_analysis - INFO -     Dyslexic Q3-Q1: -388.2ms
2025-10-17 22:59:57,403 - utils.quartile_analysis - INFO -   Fitting mixed model on 162,606 words...
2025-10-17 23:00:00,964 - utils.quartile_analysis - INFO -   Group×Bin interaction: beta=-122.40, p=0.0000
2025-10-17 23:00:00,993 - utils.quartile_analysis - INFO -   Computing bootstrap CIs (1000 iterations)...
2025-10-17 23:00:02,873 - utils.quartile_analysis - INFO -   Bootstrap 95% CI for interaction: [-225.59, -87.90]
2025-10-17 23:00:02,874 - utils.quartile_analysis - INFO - 
Analyzing surprisal...
2025-10-17 23:00:03,903 - utils.quartile_analysis - INFO -   Computed means for 57 participants
2025-10-17 23:00:03,904 - utils.quartile_analysis - INFO -     Control Q3-Q1: 135.8ms
2025-10-17 23:00:03,904 - utils.quartile_analysis - INFO -     Dyslexic Q3-Q1: 277.3ms
2025-10-17 23:00:03,994 - utils.quartile_analysis - INFO -   Fitting mixed model on 163,257 words...
2025-10-17 23:00:08,395 - utils.quartile_analysis - INFO -   Group×Bin interaction: beta=105.53, p=0.0000
2025-10-17 23:00:08,431 - utils.quartile_analysis - INFO -   Computing bootstrap CIs (1000 iterations)...
2025-10-18 10:18:38,009 - __main__ - INFO - Dyslexia Time Analysis Pipeline initialized
2025-10-18 10:18:38,010 - __main__ - INFO - Dyslexia Time Analysis Pipeline initialized
2025-10-18 10:18:41,622 - __main__ - INFO - Running hypothesis testing analysis...
2025-10-18 10:18:41,622 - __main__ - INFO - ================================================================================
2025-10-18 10:18:41,623 - __main__ - INFO - HYPOTHESIS TESTING ANALYSIS
2025-10-18 10:18:41,623 - __main__ - INFO - ================================================================================
2025-10-18 10:18:41,623 - __main__ - INFO - Loading CopCo dataset...
2025-10-18 10:18:41,630 - utils.data_utils - INFO - Loading 57 participant files...
2025-10-18 10:18:43,323 - utils.data_utils - INFO - Starting with 335,203 total word entries
2025-10-18 10:18:43,534 - utils.data_utils - INFO - Word fixation patterns:
2025-10-18 10:18:43,535 - utils.data_utils - INFO -   - Skipped words (0 fixations): 126,302
2025-10-18 10:18:43,535 - utils.data_utils - INFO -   - Fixated words (1+ fixations): 208,901
2025-10-18 10:18:43,535 - utils.data_utils - INFO -   - Unknown fixations (NaN): 0
2025-10-18 10:18:43,573 - utils.data_utils - INFO - Fixated words reading times: median 272ms, 99th percentile 1777ms
2025-10-18 10:18:43,575 - utils.data_utils - INFO - Removed 14 fixated words with extreme reading times (0 too short, 14 too long)
2025-10-18 10:18:43,692 - utils.data_utils - INFO - Removed 23 words longer than 30 characters (likely data errors)
2025-10-18 10:18:43,734 - utils.data_utils - INFO - Final dataset: 126,302 skipped words, 208,864 fixated words
2025-10-18 10:18:43,734 - utils.data_utils - INFO - Data cleaning complete: 335,166 words retained (100.0% of original)
2025-10-18 10:18:43,744 - utils.data_utils - INFO - Groups identified: 19 dyslexic, 39 control
2025-10-18 10:18:43,820 - __main__ - INFO - Calculating skipping probabilities...
2025-10-18 10:18:43,824 - utils.skipping_utils - INFO - Skipping analysis from ExtractedFeatures:
2025-10-18 10:18:43,824 - utils.skipping_utils - INFO -   Total words: 335,166
2025-10-18 10:18:43,824 - utils.skipping_utils - INFO -   Skipped: 126,302 (37.7%)
2025-10-18 10:18:43,824 - utils.skipping_utils - INFO -   Fixated: 208,864 (62.3%)
2025-10-18 10:18:43,879 - __main__ - INFO - Skipping analysis: 37.7% overall rate
2025-10-18 10:18:43,901 - __main__ - INFO - Loaded: 335,166 words from 57 participants
2025-10-18 10:18:43,902 - __main__ - INFO - ============================================================
2025-10-18 10:18:43,902 - __main__ - INFO - COMPUTING LINGUISTIC FEATURES
2025-10-18 10:18:43,902 - __main__ - INFO - ============================================================
2025-10-18 10:18:43,903 - utils.linguistic_features - INFO - Loading Danish frequency list from danish_frequencies\danish_leipzig_for_analysis.txt
2025-10-18 10:18:45,418 - utils.linguistic_features - WARNING - Found 2 duplicate words after lowercasing. 
2025-10-18 10:18:45,905 - utils.linguistic_features - INFO - Loaded 1,499,999 word proportions from Leipzig Corpora
2025-10-18 10:18:45,997 - utils.linguistic_features - INFO - Computing word frequency...
2025-10-18 10:18:45,997 - utils.linguistic_features - INFO -   Stripping punctuation from words before frequency lookup
2025-10-18 10:18:46,708 - utils.linguistic_features - INFO - 13 missing word instances were punctuation-only
2025-10-18 10:18:46,708 - utils.linguistic_features - WARNING - 4,586 word instances (1.4%) not found in frequency list (197 unique valid words)
2025-10-18 10:18:46,708 - utils.linguistic_features - INFO - Sample of 197 missing valid words: ['1926-2016', 'abilifyer', 'abrams efter', 'adunyadet', 'af j.j', 'amerikansk science', 'awakens (2015', 'bjergstien', 'broderet messehagler og', 'by-spildevand', 'certeau', 'cochallenge', 'coconference', 'demonstrationsland', 'ecodesign-direktivet', 'emancipationskravet', 'flensborggården', 'forårsbebudning', 'fosforudnyttelsen', 'første krigsminister, a.f', 'go-to-ting', 'hejre (bromus', 'htx-fag', 'itx-klassen', 'lgbtqi-diskrimination', 'lgbtqi-personer', 'ligusteragtig', 'live-action-udgaven', 'lærerstuderene', 'løvmand og', 'm.a.r.s', 'miljøsejr', 'minervafester', 'og star', 'palme har', 'på charlottenborg', 'renæssancekongen', 'sankthansormen', 'sankthanstraditioner', 'skraldefester', 'skywalker også', 'slomo', 'stress-sygdomme', 'subapikalt', 'svenske velfærdsstat og', 'sønnerne kronprins', 'top-omstillingsparate', 'traume for', 'tscherning (1817-1890', 'vandmiljøindsats']... (147 more)
2025-10-18 10:18:46,716 - utils.linguistic_features - INFO - Excluding 4,599 word instances (1.4%) with missing frequencies from analysis
2025-10-18 10:18:46,834 - utils.linguistic_features - INFO - Remaining dataset: 330,567 words
2025-10-18 10:18:46,834 - utils.linguistic_features - INFO - Final dataset: 330,567 words with valid frequencies
2025-10-18 10:18:51,858 - utils.linguistic_features - INFO - Loading causal language model: KennethTM/gpt2-medium-danish
2025-10-18 10:18:53,571 - utils.linguistic_features - INFO - Using CPU for surprisal computation
2025-10-18 10:18:53,572 - utils.linguistic_features - INFO - Causal language model loaded successfully
2025-10-18 10:18:53,572 - utils.linguistic_features - INFO - Computing surprisal with causal GPT-2 (left-to-right)...
2025-10-18 10:18:54,906 - utils.linguistic_features - INFO - Dataset statistics:
2025-10-18 10:18:54,906 - utils.linguistic_features - INFO -   Total participant-sentence instances: 20,707
2025-10-18 10:18:54,906 - utils.linguistic_features - INFO -   Unique sentence texts: 1,986
2025-10-18 10:18:54,907 - utils.linguistic_features - INFO -   Average participants per sentence: 10.4
2025-10-18 10:18:54,907 - utils.linguistic_features - INFO - Loading cached surprisal values from word_surprisal\surprisal_cache_gpt2.pkl
2025-10-18 10:18:54,931 - utils.linguistic_features - INFO - Loaded surprisal for 1,986 unique sentences
2025-10-18 10:18:54,932 - utils.linguistic_features - INFO - Broadcasting surprisal values to all participant instances...
2025-10-18 10:18:54,932 - utils.linguistic_features - INFO -   Mapping surprisal to words...
2025-10-18 10:18:58,194 - utils.linguistic_features - INFO -   Mapped 326,496 words
2025-10-18 10:18:58,196 - utils.linguistic_features - INFO - 
Surprisal Computation Results:
2025-10-18 10:18:58,196 - utils.linguistic_features - INFO -   Unique sentences processed: 1,986
2025-10-18 10:18:58,196 - utils.linguistic_features - INFO -   Total words with surprisal: 326,496 / 330,567
2025-10-18 10:18:58,196 - utils.linguistic_features - INFO -   Mean: 6.93 bits
2025-10-18 10:18:58,201 - utils.linguistic_features - INFO -   Median: 5.69 bits
2025-10-18 10:18:58,202 - utils.linguistic_features - INFO -   Std: 5.55 bits
2025-10-18 10:18:58,203 - utils.linguistic_features - INFO -   Range: [0.00, 59.34] bits
2025-10-18 10:18:58,225 - utils.linguistic_features - INFO - Linguistic features added successfully
2025-10-18 10:18:58,226 - utils.linguistic_features - INFO - 
Feature Summary:
2025-10-18 10:18:58,228 - utils.linguistic_features - INFO -   Word length: mean=4.67, std=3.08
2025-10-18 10:18:58,230 - utils.linguistic_features - INFO -   Zipf frequency: mean=5.85, std=1.38, range=[0.91, 7.51]
2025-10-18 10:18:58,233 - utils.linguistic_features - INFO -   Surprisal: mean=6.93, std=5.55
2025-10-18 10:18:58,243 - utils.hypothesis_testing_utils - INFO - Preparing data for hypothesis testing...
2025-10-18 10:18:58,309 - utils.hypothesis_testing_utils - INFO - Creating ERT variable...
2025-10-18 10:18:58,312 - utils.hypothesis_testing_utils - INFO -   ERT created: 123,666 skipped (0ms), 206,901 fixated
2025-10-18 10:18:58,313 - utils.hypothesis_testing_utils - INFO - Centering and scaling predictors...
2025-10-18 10:18:58,333 - utils.hypothesis_testing_utils - INFO -   word_length: mean=4.67, scale=3.08
2025-10-18 10:18:58,352 - utils.hypothesis_testing_utils - INFO -   word_frequency_zipf: mean=5.85, scale=1.38
2025-10-18 10:18:58,372 - utils.hypothesis_testing_utils - INFO -   surprisal: mean=6.93, scale=5.55
2025-10-18 10:18:58,372 - utils.hypothesis_testing_utils - INFO - Checking collinearity (VIF)...
2025-10-18 10:18:58,517 - utils.hypothesis_testing_utils - INFO - VIF Results:
2025-10-18 10:18:58,518 - utils.hypothesis_testing_utils - INFO -   Length: 2.82 (OK)
2025-10-18 10:18:58,518 - utils.hypothesis_testing_utils - INFO -   Frequency: 3.18 (OK)
2025-10-18 10:18:58,519 - utils.hypothesis_testing_utils - INFO -   Surprisal: 1.41 (OK)
2025-10-18 10:18:58,519 - utils.hypothesis_testing_utils - INFO - Creating residualized surprisal...
2025-10-18 10:18:58,544 - utils.hypothesis_testing_utils - INFO -   Correlation (Frequency-Surprisal): r=-0.539
2025-10-18 10:18:58,545 - utils.hypothesis_testing_utils - INFO -   Residualized surprisal created
2025-10-18 10:18:58,545 - utils.hypothesis_testing_utils - INFO - Defining pooled quartiles...
2025-10-18 10:18:58,563 - utils.hypothesis_testing_utils - INFO -   word_length: Q1=2.00, Q3=6.00
2025-10-18 10:18:58,579 - utils.hypothesis_testing_utils - INFO -   word_frequency_zipf: Q1=4.91, Q3=7.10
2025-10-18 10:18:58,596 - utils.hypothesis_testing_utils - INFO -   surprisal: Q1=2.76, Q3=9.97
2025-10-18 10:18:58,596 - utils.hypothesis_testing_utils - INFO - Data preparation complete: 330,567 words ready for analysis
2025-10-18 10:18:58,612 - utils.quartile_analysis - INFO - ============================================================
2025-10-18 10:18:58,612 - utils.quartile_analysis - INFO - PART A: QUARTILE ANALYSIS (Q1 vs Q3)
2025-10-18 10:18:58,613 - utils.quartile_analysis - INFO - ============================================================
2025-10-18 10:18:58,613 - utils.quartile_analysis - INFO - 
Analyzing word_length...
2025-10-18 10:18:59,488 - utils.quartile_analysis - INFO -   Computed means for 57 participants
2025-10-18 10:18:59,489 - utils.quartile_analysis - INFO -     Control Q3-Q1: 259.7ms
2025-10-18 10:18:59,490 - utils.quartile_analysis - INFO -     Dyslexic Q3-Q1: 442.6ms
2025-10-18 10:18:59,551 - utils.quartile_analysis - INFO -   Fitting mixed model on 152,465 words...
2025-10-18 10:19:00,205 - utils.quartile_analysis - INFO -   Group×Bin interaction: beta=134.79, p=0.0000
2025-10-18 10:19:00,242 - utils.quartile_analysis - INFO -   Computing bootstrap CIs (1000 iterations)...
2025-10-18 10:19:02,043 - utils.quartile_analysis - INFO -   Bootstrap 95% CI for interaction: [98.47, 259.71]
2025-10-18 10:19:02,043 - utils.quartile_analysis - INFO - 
Analyzing word_frequency_zipf...
2025-10-18 10:19:02,883 - utils.quartile_analysis - INFO -   Computed means for 57 participants
2025-10-18 10:19:02,884 - utils.quartile_analysis - INFO -     Control Q3-Q1: -225.9ms
2025-10-18 10:19:02,884 - utils.quartile_analysis - INFO -     Dyslexic Q3-Q1: -388.2ms
2025-10-18 10:19:02,951 - utils.quartile_analysis - INFO -   Fitting mixed model on 162,606 words...
2025-10-18 10:19:06,250 - utils.quartile_analysis - INFO -   Group×Bin interaction: beta=-122.40, p=0.0000
2025-10-18 10:19:06,283 - utils.quartile_analysis - INFO -   Computing bootstrap CIs (1000 iterations)...
2025-10-18 10:19:08,100 - utils.quartile_analysis - INFO -   Bootstrap 95% CI for interaction: [-225.59, -87.90]
2025-10-18 10:19:08,101 - utils.quartile_analysis - INFO - 
Analyzing surprisal...
2025-10-18 10:19:08,949 - utils.quartile_analysis - INFO -   Computed means for 57 participants
2025-10-18 10:19:08,950 - utils.quartile_analysis - INFO -     Control Q3-Q1: 135.8ms
2025-10-18 10:19:08,950 - utils.quartile_analysis - INFO -     Dyslexic Q3-Q1: 277.3ms
2025-10-18 10:19:09,017 - utils.quartile_analysis - INFO -   Fitting mixed model on 163,257 words...
2025-10-18 10:19:11,931 - utils.quartile_analysis - INFO -   Group×Bin interaction: beta=105.53, p=0.0000
2025-10-18 10:19:11,958 - utils.quartile_analysis - INFO -   Computing bootstrap CIs (1000 iterations)...
2025-10-18 10:19:13,792 - utils.quartile_analysis - INFO -   Bootstrap 95% CI for interaction: [84.99, 194.82]
2025-10-18 10:19:13,793 - utils.continuous_models - INFO - ============================================================
2025-10-18 10:19:13,793 - utils.continuous_models - INFO - PART B: CONTINUOUS MODELS (TWO-PART)
2025-10-18 10:19:13,793 - utils.continuous_models - INFO - ============================================================
2025-10-18 10:19:13,793 - utils.continuous_models - INFO - 
1. SKIPPING MODEL (Logistic with Clustered SEs)
2025-10-18 10:19:13,899 - utils.continuous_models - INFO -   Formula: skipped ~ dyslexic_int * (word_length_scaled + word_frequency_zipf_scaled + surprisal_scaled)
2025-10-18 10:19:13,899 - utils.continuous_models - INFO -   Fitting on 326,496 words...
2025-10-18 10:19:14,698 - utils.continuous_models - INFO -   Model fitted successfully with clustered SEs
2025-10-18 10:19:14,699 - utils.continuous_models - INFO -     dyslexic_int:word_length_scaled: beta=-0.0250, p=0.6714
2025-10-18 10:19:14,699 - utils.continuous_models - INFO -     dyslexic_int:word_frequency_zipf_scaled: beta=-0.0640, p=0.1975
2025-10-18 10:19:14,700 - utils.continuous_models - INFO -     dyslexic_int:surprisal_scaled: beta=-0.0272, p=0.2667
2025-10-18 10:19:14,711 - utils.continuous_models - INFO - 
2. DURATION MODEL (Log-TRT | Fixated)
2025-10-18 10:19:14,844 - utils.continuous_models - INFO -   Formula: log_TRT ~ dyslexic_int * (word_length_scaled + word_frequency_zipf_scaled + surprisal_scaled)
2025-10-18 10:19:14,845 - utils.continuous_models - INFO -   Fitting on 204,224 fixated words...
2025-10-18 10:19:16,007 - utils.continuous_models - INFO -   Model fitted successfully
2025-10-18 10:19:16,007 - utils.continuous_models - INFO -   Smearing correction factor: 1.1562
2025-10-18 10:19:16,007 - utils.continuous_models - INFO -     dyslexic_int:word_length_scaled: beta=0.0078, p=0.0585
2025-10-18 10:19:16,008 - utils.continuous_models - INFO -     dyslexic_int:word_frequency_zipf_scaled: beta=-0.0084, p=0.0678
2025-10-18 10:19:16,008 - utils.continuous_models - INFO -     dyslexic_int:surprisal_scaled: beta=0.0349, p=0.0000
2025-10-18 10:19:16,018 - utils.continuous_models - INFO - 
3. PREDICTING EXPECTED ERT
2025-10-18 10:19:16,093 - utils.continuous_models - INFO -   Predicting expected ERT...
2025-10-18 10:19:16,410 - utils.continuous_models - INFO -   Predicted expected ERT for 326,496 words
2025-10-18 10:19:16,412 - utils.continuous_models - INFO -     Mean expected ERT: 143.91ms
2025-10-18 10:19:16,413 - utils.continuous_models - INFO -     Mean observed ERT: 236.03ms
2025-10-18 10:19:16,961 - utils.continuous_models - INFO -     M0: R² = 0.2680
2025-10-18 10:19:17,326 - utils.continuous_models - INFO -     M1: R² = 0.9132
2025-10-18 10:19:17,705 - utils.continuous_models - INFO -     M2: R² = 0.9332
2025-10-18 10:19:18,141 - utils.continuous_models - INFO -     M3: R² = 0.9490
2025-10-18 10:19:18,190 - utils.continuous_models - INFO - 
  word_length: Q1=2.00, Q3=6.00
2025-10-18 10:19:18,311 - __main__ - ERROR - Pipeline failed: predict requires that you use a DataFrame when predicting from a model
that was created using the formula api.

The original error message returned by patsy is:
'DataFrame' object has no attribute 'dtype'
Traceback (most recent call last):
  File "C:\Users\hugos\miniconda3\envs\dyslexia-time-analysis\lib\site-packages\statsmodels\base\model.py", line 1102, in _transform_predict_exog
    exog = dmatrix(design_info, exog, return_type="dataframe")
  File "C:\Users\hugos\miniconda3\envs\dyslexia-time-analysis\lib\site-packages\patsy\highlevel.py", line 296, in dmatrix
    (lhs, rhs) = _do_highlevel_design(
  File "C:\Users\hugos\miniconda3\envs\dyslexia-time-analysis\lib\site-packages\patsy\highlevel.py", line 168, in _do_highlevel_design
    return build_design_matrices(
  File "C:\Users\hugos\miniconda3\envs\dyslexia-time-analysis\lib\site-packages\patsy\build.py", line 954, in build_design_matrices
    value, is_NA = _eval_factor(factor_info, data, NA_action)
  File "C:\Users\hugos\miniconda3\envs\dyslexia-time-analysis\lib\site-packages\patsy\build.py", line 83, in _eval_factor
    "I got non-numeric data of type '%s'" % (factor.name(), result.dtype),
  File "C:\Users\hugos\miniconda3\envs\dyslexia-time-analysis\lib\site-packages\pandas\core\generic.py", line 6321, in __getattr__
    return object.__getattribute__(self, name)
AttributeError: 'DataFrame' object has no attribute 'dtype'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\hugos\Desktop\Dyslexia_Time_Paper\Dyslexia_Time_Cost_Analysis\main.py", line 759, in main
    pipeline.run_hypothesis_testing_analysis()  # NEW
  File "C:\Users\hugos\Desktop\Dyslexia_Time_Paper\Dyslexia_Time_Cost_Analysis\main.py", line 425, in run_hypothesis_testing_analysis
    continuous_results = run_continuous_models(data)
  File "C:\Users\hugos\Desktop\Dyslexia_Time_Paper\Dyslexia_Time_Cost_Analysis\utils\continuous_models.py", line 58, in run_continuous_models
    ms_shifts = compute_ms_shifts(data_with_eert, skip_model, duration_model)
  File "C:\Users\hugos\Desktop\Dyslexia_Time_Paper\Dyslexia_Time_Cost_Analysis\utils\continuous_models.py", line 410, in compute_ms_shifts
    eert_q1 = predict_eert_single(
  File "C:\Users\hugos\Desktop\Dyslexia_Time_Paper\Dyslexia_Time_Cost_Analysis\utils\continuous_models.py", line 444, in predict_eert_single
    log_odds = skip_m.predict(data)
  File "C:\Users\hugos\miniconda3\envs\dyslexia-time-analysis\lib\site-packages\statsmodels\base\model.py", line 1171, in predict
    exog, exog_index = self._transform_predict_exog(exog,
  File "C:\Users\hugos\miniconda3\envs\dyslexia-time-analysis\lib\site-packages\statsmodels\base\model.py", line 1109, in _transform_predict_exog
    raise exc.__class__(msg)
AttributeError: predict requires that you use a DataFrame when predicting from a model
that was created using the formula api.

The original error message returned by patsy is:
'DataFrame' object has no attribute 'dtype'
2025-10-18 10:31:31,084 - __main__ - INFO - Dyslexia Time Analysis Pipeline initialized
2025-10-18 10:31:31,084 - __main__ - INFO - Dyslexia Time Analysis Pipeline initialized
2025-10-18 10:31:33,459 - __main__ - INFO - Running hypothesis testing analysis...
2025-10-18 10:31:33,460 - __main__ - INFO - ================================================================================
2025-10-18 10:31:33,460 - __main__ - INFO - HYPOTHESIS TESTING ANALYSIS
2025-10-18 10:31:33,460 - __main__ - INFO - ================================================================================
2025-10-18 10:31:33,460 - __main__ - INFO - Loading CopCo dataset...
2025-10-18 10:31:33,465 - utils.data_utils - INFO - Loading 57 participant files...
2025-10-18 10:31:35,142 - utils.data_utils - INFO - Starting with 335,203 total word entries
2025-10-18 10:31:35,368 - utils.data_utils - INFO - Word fixation patterns:
2025-10-18 10:31:35,368 - utils.data_utils - INFO -   - Skipped words (0 fixations): 126,302
2025-10-18 10:31:35,368 - utils.data_utils - INFO -   - Fixated words (1+ fixations): 208,901
2025-10-18 10:31:35,368 - utils.data_utils - INFO -   - Unknown fixations (NaN): 0
2025-10-18 10:31:35,404 - utils.data_utils - INFO - Fixated words reading times: median 272ms, 99th percentile 1777ms
2025-10-18 10:31:35,407 - utils.data_utils - INFO - Removed 14 fixated words with extreme reading times (0 too short, 14 too long)
2025-10-18 10:31:35,508 - utils.data_utils - INFO - Removed 23 words longer than 30 characters (likely data errors)
2025-10-18 10:31:35,546 - utils.data_utils - INFO - Final dataset: 126,302 skipped words, 208,864 fixated words
2025-10-18 10:31:35,546 - utils.data_utils - INFO - Data cleaning complete: 335,166 words retained (100.0% of original)
2025-10-18 10:31:35,556 - utils.data_utils - INFO - Groups identified: 19 dyslexic, 39 control
2025-10-18 10:31:35,627 - __main__ - INFO - Calculating skipping probabilities...
2025-10-18 10:31:35,630 - utils.skipping_utils - INFO - Skipping analysis from ExtractedFeatures:
2025-10-18 10:31:35,630 - utils.skipping_utils - INFO -   Total words: 335,166
2025-10-18 10:31:35,631 - utils.skipping_utils - INFO -   Skipped: 126,302 (37.7%)
2025-10-18 10:31:35,631 - utils.skipping_utils - INFO -   Fixated: 208,864 (62.3%)
2025-10-18 10:31:35,681 - __main__ - INFO - Skipping analysis: 37.7% overall rate
2025-10-18 10:31:35,704 - __main__ - INFO - Loaded: 335,166 words from 57 participants
2025-10-18 10:31:35,704 - __main__ - INFO - ============================================================
2025-10-18 10:31:35,704 - __main__ - INFO - COMPUTING LINGUISTIC FEATURES
2025-10-18 10:31:35,704 - __main__ - INFO - ============================================================
2025-10-18 10:31:35,705 - utils.linguistic_features - INFO - Loading Danish frequency list from danish_frequencies\danish_leipzig_for_analysis.txt
2025-10-18 10:31:37,189 - utils.linguistic_features - WARNING - Found 2 duplicate words after lowercasing. 
2025-10-18 10:31:37,699 - utils.linguistic_features - INFO - Loaded 1,499,999 word proportions from Leipzig Corpora
2025-10-18 10:31:37,786 - utils.linguistic_features - INFO - Computing word frequency...
2025-10-18 10:31:37,787 - utils.linguistic_features - INFO -   Stripping punctuation from words before frequency lookup
2025-10-18 10:31:38,465 - utils.linguistic_features - INFO - 13 missing word instances were punctuation-only
2025-10-18 10:31:38,465 - utils.linguistic_features - WARNING - 4,586 word instances (1.4%) not found in frequency list (197 unique valid words)
2025-10-18 10:31:38,466 - utils.linguistic_features - INFO - Sample of 197 missing valid words: ['1986. mordet', '2. (margrethe', 'abilifyer', 'adspredelsens', 'af kong', 'alauda', 'awakens (2015', 'blotgydje', 'broderet messehagler og', 'bygnings-konstruktioner', 'coconference', 'cølibatægteskabet', 'drengekammeraterne', 'en klase med', 'forbrugsopgjorte', 'fosforressourcer', 'fædrelandssalmen', 'første krigsminister, a.f', 'havstrategier', 'havtema', 'i græs-familien', 'ingrid, danmarks', 'jernalderkulturen', 'klimatilpasningspakke', 'kvantepartiklerne', 'lgbtqi-diskrimination', 'lgbtqi-familien', 'lgbtqi-personer', 'livsresultat', 'løvmand og', 'm.a.r.s', 'naturlovgivning', 'nivaagaard-tradition', 'nul-fejlkultur', 'næstlængste regeringstid af', 'phumiphon', 'regnvandsbidrag', 'sankthanstraditioner', 'skjortesyerske', 'skraldefester', 'spejder-juniorer', 'takstfinansiere', 'til landskabsmaleri', 'traume for', 'vaneslægt', 'var sveriges', 'vindmøllehoveder', 'vk-ånden', 'åbningsriffet', 'årstidshjulet']... (147 more)
2025-10-18 10:31:38,473 - utils.linguistic_features - INFO - Excluding 4,599 word instances (1.4%) with missing frequencies from analysis
2025-10-18 10:31:38,702 - utils.linguistic_features - INFO - Remaining dataset: 330,567 words
2025-10-18 10:31:38,702 - utils.linguistic_features - INFO - Final dataset: 330,567 words with valid frequencies
2025-10-18 10:31:43,323 - utils.linguistic_features - INFO - Loading causal language model: KennethTM/gpt2-medium-danish
2025-10-18 10:31:45,001 - utils.linguistic_features - INFO - Using CPU for surprisal computation
2025-10-18 10:31:45,002 - utils.linguistic_features - INFO - Causal language model loaded successfully
2025-10-18 10:31:45,002 - utils.linguistic_features - INFO - Computing surprisal with causal GPT-2 (left-to-right)...
2025-10-18 10:31:46,360 - utils.linguistic_features - INFO - Dataset statistics:
2025-10-18 10:31:46,360 - utils.linguistic_features - INFO -   Total participant-sentence instances: 20,707
2025-10-18 10:31:46,360 - utils.linguistic_features - INFO -   Unique sentence texts: 1,986
2025-10-18 10:31:46,361 - utils.linguistic_features - INFO -   Average participants per sentence: 10.4
2025-10-18 10:31:46,361 - utils.linguistic_features - INFO - Loading cached surprisal values from word_surprisal\surprisal_cache_gpt2.pkl
2025-10-18 10:31:46,374 - utils.linguistic_features - INFO - Loaded surprisal for 1,986 unique sentences
2025-10-18 10:31:46,375 - utils.linguistic_features - INFO - Broadcasting surprisal values to all participant instances...
2025-10-18 10:31:46,375 - utils.linguistic_features - INFO -   Mapping surprisal to words...
2025-10-18 10:31:49,519 - utils.linguistic_features - INFO -   Mapped 326,496 words
2025-10-18 10:31:49,521 - utils.linguistic_features - INFO - 
Surprisal Computation Results:
2025-10-18 10:31:49,521 - utils.linguistic_features - INFO -   Unique sentences processed: 1,986
2025-10-18 10:31:49,521 - utils.linguistic_features - INFO -   Total words with surprisal: 326,496 / 330,567
2025-10-18 10:31:49,522 - utils.linguistic_features - INFO -   Mean: 6.93 bits
2025-10-18 10:31:49,526 - utils.linguistic_features - INFO -   Median: 5.69 bits
2025-10-18 10:31:49,528 - utils.linguistic_features - INFO -   Std: 5.55 bits
2025-10-18 10:31:49,528 - utils.linguistic_features - INFO -   Range: [0.00, 59.34] bits
2025-10-18 10:31:49,542 - utils.linguistic_features - INFO - Linguistic features added successfully
2025-10-18 10:31:49,542 - utils.linguistic_features - INFO - 
Feature Summary:
2025-10-18 10:31:49,544 - utils.linguistic_features - INFO -   Word length: mean=4.67, std=3.08
2025-10-18 10:31:49,547 - utils.linguistic_features - INFO -   Zipf frequency: mean=5.85, std=1.38, range=[0.91, 7.51]
2025-10-18 10:31:49,549 - utils.linguistic_features - INFO -   Surprisal: mean=6.93, std=5.55
2025-10-18 10:31:49,572 - utils.hypothesis_testing_utils - INFO - Preparing data for hypothesis testing...
2025-10-18 10:31:49,615 - utils.hypothesis_testing_utils - INFO - Creating ERT variable...
2025-10-18 10:31:49,620 - utils.hypothesis_testing_utils - INFO -   ERT created: 123,666 skipped (0ms), 206,901 fixated
2025-10-18 10:31:49,620 - utils.hypothesis_testing_utils - INFO - Centering and scaling predictors...
2025-10-18 10:31:49,639 - utils.hypothesis_testing_utils - INFO -   word_length: mean=4.67, scale=3.08
2025-10-18 10:31:49,653 - utils.hypothesis_testing_utils - INFO -   word_frequency_zipf: mean=5.85, scale=1.38
2025-10-18 10:31:49,669 - utils.hypothesis_testing_utils - INFO -   surprisal: mean=6.93, scale=5.55
2025-10-18 10:31:49,669 - utils.hypothesis_testing_utils - INFO - Checking collinearity (VIF)...
2025-10-18 10:31:49,778 - utils.hypothesis_testing_utils - INFO - VIF Results:
2025-10-18 10:31:49,778 - utils.hypothesis_testing_utils - INFO -   Length: 2.82 (OK)
2025-10-18 10:31:49,778 - utils.hypothesis_testing_utils - INFO -   Frequency: 3.18 (OK)
2025-10-18 10:31:49,779 - utils.hypothesis_testing_utils - INFO -   Surprisal: 1.41 (OK)
2025-10-18 10:31:49,779 - utils.hypothesis_testing_utils - INFO - Creating residualized surprisal...
2025-10-18 10:31:49,795 - utils.hypothesis_testing_utils - INFO -   Correlation (Frequency-Surprisal): r=-0.539
2025-10-18 10:31:49,795 - utils.hypothesis_testing_utils - INFO -   Residualized surprisal created
2025-10-18 10:31:49,796 - utils.hypothesis_testing_utils - INFO - Defining pooled quartiles...
2025-10-18 10:31:49,809 - utils.hypothesis_testing_utils - INFO -   word_length: Q1=2.00, Q3=6.00
2025-10-18 10:31:49,822 - utils.hypothesis_testing_utils - INFO -   word_frequency_zipf: Q1=4.91, Q3=7.10
2025-10-18 10:31:49,836 - utils.hypothesis_testing_utils - INFO -   surprisal: Q1=2.76, Q3=9.97
2025-10-18 10:31:49,836 - utils.hypothesis_testing_utils - INFO - Data preparation complete: 330,567 words ready for analysis
2025-10-18 10:31:49,850 - utils.quartile_analysis - INFO - ============================================================
2025-10-18 10:31:49,850 - utils.quartile_analysis - INFO - PART A: QUARTILE ANALYSIS (Q1 vs Q3)
2025-10-18 10:31:49,850 - utils.quartile_analysis - INFO - ============================================================
2025-10-18 10:31:49,851 - utils.quartile_analysis - INFO - 
Analyzing word_length...
2025-10-18 10:31:50,695 - utils.quartile_analysis - INFO -   Computed means for 57 participants
2025-10-18 10:31:50,696 - utils.quartile_analysis - INFO -     Control Q3-Q1: 259.7ms
2025-10-18 10:31:50,696 - utils.quartile_analysis - INFO -     Dyslexic Q3-Q1: 442.6ms
2025-10-18 10:31:50,758 - utils.quartile_analysis - INFO -   Fitting mixed model on 152,465 words...
2025-10-18 10:31:51,511 - utils.quartile_analysis - INFO -   Group×Bin interaction: beta=134.79, p=0.0000
2025-10-18 10:31:51,541 - utils.quartile_analysis - INFO -   Computing bootstrap CIs (1000 iterations)...
2025-10-18 10:31:53,361 - utils.quartile_analysis - INFO -   Bootstrap 95% CI for interaction: [98.47, 259.71]
2025-10-18 10:31:53,362 - utils.quartile_analysis - INFO - 
Analyzing word_frequency_zipf...
2025-10-18 10:31:54,215 - utils.quartile_analysis - INFO -   Computed means for 57 participants
2025-10-18 10:31:54,216 - utils.quartile_analysis - INFO -     Control Q3-Q1: -225.9ms
2025-10-18 10:31:54,216 - utils.quartile_analysis - INFO -     Dyslexic Q3-Q1: -388.2ms
2025-10-18 10:31:54,279 - utils.quartile_analysis - INFO -   Fitting mixed model on 162,606 words...
2025-10-18 10:31:57,312 - utils.quartile_analysis - INFO -   Group×Bin interaction: beta=-122.40, p=0.0000
2025-10-18 10:31:57,348 - utils.quartile_analysis - INFO -   Computing bootstrap CIs (1000 iterations)...
2025-10-18 10:31:59,120 - utils.quartile_analysis - INFO -   Bootstrap 95% CI for interaction: [-225.59, -87.90]
2025-10-18 10:31:59,121 - utils.quartile_analysis - INFO - 
Analyzing surprisal...
2025-10-18 10:31:59,969 - utils.quartile_analysis - INFO -   Computed means for 57 participants
2025-10-18 10:31:59,971 - utils.quartile_analysis - INFO -     Control Q3-Q1: 135.8ms
2025-10-18 10:31:59,971 - utils.quartile_analysis - INFO -     Dyslexic Q3-Q1: 277.3ms
2025-10-18 10:32:00,045 - utils.quartile_analysis - INFO -   Fitting mixed model on 163,257 words...
2025-10-18 10:32:02,917 - utils.quartile_analysis - INFO -   Group×Bin interaction: beta=105.53, p=0.0000
2025-10-18 10:32:02,945 - utils.quartile_analysis - INFO -   Computing bootstrap CIs (1000 iterations)...
2025-10-18 10:32:04,713 - utils.quartile_analysis - INFO -   Bootstrap 95% CI for interaction: [84.99, 194.82]
2025-10-18 10:32:04,713 - utils.continuous_models - INFO - ============================================================
2025-10-18 10:32:04,714 - utils.continuous_models - INFO - PART B: CONTINUOUS MODELS (TWO-PART)
2025-10-18 10:32:04,714 - utils.continuous_models - INFO - ============================================================
2025-10-18 10:32:04,714 - utils.continuous_models - INFO - 
1. SKIPPING MODEL (Logistic with Clustered SEs)
2025-10-18 10:32:04,815 - utils.continuous_models - INFO -   Formula: skipped ~ dyslexic_int * (word_length_scaled + word_frequency_zipf_scaled + surprisal_scaled)
2025-10-18 10:32:04,815 - utils.continuous_models - INFO -   Fitting on 326,496 words...
2025-10-18 10:32:05,606 - utils.continuous_models - INFO -   Model fitted successfully with clustered SEs
2025-10-18 10:32:05,608 - utils.continuous_models - INFO -     dyslexic_int:word_length_scaled: beta=-0.0250, p=0.6714
2025-10-18 10:32:05,608 - utils.continuous_models - INFO -     dyslexic_int:word_frequency_zipf_scaled: beta=-0.0640, p=0.1975
2025-10-18 10:32:05,608 - utils.continuous_models - INFO -     dyslexic_int:surprisal_scaled: beta=-0.0272, p=0.2667
2025-10-18 10:32:05,616 - utils.continuous_models - INFO - 
2. DURATION MODEL (Log-TRT | Fixated)
2025-10-18 10:32:05,763 - utils.continuous_models - INFO -   Formula: log_TRT ~ dyslexic_int * (word_length_scaled + word_frequency_zipf_scaled + surprisal_scaled)
2025-10-18 10:32:05,763 - utils.continuous_models - INFO -   Fitting on 204,224 fixated words...
2025-10-18 10:32:06,853 - utils.continuous_models - INFO -   Model fitted successfully
2025-10-18 10:32:06,854 - utils.continuous_models - INFO -   Smearing correction factor: 1.1562
2025-10-18 10:32:06,855 - utils.continuous_models - INFO -     dyslexic_int:word_length_scaled: beta=0.0078, p=0.0585
2025-10-18 10:32:06,855 - utils.continuous_models - INFO -     dyslexic_int:word_frequency_zipf_scaled: beta=-0.0084, p=0.0678
2025-10-18 10:32:06,855 - utils.continuous_models - INFO -     dyslexic_int:surprisal_scaled: beta=0.0349, p=0.0000
2025-10-18 10:32:06,865 - utils.continuous_models - INFO - 
3. PREDICTING EXPECTED ERT
2025-10-18 10:32:06,940 - utils.continuous_models - INFO -   Predicting expected ERT...
2025-10-18 10:32:07,380 - utils.continuous_models - INFO -   Predicted expected ERT for 326,496 words
2025-10-18 10:32:07,382 - utils.continuous_models - INFO -     Mean expected ERT: 143.91ms
2025-10-18 10:32:07,383 - utils.continuous_models - INFO -     Mean observed ERT: 236.03ms
2025-10-18 10:32:07,977 - utils.continuous_models - INFO -     M0: R² = 0.2680
2025-10-18 10:32:08,342 - utils.continuous_models - INFO -     M1: R² = 0.9132
2025-10-18 10:32:08,728 - utils.continuous_models - INFO -     M2: R² = 0.9332
2025-10-18 10:32:09,090 - utils.continuous_models - INFO -     M3: R² = 0.9490
2025-10-18 10:32:09,144 - utils.continuous_models - INFO - 
  word_length: Q1=2.00, Q3=6.00
2025-10-18 10:32:09,260 - __main__ - ERROR - Pipeline failed: predict requires that you use a DataFrame when predicting from a model
that was created using the formula api.

The original error message returned by patsy is:
'DataFrame' object has no attribute 'dtype'
Traceback (most recent call last):
  File "C:\Users\hugos\miniconda3\envs\dyslexia-time-analysis\lib\site-packages\statsmodels\base\model.py", line 1102, in _transform_predict_exog
    exog = dmatrix(design_info, exog, return_type="dataframe")
  File "C:\Users\hugos\miniconda3\envs\dyslexia-time-analysis\lib\site-packages\patsy\highlevel.py", line 296, in dmatrix
    (lhs, rhs) = _do_highlevel_design(
  File "C:\Users\hugos\miniconda3\envs\dyslexia-time-analysis\lib\site-packages\patsy\highlevel.py", line 168, in _do_highlevel_design
    return build_design_matrices(
  File "C:\Users\hugos\miniconda3\envs\dyslexia-time-analysis\lib\site-packages\patsy\build.py", line 954, in build_design_matrices
    value, is_NA = _eval_factor(factor_info, data, NA_action)
  File "C:\Users\hugos\miniconda3\envs\dyslexia-time-analysis\lib\site-packages\patsy\build.py", line 83, in _eval_factor
    "I got non-numeric data of type '%s'" % (factor.name(), result.dtype),
  File "C:\Users\hugos\miniconda3\envs\dyslexia-time-analysis\lib\site-packages\pandas\core\generic.py", line 6321, in __getattr__
    return object.__getattribute__(self, name)
AttributeError: 'DataFrame' object has no attribute 'dtype'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\hugos\Desktop\Dyslexia_Time_Paper\Dyslexia_Time_Cost_Analysis\main.py", line 759, in main
    pipeline.run_hypothesis_testing_analysis()  # NEW
  File "C:\Users\hugos\Desktop\Dyslexia_Time_Paper\Dyslexia_Time_Cost_Analysis\main.py", line 425, in run_hypothesis_testing_analysis
    continuous_results = run_continuous_models(data)
  File "C:\Users\hugos\Desktop\Dyslexia_Time_Paper\Dyslexia_Time_Cost_Analysis\utils\continuous_models.py", line 58, in run_continuous_models
    ms_shifts = compute_ms_shifts(data_with_eert, skip_model, duration_model)
  File "C:\Users\hugos\Desktop\Dyslexia_Time_Paper\Dyslexia_Time_Cost_Analysis\utils\continuous_models.py", line 410, in compute_ms_shifts
    eert_q1 = predict_eert_single(
  File "C:\Users\hugos\Desktop\Dyslexia_Time_Paper\Dyslexia_Time_Cost_Analysis\utils\continuous_models.py", line 444, in predict_eert_single
    log_odds = skip_m.predict(data)
  File "C:\Users\hugos\miniconda3\envs\dyslexia-time-analysis\lib\site-packages\statsmodels\base\model.py", line 1171, in predict
    exog, exog_index = self._transform_predict_exog(exog,
  File "C:\Users\hugos\miniconda3\envs\dyslexia-time-analysis\lib\site-packages\statsmodels\base\model.py", line 1109, in _transform_predict_exog
    raise exc.__class__(msg)
AttributeError: predict requires that you use a DataFrame when predicting from a model
that was created using the formula api.

The original error message returned by patsy is:
'DataFrame' object has no attribute 'dtype'
2025-10-18 10:42:13,910 - __main__ - INFO - Dyslexia Time Analysis Pipeline initialized
2025-10-18 10:42:13,910 - __main__ - INFO - Dyslexia Time Analysis Pipeline initialized
2025-10-18 10:42:16,044 - __main__ - INFO - Running hypothesis testing analysis...
2025-10-18 10:42:16,045 - __main__ - INFO - ================================================================================
2025-10-18 10:42:16,045 - __main__ - INFO - HYPOTHESIS TESTING ANALYSIS
2025-10-18 10:42:16,045 - __main__ - INFO - ================================================================================
2025-10-18 10:42:16,045 - __main__ - INFO - Loading CopCo dataset...
2025-10-18 10:42:16,047 - utils.data_utils - INFO - Loading 57 participant files...
2025-10-18 10:42:17,978 - utils.data_utils - INFO - Starting with 335,203 total word entries
2025-10-18 10:42:18,192 - utils.data_utils - INFO - Word fixation patterns:
2025-10-18 10:42:18,192 - utils.data_utils - INFO -   - Skipped words (0 fixations): 126,302
2025-10-18 10:42:18,193 - utils.data_utils - INFO -   - Fixated words (1+ fixations): 208,901
2025-10-18 10:42:18,193 - utils.data_utils - INFO -   - Unknown fixations (NaN): 0
2025-10-18 10:42:18,227 - utils.data_utils - INFO - Fixated words reading times: median 272ms, 99th percentile 1777ms
2025-10-18 10:42:18,230 - utils.data_utils - INFO - Removed 14 fixated words with extreme reading times (0 too short, 14 too long)
2025-10-18 10:42:18,331 - utils.data_utils - INFO - Removed 23 words longer than 30 characters (likely data errors)
2025-10-18 10:42:18,372 - utils.data_utils - INFO - Final dataset: 126,302 skipped words, 208,864 fixated words
2025-10-18 10:42:18,372 - utils.data_utils - INFO - Data cleaning complete: 335,166 words retained (100.0% of original)
2025-10-18 10:42:18,384 - utils.data_utils - INFO - Groups identified: 19 dyslexic, 39 control
2025-10-18 10:42:18,457 - __main__ - INFO - Calculating skipping probabilities...
2025-10-18 10:42:18,460 - utils.skipping_utils - INFO - Skipping analysis from ExtractedFeatures:
2025-10-18 10:42:18,460 - utils.skipping_utils - INFO -   Total words: 335,166
2025-10-18 10:42:18,460 - utils.skipping_utils - INFO -   Skipped: 126,302 (37.7%)
2025-10-18 10:42:18,460 - utils.skipping_utils - INFO -   Fixated: 208,864 (62.3%)
2025-10-18 10:42:18,510 - __main__ - INFO - Skipping analysis: 37.7% overall rate
2025-10-18 10:42:18,529 - __main__ - INFO - Loaded: 335,166 words from 57 participants
2025-10-18 10:42:18,530 - __main__ - INFO - ============================================================
2025-10-18 10:42:18,530 - __main__ - INFO - COMPUTING LINGUISTIC FEATURES
2025-10-18 10:42:18,530 - __main__ - INFO - ============================================================
2025-10-18 10:42:18,530 - utils.linguistic_features - INFO - Loading Danish frequency list from danish_frequencies\danish_leipzig_for_analysis.txt
2025-10-18 10:42:20,037 - utils.linguistic_features - WARNING - Found 2 duplicate words after lowercasing. 
2025-10-18 10:42:20,526 - utils.linguistic_features - INFO - Loaded 1,499,999 word proportions from Leipzig Corpora
2025-10-18 10:42:20,638 - utils.linguistic_features - INFO - Computing word frequency...
2025-10-18 10:42:20,638 - utils.linguistic_features - INFO -   Stripping punctuation from words before frequency lookup
2025-10-18 10:42:21,354 - utils.linguistic_features - INFO - 13 missing word instances were punctuation-only
2025-10-18 10:42:21,354 - utils.linguistic_features - WARNING - 4,586 word instances (1.4%) not found in frequency list (197 unique valid words)
2025-10-18 10:42:21,355 - utils.linguistic_features - INFO - Sample of 197 missing valid words: ['1986. mordet', '2. (margrethe', 'abrams efter', 'adunyadet', 'af imperialismen', 'amokkacino', 'bjergstien', 'broderet messehagler og', 'chakri-dynasti', 'cÃ¸libatÃ¦gteskabet', 'dallis', 'ecodesign-direktivet', 'elevrÃ¥dsarrangementer', 'et nationalt', 'fattigdomsfÃ¦ngel', 'frejakult', 'fÃ¸dt 16', 'fÃ¸rste krigsminister, a.f', 'havtema', 'htx-fag', 'i star', 'idahot-forum', 'initiativlyst', 'jedi (2017', 'lgbtqi-diskrimination', 'lgbtqi-personer', 'live-action-udgaven', 'majestÃ¦t dronning', 'med prins', 'melatoninen', 'midsommerfÃ¦lleskabet', 'nul-fejlkultur', 'ph.d.-stilling', 'sankthansormen', 'sejdkunst', 'skraldefester', 'skywalker ogsÃ¥', 'slomo', 'som blomstermaler', 'spejder-juniorer', 'spÃ¡kona', 'stress-sygdomme', 'tankestrukturer', 'til landskabsmaleri', 'vandmiljÃ¸indsats', 'vandmiljÃ¸indsatsen', 'var sveriges', 'vk-fÃ¦llesskabet', 'wadup', 'Ã¥bningsriffet']... (147 more)
2025-10-18 10:42:21,362 - utils.linguistic_features - INFO - Excluding 4,599 word instances (1.4%) with missing frequencies from analysis
2025-10-18 10:42:21,564 - utils.linguistic_features - INFO - Remaining dataset: 330,567 words
2025-10-18 10:42:21,565 - utils.linguistic_features - INFO - Final dataset: 330,567 words with valid frequencies
2025-10-18 10:42:26,249 - utils.linguistic_features - INFO - Loading causal language model: KennethTM/gpt2-medium-danish
2025-10-18 10:42:28,055 - utils.linguistic_features - INFO - Using CPU for surprisal computation
2025-10-18 10:42:28,055 - utils.linguistic_features - INFO - Causal language model loaded successfully
2025-10-18 10:42:28,055 - utils.linguistic_features - INFO - Computing surprisal with causal GPT-2 (left-to-right)...
2025-10-18 10:42:29,402 - utils.linguistic_features - INFO - Dataset statistics:
2025-10-18 10:42:29,402 - utils.linguistic_features - INFO -   Total participant-sentence instances: 20,707
2025-10-18 10:42:29,403 - utils.linguistic_features - INFO -   Unique sentence texts: 1,986
2025-10-18 10:42:29,403 - utils.linguistic_features - INFO -   Average participants per sentence: 10.4
2025-10-18 10:42:29,403 - utils.linguistic_features - INFO - Loading cached surprisal values from word_surprisal\surprisal_cache_gpt2.pkl
2025-10-18 10:42:29,416 - utils.linguistic_features - INFO - Loaded surprisal for 1,986 unique sentences
2025-10-18 10:42:29,418 - utils.linguistic_features - INFO - Broadcasting surprisal values to all participant instances...
2025-10-18 10:42:29,418 - utils.linguistic_features - INFO -   Mapping surprisal to words...
2025-10-18 10:42:32,763 - utils.linguistic_features - INFO -   Mapped 326,496 words
2025-10-18 10:42:32,765 - utils.linguistic_features - INFO - 
Surprisal Computation Results:
2025-10-18 10:42:32,765 - utils.linguistic_features - INFO -   Unique sentences processed: 1,986
2025-10-18 10:42:32,765 - utils.linguistic_features - INFO -   Total words with surprisal: 326,496 / 330,567
2025-10-18 10:42:32,766 - utils.linguistic_features - INFO -   Mean: 6.93 bits
2025-10-18 10:42:32,771 - utils.linguistic_features - INFO -   Median: 5.69 bits
2025-10-18 10:42:32,774 - utils.linguistic_features - INFO -   Std: 5.55 bits
2025-10-18 10:42:32,775 - utils.linguistic_features - INFO -   Range: [0.00, 59.34] bits
2025-10-18 10:42:32,790 - utils.linguistic_features - INFO - Linguistic features added successfully
2025-10-18 10:42:32,792 - utils.linguistic_features - INFO - 
Feature Summary:
2025-10-18 10:42:32,795 - utils.linguistic_features - INFO -   Word length: mean=4.67, std=3.08
2025-10-18 10:42:32,798 - utils.linguistic_features - INFO -   Zipf frequency: mean=5.85, std=1.38, range=[0.91, 7.51]
2025-10-18 10:42:32,801 - utils.linguistic_features - INFO -   Surprisal: mean=6.93, std=5.55
2025-10-18 10:42:32,819 - utils.hypothesis_testing_utils - INFO - Preparing data for hypothesis testing...
2025-10-18 10:42:32,866 - utils.hypothesis_testing_utils - INFO - Creating ERT variable...
2025-10-18 10:42:32,870 - utils.hypothesis_testing_utils - INFO -   ERT created: 123,666 skipped (0ms), 206,901 fixated
2025-10-18 10:42:32,871 - utils.hypothesis_testing_utils - INFO - Centering and scaling predictors...
2025-10-18 10:42:32,897 - utils.hypothesis_testing_utils - INFO -   word_length: mean=4.67, scale=3.08
2025-10-18 10:42:32,915 - utils.hypothesis_testing_utils - INFO -   word_frequency_zipf: mean=5.85, scale=1.38
2025-10-18 10:42:32,932 - utils.hypothesis_testing_utils - INFO -   surprisal: mean=6.93, scale=5.55
2025-10-18 10:42:32,932 - utils.hypothesis_testing_utils - INFO - Checking collinearity (VIF)...
2025-10-18 10:42:33,142 - utils.hypothesis_testing_utils - INFO - VIF Results:
2025-10-18 10:42:33,142 - utils.hypothesis_testing_utils - INFO -   Length: 2.82 (OK)
2025-10-18 10:42:33,142 - utils.hypothesis_testing_utils - INFO -   Frequency: 3.18 (OK)
2025-10-18 10:42:33,143 - utils.hypothesis_testing_utils - INFO -   Surprisal: 1.41 (OK)
2025-10-18 10:42:33,143 - utils.hypothesis_testing_utils - INFO - Creating residualized surprisal...
2025-10-18 10:42:33,163 - utils.hypothesis_testing_utils - INFO -   Correlation (Frequency-Surprisal): r=-0.539
2025-10-18 10:42:33,164 - utils.hypothesis_testing_utils - INFO -   Residualized surprisal created
2025-10-18 10:42:33,164 - utils.hypothesis_testing_utils - INFO - Defining pooled quartiles...
2025-10-18 10:42:33,182 - utils.hypothesis_testing_utils - INFO -   word_length: Q1=2.00, Q3=6.00
2025-10-18 10:42:33,197 - utils.hypothesis_testing_utils - INFO -   word_frequency_zipf: Q1=4.91, Q3=7.10
2025-10-18 10:42:33,214 - utils.hypothesis_testing_utils - INFO -   surprisal: Q1=2.76, Q3=9.97
2025-10-18 10:42:33,214 - utils.hypothesis_testing_utils - INFO - Data preparation complete: 330,567 words ready for analysis
2025-10-18 10:42:33,233 - utils.quartile_analysis - INFO - ============================================================
2025-10-18 10:42:33,234 - utils.quartile_analysis - INFO - PART A: QUARTILE ANALYSIS (Q1 vs Q3)
2025-10-18 10:42:33,234 - utils.quartile_analysis - INFO - ============================================================
2025-10-18 10:42:33,234 - utils.quartile_analysis - INFO - 
Analyzing word_length...
2025-10-18 10:42:34,070 - utils.quartile_analysis - INFO -   Computed means for 57 participants
2025-10-18 10:42:34,071 - utils.quartile_analysis - INFO -     Control Q3-Q1: 259.7ms
2025-10-18 10:42:34,072 - utils.quartile_analysis - INFO -     Dyslexic Q3-Q1: 442.6ms
2025-10-18 10:42:34,130 - utils.quartile_analysis - INFO -   Fitting mixed model on 152,465 words...
2025-10-18 10:42:34,830 - utils.quartile_analysis - INFO -   GroupÃBin interaction: beta=134.79, p=0.0000
2025-10-18 10:42:34,856 - utils.quartile_analysis - INFO -   Computing bootstrap CIs (1000 iterations)...
2025-10-18 10:42:36,668 - utils.quartile_analysis - INFO -   Bootstrap 95% CI for interaction: [98.47, 259.71]
2025-10-18 10:42:36,669 - utils.quartile_analysis - INFO - 
Analyzing word_frequency_zipf...
2025-10-18 10:42:37,480 - utils.quartile_analysis - INFO -   Computed means for 57 participants
2025-10-18 10:42:37,481 - utils.quartile_analysis - INFO -     Control Q3-Q1: -225.9ms
2025-10-18 10:42:37,481 - utils.quartile_analysis - INFO -     Dyslexic Q3-Q1: -388.2ms
2025-10-18 10:42:37,546 - utils.quartile_analysis - INFO -   Fitting mixed model on 162,606 words...
2025-10-18 10:42:40,644 - utils.quartile_analysis - INFO -   GroupÃBin interaction: beta=-122.40, p=0.0000
2025-10-18 10:42:40,672 - utils.quartile_analysis - INFO -   Computing bootstrap CIs (1000 iterations)...
2025-10-18 10:42:42,413 - utils.quartile_analysis - INFO -   Bootstrap 95% CI for interaction: [-225.59, -87.90]
2025-10-18 10:42:42,414 - utils.quartile_analysis - INFO - 
Analyzing surprisal...
2025-10-18 10:42:43,238 - utils.quartile_analysis - INFO -   Computed means for 57 participants
2025-10-18 10:42:43,239 - utils.quartile_analysis - INFO -     Control Q3-Q1: 135.8ms
2025-10-18 10:42:43,239 - utils.quartile_analysis - INFO -     Dyslexic Q3-Q1: 277.3ms
2025-10-18 10:42:43,304 - utils.quartile_analysis - INFO -   Fitting mixed model on 163,257 words...
2025-10-18 10:42:46,081 - utils.quartile_analysis - INFO -   GroupÃBin interaction: beta=105.53, p=0.0000
2025-10-18 10:42:46,113 - utils.quartile_analysis - INFO -   Computing bootstrap CIs (1000 iterations)...
2025-10-18 10:42:47,866 - utils.quartile_analysis - INFO -   Bootstrap 95% CI for interaction: [84.99, 194.82]
2025-10-18 10:42:47,867 - utils.continuous_models - INFO - ============================================================
2025-10-18 10:42:47,867 - utils.continuous_models - INFO - PART B: CONTINUOUS MODELS (TWO-PART)
2025-10-18 10:42:47,867 - utils.continuous_models - INFO - ============================================================
2025-10-18 10:42:47,867 - utils.continuous_models - INFO - 
1. SKIPPING MODEL (Logistic with Clustered SEs)
2025-10-18 10:42:47,970 - utils.continuous_models - INFO -   Formula: skipped ~ dyslexic_int * (word_length_scaled + word_frequency_zipf_scaled + surprisal_scaled)
2025-10-18 10:42:47,971 - utils.continuous_models - INFO -   Fitting on 326,496 words...
2025-10-18 10:42:48,811 - utils.continuous_models - INFO -   Model fitted successfully with clustered SEs
2025-10-18 10:42:48,813 - utils.continuous_models - INFO -     dyslexic_int:word_length_scaled: beta=-0.0250, p=0.6714
2025-10-18 10:42:48,813 - utils.continuous_models - INFO -     dyslexic_int:word_frequency_zipf_scaled: beta=-0.0640, p=0.1975
2025-10-18 10:42:48,813 - utils.continuous_models - INFO -     dyslexic_int:surprisal_scaled: beta=-0.0272, p=0.2667
2025-10-18 10:42:48,824 - utils.continuous_models - INFO - 
2. DURATION MODEL (Log-TRT | Fixated)
2025-10-18 10:42:48,942 - utils.continuous_models - INFO -   Formula: log_TRT ~ dyslexic_int * (word_length_scaled + word_frequency_zipf_scaled + surprisal_scaled)
2025-10-18 10:42:48,942 - utils.continuous_models - INFO -   Fitting on 204,224 fixated words...
2025-10-18 10:42:50,072 - utils.continuous_models - INFO -   Model fitted successfully
2025-10-18 10:42:50,072 - utils.continuous_models - INFO -   Smearing correction factor: 1.1562
2025-10-18 10:42:50,073 - utils.continuous_models - INFO -     dyslexic_int:word_length_scaled: beta=0.0078, p=0.0585
2025-10-18 10:42:50,073 - utils.continuous_models - INFO -     dyslexic_int:word_frequency_zipf_scaled: beta=-0.0084, p=0.0678
2025-10-18 10:42:50,073 - utils.continuous_models - INFO -     dyslexic_int:surprisal_scaled: beta=0.0349, p=0.0000
2025-10-18 10:42:50,080 - utils.continuous_models - INFO - 
3. PREDICTING EXPECTED ERT
2025-10-18 10:42:50,150 - utils.continuous_models - INFO -   Predicting expected ERT...
2025-10-18 10:42:50,453 - utils.continuous_models - INFO -   Predicted expected ERT for 326,496 words
2025-10-18 10:42:50,455 - utils.continuous_models - INFO -     Mean expected ERT: 143.91ms
2025-10-18 10:42:50,457 - utils.continuous_models - INFO -     Mean observed ERT: 236.03ms
2025-10-18 10:42:50,471 - utils.continuous_models - INFO - 
4. VARIANCE EXPLAINED (ÎRÂ² on Expected ERT)
2025-10-18 10:42:50,613 - utils.continuous_models - INFO -   Computing ÎRÂ² on 326,496 observations
2025-10-18 10:42:50,959 - utils.continuous_models - INFO -     M0: RÂ² = 0.2680
2025-10-18 10:42:51,310 - utils.continuous_models - INFO -     M1: RÂ² = 0.9132
2025-10-18 10:42:51,670 - utils.continuous_models - INFO -     M2: RÂ² = 0.9332
2025-10-18 10:42:52,074 - utils.continuous_models - INFO -     M3: RÂ² = 0.9490
2025-10-18 10:42:52,075 - utils.continuous_models - INFO - 
  Variance Explained (ÎRÂ²):
2025-10-18 10:42:52,075 - utils.continuous_models - INFO -     Length: ÎRÂ² = 0.6452 (64.52%)
2025-10-18 10:42:52,075 - utils.continuous_models - INFO -     Frequency: ÎRÂ² = 0.0199 (1.99%)
2025-10-18 10:42:52,075 - utils.continuous_models - INFO -     Surprisal: ÎRÂ² = 0.0158 (1.58%)
2025-10-18 10:42:52,105 - utils.continuous_models - INFO - 
5. MS SHIFTS (Q1âQ3 on Expected ERT)
2025-10-18 10:42:52,112 - utils.continuous_models - INFO - 
  word_length: Q1=2.00, Q3=6.00
2025-10-18 10:42:52,133 - utils.continuous_models - INFO -     Control: 103.8ms -> 136.2ms (Î = 32.4ms)
2025-10-18 10:42:52,150 - utils.continuous_models - INFO -     Dyslexic: 157.6ms -> 205.6ms (Î = 48.0ms)
2025-10-18 10:42:52,158 - utils.continuous_models - INFO - 
  word_frequency_zipf: Q1=4.91, Q3=7.10
2025-10-18 10:42:52,182 - utils.continuous_models - INFO -     Control: 131.9ms -> 115.8ms (Î = -16.1ms)
2025-10-18 10:42:52,203 - utils.continuous_models - INFO -     Dyslexic: 199.1ms -> 176.3ms (Î = -22.8ms)
2025-10-18 10:42:52,212 - utils.continuous_models - INFO - 
  surprisal: Q1=2.76, Q3=9.97
2025-10-18 10:42:52,234 - utils.continuous_models - INFO -     Control: 121.6ms -> 127.3ms (Î = 5.7ms)
2025-10-18 10:42:52,253 - utils.continuous_models - INFO -     Dyslexic: 179.1ms -> 196.7ms (Î = 17.7ms)
2025-10-18 10:42:52,253 - utils.continuous_models - INFO - 
6. SLOPE RATIOS (Finite Differences on Expected ERT)
2025-10-18 10:42:52,298 - utils.continuous_models - INFO -   word_length: SR = 1.481 (AMPLIFIED)
2025-10-18 10:42:52,339 - utils.continuous_models - INFO -   word_frequency_zipf: SR = 1.413 (AMPLIFIED)
2025-10-18 10:42:52,384 - utils.continuous_models - INFO -   surprisal: SR = 3.102 (AMPLIFIED)
2025-10-18 10:42:52,384 - utils.continuous_models - INFO - 
7. BOOTSTRAP CONFIDENCE INTERVALS
2025-10-18 10:42:52,384 - utils.continuous_models - INFO -   Computing bootstrap CIs (100 iterations)...
2025-10-18 10:43:15,699 - utils.gap_decomposition - INFO - ============================================================
2025-10-18 10:43:15,699 - utils.gap_decomposition - INFO - PART C: GAP DECOMPOSITION
2025-10-18 10:43:15,700 - utils.gap_decomposition - INFO - ============================================================
2025-10-18 10:43:15,767 - utils.gap_decomposition - ERROR - ERT_expected not found - run continuous models first
2025-10-18 10:43:15,780 - utils.gap_decomposition - INFO - 
Computing counterfactual gaps...
2025-10-18 10:43:15,781 - utils.gap_decomposition - INFO - 
Computing RÂ²...
2025-10-18 10:43:15,781 - utils.gap_decomposition - WARNING - Baseline gap is 0 or NaN, cannot compute % explained
2025-10-18 10:43:15,781 - utils.gap_decomposition - INFO - 
Fitting interaction models (Oaxaca/Blinder decomposition)...
2025-10-18 10:43:15,848 - utils.gap_decomposition - WARNING -   M1_int fitting failed: ['ERT_expected']
2025-10-18 10:43:15,849 - utils.gap_decomposition - WARNING -   M2_int fitting failed: ['ERT_expected']
2025-10-18 10:43:15,849 - utils.gap_decomposition - WARNING -   M3_int fitting failed: ['ERT_expected']
2025-10-18 10:43:15,861 - utils.gap_decomposition - INFO - 
Oaxaca/Blinder Decomposition:
2025-10-18 10:43:15,861 - utils.gap_decomposition - WARNING -   Models not available for decomposition
2025-10-18 10:43:15,862 - utils.gap_decomposition - INFO - 
GAP DECOMPOSITION SUMMARY:
2025-10-18 10:43:15,862 - __main__ - ERROR - Pipeline failed: 'M0'
Traceback (most recent call last):
  File "C:\Users\hugos\Desktop\Dyslexia_Time_Paper\Dyslexia_Time_Cost_Analysis\main.py", line 759, in main
    pipeline.run_hypothesis_testing_analysis()  # NEW
  File "C:\Users\hugos\Desktop\Dyslexia_Time_Paper\Dyslexia_Time_Cost_Analysis\main.py", line 428, in run_hypothesis_testing_analysis
    gap_results = run_gap_decomposition(data)
  File "C:\Users\hugos\Desktop\Dyslexia_Time_Paper\Dyslexia_Time_Cost_Analysis\utils\gap_decomposition.py", line 67, in run_gap_decomposition
    logger.info(f"  Baseline gap (M0): {gaps['M0']:.2f}ms")
KeyError: 'M0'
2025-10-18 10:54:30,863 - __main__ - INFO - Dyslexia Time Analysis Pipeline initialized
2025-10-18 10:54:30,863 - __main__ - INFO - Dyslexia Time Analysis Pipeline initialized
2025-10-18 10:54:36,557 - __main__ - INFO - Running hypothesis testing analysis...
2025-10-18 10:54:36,558 - __main__ - INFO - ================================================================================
2025-10-18 10:54:36,558 - __main__ - INFO - HYPOTHESIS TESTING ANALYSIS
2025-10-18 10:54:36,558 - __main__ - INFO - ================================================================================
2025-10-18 10:54:36,558 - __main__ - INFO - Loading CopCo dataset...
2025-10-18 10:54:36,559 - utils.data_utils - INFO - Loading 57 participant files...
2025-10-18 10:54:38,181 - utils.data_utils - INFO - Starting with 335,203 total word entries
2025-10-18 10:54:38,396 - utils.data_utils - INFO - Word fixation patterns:
2025-10-18 10:54:38,396 - utils.data_utils - INFO -   - Skipped words (0 fixations): 126,302
2025-10-18 10:54:38,397 - utils.data_utils - INFO -   - Fixated words (1+ fixations): 208,901
2025-10-18 10:54:38,397 - utils.data_utils - INFO -   - Unknown fixations (NaN): 0
2025-10-18 10:54:38,434 - utils.data_utils - INFO - Fixated words reading times: median 272ms, 99th percentile 1777ms
2025-10-18 10:54:38,437 - utils.data_utils - INFO - Removed 14 fixated words with extreme reading times (0 too short, 14 too long)
2025-10-18 10:54:38,544 - utils.data_utils - INFO - Removed 23 words longer than 30 characters (likely data errors)
2025-10-18 10:54:38,588 - utils.data_utils - INFO - Final dataset: 126,302 skipped words, 208,864 fixated words
2025-10-18 10:54:38,589 - utils.data_utils - INFO - Data cleaning complete: 335,166 words retained (100.0% of original)
2025-10-18 10:54:38,600 - utils.data_utils - INFO - Groups identified: 19 dyslexic, 39 control
2025-10-18 10:54:38,674 - __main__ - INFO - Calculating skipping probabilities...
2025-10-18 10:54:38,676 - utils.skipping_utils - INFO - Skipping analysis from ExtractedFeatures:
2025-10-18 10:54:38,677 - utils.skipping_utils - INFO -   Total words: 335,166
2025-10-18 10:54:38,677 - utils.skipping_utils - INFO -   Skipped: 126,302 (37.7%)
2025-10-18 10:54:38,677 - utils.skipping_utils - INFO -   Fixated: 208,864 (62.3%)
2025-10-18 10:54:38,727 - __main__ - INFO - Skipping analysis: 37.7% overall rate
2025-10-18 10:54:38,746 - __main__ - INFO - Loaded: 335,166 words from 57 participants
2025-10-18 10:54:38,748 - __main__ - INFO - ============================================================
2025-10-18 10:54:38,748 - __main__ - INFO - COMPUTING LINGUISTIC FEATURES
2025-10-18 10:54:38,748 - __main__ - INFO - ============================================================
2025-10-18 10:54:38,748 - utils.linguistic_features - INFO - Loading Danish frequency list from danish_frequencies\danish_leipzig_for_analysis.txt
2025-10-18 10:54:40,194 - utils.linguistic_features - WARNING - Found 2 duplicate words after lowercasing. 
2025-10-18 10:54:40,659 - utils.linguistic_features - INFO - Loaded 1,499,999 word proportions from Leipzig Corpora
2025-10-18 10:54:40,748 - utils.linguistic_features - INFO - Computing word frequency...
2025-10-18 10:54:40,748 - utils.linguistic_features - INFO -   Stripping punctuation from words before frequency lookup
2025-10-18 10:54:41,440 - utils.linguistic_features - INFO - 13 missing word instances were punctuation-only
2025-10-18 10:54:41,440 - utils.linguistic_features - WARNING - 4,586 word instances (1.4%) not found in frequency list (197 unique valid words)
2025-10-18 10:54:41,440 - utils.linguistic_features - INFO - Sample of 197 missing valid words: ['1986. mordet', '2000-direktiverne', '3.g-underholdning', 'april 1940 pÃ¥ amalienborg', 'blotgydje', 'broderet messehagler og', 'demonstrationsland', 'drengekammeraterne', 'ecodesign-direktivet', 'emancipationskravet', 'fattigdomsfÃ¦ngel', 'fosforressourcer', 'fÃ¸dt 16', 'fÃ¸rste krigsminister, a.f', 'geografilÃ¦rers', 'havstrategier', 'heksetrold', 'idahot-forum', 'intersex-inkluderende', 'isotropic', 'issefjerene', 'klimatilpasningslov', 'kvantepartiklerne', 'lgbtqi-diskrimination', 'lgbtqi-familien', 'ligusteragtig', 'lÃ¦rerindejob', 'm.a.r.s', 'midsommeraftner', 'miljÃ¸sejr', 'nivaagaard-tradition', 'palme har', 'ph.d.-stilling', 'renÃ¦ssancekongen', 'selvetablerede', 'skraldefester', 'skraldepigerne', 'spÃ¡kona', 'subapikalt', 'svenske velfÃ¦rdsstat og', 'sÃ¸nnerne kronprins', 'til landskabsmaleri', 'traume for', 'tusindÃ¥rsfornemmelser', 'vandmiljÃ¸indsats', 'vindmÃ¸lle-testanlÃ¦gget', 'vk-fÃ¦llesskabet', 'Ã¥bningsriffet', 'Ã¥rshjulets', 'Ã¦ttesamfund']... (147 more)
2025-10-18 10:54:41,446 - utils.linguistic_features - INFO - Excluding 4,599 word instances (1.4%) with missing frequencies from analysis
2025-10-18 10:54:41,571 - utils.linguistic_features - INFO - Remaining dataset: 330,567 words
2025-10-18 10:54:41,572 - utils.linguistic_features - INFO - Final dataset: 330,567 words with valid frequencies
2025-10-18 10:54:45,916 - utils.linguistic_features - INFO - Loading causal language model: KennethTM/gpt2-medium-danish
2025-10-18 10:54:47,519 - utils.linguistic_features - INFO - Using CPU for surprisal computation
2025-10-18 10:54:47,520 - utils.linguistic_features - INFO - Causal language model loaded successfully
2025-10-18 10:54:47,520 - utils.linguistic_features - INFO - Computing surprisal with causal GPT-2 (left-to-right)...
2025-10-18 10:54:48,937 - utils.linguistic_features - INFO - Dataset statistics:
2025-10-18 10:54:48,937 - utils.linguistic_features - INFO -   Total participant-sentence instances: 20,707
2025-10-18 10:54:48,937 - utils.linguistic_features - INFO -   Unique sentence texts: 1,986
2025-10-18 10:54:48,937 - utils.linguistic_features - INFO -   Average participants per sentence: 10.4
2025-10-18 10:54:48,938 - utils.linguistic_features - INFO - Loading cached surprisal values from word_surprisal\surprisal_cache_gpt2.pkl
2025-10-18 10:54:48,956 - utils.linguistic_features - INFO - Loaded surprisal for 1,986 unique sentences
2025-10-18 10:54:48,957 - utils.linguistic_features - INFO - Broadcasting surprisal values to all participant instances...
2025-10-18 10:54:48,957 - utils.linguistic_features - INFO -   Mapping surprisal to words...
2025-10-18 10:54:52,313 - utils.linguistic_features - INFO -   Mapped 326,496 words
2025-10-18 10:54:52,314 - utils.linguistic_features - INFO - 
Surprisal Computation Results:
2025-10-18 10:54:52,315 - utils.linguistic_features - INFO -   Unique sentences processed: 1,986
2025-10-18 10:54:52,315 - utils.linguistic_features - INFO -   Total words with surprisal: 326,496 / 330,567
2025-10-18 10:54:52,315 - utils.linguistic_features - INFO -   Mean: 6.93 bits
2025-10-18 10:54:52,320 - utils.linguistic_features - INFO -   Median: 5.69 bits
2025-10-18 10:54:52,322 - utils.linguistic_features - INFO -   Std: 5.55 bits
2025-10-18 10:54:52,322 - utils.linguistic_features - INFO -   Range: [0.00, 59.34] bits
2025-10-18 10:54:52,340 - utils.linguistic_features - INFO - Linguistic features added successfully
2025-10-18 10:54:52,340 - utils.linguistic_features - INFO - 
Feature Summary:
2025-10-18 10:54:52,343 - utils.linguistic_features - INFO -   Word length: mean=4.67, std=3.08
2025-10-18 10:54:52,346 - utils.linguistic_features - INFO -   Zipf frequency: mean=5.85, std=1.38, range=[0.91, 7.51]
2025-10-18 10:54:52,349 - utils.linguistic_features - INFO -   Surprisal: mean=6.93, std=5.55
2025-10-18 10:54:52,363 - utils.hypothesis_testing_utils - INFO - Preparing data for hypothesis testing...
2025-10-18 10:54:52,403 - utils.hypothesis_testing_utils - INFO - Creating ERT variable...
2025-10-18 10:54:52,406 - utils.hypothesis_testing_utils - INFO -   ERT created: 123,666 skipped (0ms), 206,901 fixated
2025-10-18 10:54:52,407 - utils.hypothesis_testing_utils - INFO - Centering and scaling predictors...
2025-10-18 10:54:52,422 - utils.hypothesis_testing_utils - INFO -   word_length: mean=4.67, scale=3.08
2025-10-18 10:54:52,437 - utils.hypothesis_testing_utils - INFO -   word_frequency_zipf: mean=5.85, scale=1.38
2025-10-18 10:54:52,453 - utils.hypothesis_testing_utils - INFO -   surprisal: mean=6.93, scale=5.55
2025-10-18 10:54:52,453 - utils.hypothesis_testing_utils - INFO - Checking collinearity (VIF)...
2025-10-18 10:54:52,602 - utils.hypothesis_testing_utils - INFO - VIF Results:
2025-10-18 10:54:52,602 - utils.hypothesis_testing_utils - INFO -   Length: 2.82 (OK)
2025-10-18 10:54:52,603 - utils.hypothesis_testing_utils - INFO -   Frequency: 3.18 (OK)
2025-10-18 10:54:52,603 - utils.hypothesis_testing_utils - INFO -   Surprisal: 1.41 (OK)
2025-10-18 10:54:52,603 - utils.hypothesis_testing_utils - INFO - Creating residualized surprisal...
2025-10-18 10:54:52,624 - utils.hypothesis_testing_utils - INFO -   Correlation (Frequency-Surprisal): r=-0.539
2025-10-18 10:54:52,625 - utils.hypothesis_testing_utils - INFO -   Residualized surprisal created
2025-10-18 10:54:52,625 - utils.hypothesis_testing_utils - INFO - Defining pooled quartiles...
2025-10-18 10:54:52,640 - utils.hypothesis_testing_utils - INFO -   word_length: Q1=2.00, Q3=6.00
2025-10-18 10:54:52,653 - utils.hypothesis_testing_utils - INFO -   word_frequency_zipf: Q1=4.91, Q3=7.10
2025-10-18 10:54:52,666 - utils.hypothesis_testing_utils - INFO -   surprisal: Q1=2.76, Q3=9.97
2025-10-18 10:54:52,667 - utils.hypothesis_testing_utils - INFO - Data preparation complete: 330,567 words ready for analysis
2025-10-18 10:54:52,682 - utils.quartile_analysis - INFO - ============================================================
2025-10-18 10:54:52,682 - utils.quartile_analysis - INFO - PART A: QUARTILE ANALYSIS (Q1 vs Q3)
2025-10-18 10:54:52,682 - utils.quartile_analysis - INFO - ============================================================
2025-10-18 10:54:52,683 - utils.quartile_analysis - INFO - 
Analyzing word_length...
2025-10-18 10:54:53,500 - utils.quartile_analysis - INFO -   Computed means for 57 participants
2025-10-18 10:54:53,500 - utils.quartile_analysis - INFO -     Control Q3-Q1: 259.7ms
2025-10-18 10:54:53,501 - utils.quartile_analysis - INFO -     Dyslexic Q3-Q1: 442.6ms
2025-10-18 10:54:53,559 - utils.quartile_analysis - INFO -   Fitting mixed model on 152,465 words...
2025-10-18 10:54:54,209 - utils.quartile_analysis - INFO -   GroupÃBin interaction: beta=134.79, p=0.0000
2025-10-18 10:54:54,245 - utils.quartile_analysis - INFO -   Computing bootstrap CIs (1000 iterations)...
2025-10-18 10:54:56,004 - utils.quartile_analysis - INFO -   Bootstrap 95% CI for interaction: [98.47, 259.71]
2025-10-18 10:54:56,005 - utils.quartile_analysis - INFO - 
Analyzing word_frequency_zipf...
2025-10-18 10:54:56,808 - utils.quartile_analysis - INFO -   Computed means for 57 participants
2025-10-18 10:54:56,809 - utils.quartile_analysis - INFO -     Control Q3-Q1: -225.9ms
2025-10-18 10:54:56,809 - utils.quartile_analysis - INFO -     Dyslexic Q3-Q1: -388.2ms
2025-10-18 10:54:56,873 - utils.quartile_analysis - INFO -   Fitting mixed model on 162,606 words...
2025-10-18 10:54:59,851 - utils.quartile_analysis - INFO -   GroupÃBin interaction: beta=-122.40, p=0.0000
2025-10-18 10:54:59,881 - utils.quartile_analysis - INFO -   Computing bootstrap CIs (1000 iterations)...
2025-10-18 10:55:01,684 - utils.quartile_analysis - INFO -   Bootstrap 95% CI for interaction: [-225.59, -87.90]
2025-10-18 10:55:01,684 - utils.quartile_analysis - INFO - 
Analyzing surprisal...
2025-10-18 10:55:02,511 - utils.quartile_analysis - INFO -   Computed means for 57 participants
2025-10-18 10:55:02,511 - utils.quartile_analysis - INFO -     Control Q3-Q1: 135.8ms
2025-10-18 10:55:02,512 - utils.quartile_analysis - INFO -     Dyslexic Q3-Q1: 277.3ms
2025-10-18 10:55:02,576 - utils.quartile_analysis - INFO -   Fitting mixed model on 163,257 words...
2025-10-18 10:55:05,357 - utils.quartile_analysis - INFO -   GroupÃBin interaction: beta=105.53, p=0.0000
2025-10-18 10:55:05,386 - utils.quartile_analysis - INFO -   Computing bootstrap CIs (1000 iterations)...
2025-10-18 10:55:07,148 - utils.quartile_analysis - INFO -   Bootstrap 95% CI for interaction: [84.99, 194.82]
2025-10-18 10:55:07,149 - utils.continuous_models - INFO - ============================================================
2025-10-18 10:55:07,149 - utils.continuous_models - INFO - PART B: CONTINUOUS MODELS (TWO-PART)
2025-10-18 10:55:07,149 - utils.continuous_models - INFO - ============================================================
2025-10-18 10:55:07,149 - utils.continuous_models - INFO - 
1. SKIPPING MODEL (Logistic with Clustered SEs)
2025-10-18 10:55:07,268 - utils.continuous_models - INFO -   Formula: skipped ~ dyslexic_int * (word_length_scaled + word_frequency_zipf_scaled + surprisal_scaled)
2025-10-18 10:55:07,268 - utils.continuous_models - INFO -   Fitting on 326,496 words...
2025-10-18 10:55:08,099 - utils.continuous_models - INFO -   Model fitted successfully with clustered SEs
2025-10-18 10:55:08,100 - utils.continuous_models - INFO -     dyslexic_int:word_length_scaled: beta=-0.0250, p=0.6714
2025-10-18 10:55:08,101 - utils.continuous_models - INFO -     dyslexic_int:word_frequency_zipf_scaled: beta=-0.0640, p=0.1975
2025-10-18 10:55:08,101 - utils.continuous_models - INFO -     dyslexic_int:surprisal_scaled: beta=-0.0272, p=0.2667
2025-10-18 10:55:08,110 - utils.continuous_models - INFO - 
2. DURATION MODEL (Log-TRT | Fixated)
2025-10-18 10:55:08,222 - utils.continuous_models - INFO -   Formula: log_TRT ~ dyslexic_int * (word_length_scaled + word_frequency_zipf_scaled + surprisal_scaled)
2025-10-18 10:55:08,222 - utils.continuous_models - INFO -   Fitting on 204,224 fixated words...
2025-10-18 10:55:09,386 - utils.continuous_models - INFO -   Model fitted successfully
2025-10-18 10:55:09,386 - utils.continuous_models - INFO -   Smearing correction factor: 1.1562
2025-10-18 10:55:09,387 - utils.continuous_models - INFO -     dyslexic_int:word_length_scaled: beta=0.0078, p=0.0585
2025-10-18 10:55:09,387 - utils.continuous_models - INFO -     dyslexic_int:word_frequency_zipf_scaled: beta=-0.0084, p=0.0678
2025-10-18 10:55:09,388 - utils.continuous_models - INFO -     dyslexic_int:surprisal_scaled: beta=0.0349, p=0.0000
2025-10-18 10:55:09,395 - utils.continuous_models - INFO - 
3. PREDICTING EXPECTED ERT
2025-10-18 10:55:09,443 - utils.continuous_models - INFO -   Predicting expected ERT...
2025-10-18 10:55:09,674 - utils.continuous_models - INFO -   Predicted expected ERT for 326,496 words
2025-10-18 10:55:09,677 - utils.continuous_models - INFO -     Mean expected ERT: 143.91ms
2025-10-18 10:55:09,677 - utils.continuous_models - INFO -     Mean observed ERT: 236.03ms
2025-10-18 10:55:09,686 - utils.continuous_models - INFO - 
4. VARIANCE EXPLAINED (ÎRÂ² on Expected ERT)
2025-10-18 10:55:09,786 - utils.continuous_models - INFO -   Computing ÎRÂ² on 326,496 observations
2025-10-18 10:55:10,153 - utils.continuous_models - INFO -     M0: RÂ² = 0.2680
2025-10-18 10:55:10,532 - utils.continuous_models - INFO -     M1: RÂ² = 0.9132
2025-10-18 10:55:10,898 - utils.continuous_models - INFO -     M2: RÂ² = 0.9332
2025-10-18 10:55:11,267 - utils.continuous_models - INFO -     M3: RÂ² = 0.9490
2025-10-18 10:55:11,267 - utils.continuous_models - INFO - 
  Variance Explained (ÎRÂ²):
2025-10-18 10:55:11,267 - utils.continuous_models - INFO -     Length: ÎRÂ² = 0.6452 (64.52%)
2025-10-18 10:55:11,267 - utils.continuous_models - INFO -     Frequency: ÎRÂ² = 0.0199 (1.99%)
2025-10-18 10:55:11,267 - utils.continuous_models - INFO -     Surprisal: ÎRÂ² = 0.0158 (1.58%)
2025-10-18 10:55:11,293 - utils.continuous_models - INFO - 
5. MS SHIFTS (Q1âQ3 on Expected ERT)
2025-10-18 10:55:11,300 - utils.continuous_models - INFO - 
  word_length: Q1=2.00, Q3=6.00
2025-10-18 10:55:11,322 - utils.continuous_models - INFO -     Control: 103.8ms -> 136.2ms (Î = 32.4ms)
2025-10-18 10:55:11,341 - utils.continuous_models - INFO -     Dyslexic: 157.6ms -> 205.6ms (Î = 48.0ms)
2025-10-18 10:55:11,351 - utils.continuous_models - INFO - 
  word_frequency_zipf: Q1=4.91, Q3=7.10
2025-10-18 10:55:11,372 - utils.continuous_models - INFO -     Control: 131.9ms -> 115.8ms (Î = -16.1ms)
2025-10-18 10:55:11,393 - utils.continuous_models - INFO -     Dyslexic: 199.1ms -> 176.3ms (Î = -22.8ms)
2025-10-18 10:55:11,403 - utils.continuous_models - INFO - 
  surprisal: Q1=2.76, Q3=9.97
2025-10-18 10:55:11,431 - utils.continuous_models - INFO -     Control: 121.6ms -> 127.3ms (Î = 5.7ms)
2025-10-18 10:55:11,452 - utils.continuous_models - INFO -     Dyslexic: 179.1ms -> 196.7ms (Î = 17.7ms)
2025-10-18 10:55:11,452 - utils.continuous_models - INFO - 
6. SLOPE RATIOS (Finite Differences on Expected ERT)
2025-10-18 10:55:11,494 - utils.continuous_models - INFO -   word_length: SR = 1.481 (AMPLIFIED)
2025-10-18 10:55:11,556 - utils.continuous_models - INFO -   word_frequency_zipf: SR = 1.413 (AMPLIFIED)
2025-10-18 10:55:11,598 - utils.continuous_models - INFO -   surprisal: SR = 3.102 (AMPLIFIED)
2025-10-18 10:55:11,599 - utils.continuous_models - INFO - 
7. BOOTSTRAP CONFIDENCE INTERVALS
2025-10-18 10:55:11,599 - utils.continuous_models - INFO -   Computing bootstrap CIs (100 iterations)...
2025-10-18 10:55:35,405 - utils.gap_decomposition - INFO - ============================================================
2025-10-18 10:55:35,405 - utils.gap_decomposition - INFO - PART C: GAP DECOMPOSITION
2025-10-18 10:55:35,405 - utils.gap_decomposition - INFO - ============================================================
2025-10-18 10:55:35,453 - utils.gap_decomposition - ERROR - ERT_expected not found - run continuous models first
2025-10-18 10:55:35,461 - utils.gap_decomposition - INFO - 
Computing counterfactual gaps...
2025-10-18 10:55:35,461 - utils.gap_decomposition - INFO - 
Computing RÂ²...
2025-10-18 10:55:35,462 - utils.gap_decomposition - WARNING - Baseline gap is 0 or NaN, cannot compute % explained
2025-10-18 10:55:35,462 - utils.gap_decomposition - INFO - 
Fitting interaction models (Oaxaca/Blinder decomposition)...
2025-10-18 10:55:35,506 - utils.gap_decomposition - WARNING -   M1_int fitting failed: ['ERT_expected']
2025-10-18 10:55:35,506 - utils.gap_decomposition - WARNING -   M2_int fitting failed: ['ERT_expected']
2025-10-18 10:55:35,506 - utils.gap_decomposition - WARNING -   M3_int fitting failed: ['ERT_expected']
2025-10-18 10:55:35,516 - utils.gap_decomposition - INFO - 
Oaxaca/Blinder Decomposition:
2025-10-18 10:55:35,517 - utils.gap_decomposition - WARNING -   Main model M3 not available for decomposition
2025-10-18 10:55:35,517 - utils.gap_decomposition - INFO - 
GAP DECOMPOSITION SUMMARY:
2025-10-18 10:55:35,517 - utils.gap_decomposition - WARNING -   Gap computation failed - no baseline gap available
2025-10-18 10:55:35,517 - utils.sensitivity_analysis - INFO - ============================================================
2025-10-18 10:55:35,517 - utils.sensitivity_analysis - INFO - SENSITIVITY ANALYSES
2025-10-18 10:55:35,518 - utils.sensitivity_analysis - INFO - ============================================================
2025-10-18 10:55:35,518 - utils.sensitivity_analysis - INFO - 
1. RESIDUALIZED SURPRISAL MODEL
2025-10-18 10:55:35,559 - utils.sensitivity_analysis - INFO -   Formula: ERT ~ dyslexic_int * (word_length_scaled + word_frequency_zipf_scaled + surprisal_resid)
2025-10-18 10:55:36,033 - utils.sensitivity_analysis - INFO -   Residualized surprisal: beta=11.6330, p=0.0000
2025-10-18 10:55:36,033 - utils.sensitivity_analysis - INFO -   [OK] Surprisal effect robust to frequency collinearity
2025-10-18 10:55:36,042 - utils.sensitivity_analysis - INFO - 
2. SUBJECT-WISE CROSS-VALIDATION
2025-10-18 10:55:36,043 - utils.sensitivity_analysis - INFO -   Running 10-fold subject-wise CV...
2025-10-18 10:55:36,272 - utils.sensitivity_analysis - INFO -     Fold 1/10
2025-10-18 10:55:36,894 - utils.sensitivity_analysis - INFO -     Fold 2/10
2025-10-18 10:55:37,538 - utils.sensitivity_analysis - INFO -     Fold 3/10
2025-10-18 10:55:38,177 - utils.sensitivity_analysis - INFO -     Fold 4/10
2025-10-18 10:55:38,855 - utils.sensitivity_analysis - INFO -     Fold 5/10
2025-10-18 10:55:39,525 - utils.sensitivity_analysis - INFO -     Fold 6/10
2025-10-18 10:55:40,765 - utils.sensitivity_analysis - INFO -     Fold 7/10
2025-10-18 10:55:41,439 - utils.sensitivity_analysis - INFO -     Fold 8/10
2025-10-18 10:55:42,117 - utils.sensitivity_analysis - INFO -     Fold 9/10
2025-10-18 10:55:42,813 - utils.sensitivity_analysis - INFO -     Fold 10/10
2025-10-18 10:55:43,491 - utils.sensitivity_analysis - INFO -   Cross-validation RÂ²: -0.3352 Â± 0.2999
2025-10-18 10:55:43,491 - utils.sensitivity_analysis - INFO -   Based on 10 successful folds
2025-10-18 10:55:43,544 - utils.sensitivity_analysis - INFO - 
3. ALTERNATIVE BINNING (Terciles & Quintiles)
2025-10-18 10:55:43,545 - utils.sensitivity_analysis - INFO - 
  Testing terciles...
2025-10-18 10:55:43,671 - utils.sensitivity_analysis - INFO -     word_length: Control Î=202.4ms, Dyslexic Î=304.4ms
2025-10-18 10:55:43,771 - utils.sensitivity_analysis - INFO -     word_frequency_zipf: Control Î=-187.4ms, Dyslexic Î=-283.4ms
2025-10-18 10:55:43,883 - utils.sensitivity_analysis - INFO -     surprisal: Control Î=112.9ms, Dyslexic Î=200.7ms
2025-10-18 10:55:43,883 - utils.sensitivity_analysis - INFO - 
  Testing quintiles...
2025-10-18 10:55:43,963 - utils.sensitivity_analysis - INFO -     word_length: Control Î=284.7ms, Dyslexic Î=452.5ms
2025-10-18 10:55:44,041 - utils.sensitivity_analysis - INFO -     word_frequency_zipf: Control Î=-242.1ms, Dyslexic Î=-393.1ms
2025-10-18 10:55:44,130 - utils.sensitivity_analysis - INFO -     surprisal: Control Î=150.5ms, Dyslexic Î=270.2ms
2025-10-18 10:55:44,136 - utils.hypothesis_visualization - INFO - ============================================================
2025-10-18 10:55:44,136 - utils.hypothesis_visualization - INFO - CREATING VISUALIZATIONS
2025-10-18 10:55:44,136 - utils.hypothesis_visualization - INFO - ============================================================
2025-10-18 10:55:44,137 - utils.hypothesis_visualization - INFO - 
1. Continuous effect curves...
2025-10-18 10:55:45,436 - utils.hypothesis_visualization - INFO -   Saved to results\continuous_effects_with_quartiles.png
2025-10-18 10:55:45,437 - utils.hypothesis_visualization - INFO - 2. Gap decomposition...
2025-10-18 10:55:45,437 - utils.hypothesis_visualization - WARNING - No gap results available
2025-10-18 10:55:45,438 - utils.hypothesis_visualization - INFO - 3. Slope ratios...
2025-10-18 10:55:45,728 - utils.hypothesis_visualization - INFO -   Saved to results\slope_ratios.png
2025-10-18 10:55:45,729 - utils.hypothesis_visualization - INFO - 4. Model comparison...
2025-10-18 10:55:45,729 - utils.hypothesis_visualization - WARNING - No RÂ² results available
2025-10-18 10:55:45,729 - utils.hypothesis_visualization - INFO - 5. Quartile effects...
2025-10-18 10:55:46,342 - utils.hypothesis_visualization - INFO -   Saved to results\quartile_effects.png
2025-10-18 10:55:46,343 - utils.hypothesis_visualization - INFO - 6. Predicted vs observed...
2025-10-18 10:55:46,343 - utils.hypothesis_visualization - WARNING - No predictions available
2025-10-18 10:55:46,343 - utils.hypothesis_visualization - INFO - 
All visualizations saved to results
2025-10-18 10:55:46,343 - utils.results_reporting - INFO - ============================================================
2025-10-18 10:55:46,344 - utils.results_reporting - INFO - GENERATING RESULTS REPORT
2025-10-18 10:55:46,344 - utils.results_reporting - INFO - ============================================================
2025-10-18 10:55:46,347 - utils.results_reporting - INFO - 
Testing Hypothesis 1: Feature effects on reading time
2025-10-18 10:55:46,348 - utils.results_reporting - INFO -   Length: beta=0.1222, p=0.0000 - CONFIRMED
2025-10-18 10:55:46,348 - utils.results_reporting - INFO -   Frequency: beta=-0.0486, p=0.0000 - CONFIRMED
2025-10-18 10:55:46,348 - utils.results_reporting - INFO -   Surprisal: beta=0.0317, p=0.0000 - CONFIRMED
2025-10-18 10:55:46,348 - utils.results_reporting - INFO - 
Hypothesis 1: CONFIRMED
2025-10-18 10:55:46,349 - utils.results_reporting - INFO - 
Testing Hypothesis 2: Dyslexic amplification
2025-10-18 10:55:46,349 - utils.results_reporting - INFO - 
Hypothesis 2: CONFIRMED
2025-10-18 10:55:46,349 - utils.results_reporting - INFO - 
Testing Hypothesis 3: Gap explanation
2025-10-18 10:55:46,350 - utils.results_reporting - INFO - 
================================================================================
2025-10-18 10:55:46,350 - utils.results_reporting - INFO - HYPOTHESIS TESTING RESULTS SUMMARY
2025-10-18 10:55:46,350 - utils.results_reporting - INFO - ================================================================================
2025-10-18 10:55:46,350 - utils.results_reporting - INFO - 
HYPOTHESIS 1: CONFIRMED
2025-10-18 10:55:46,350 - utils.results_reporting - INFO -   All features predict reading time in expected directions
2025-10-18 10:55:46,350 - utils.results_reporting - INFO - 
HYPOTHESIS 2: CONFIRMED
2025-10-18 10:55:46,350 - utils.results_reporting - INFO -   All features show dyslexic amplification (SR > 1)
2025-10-18 10:55:46,350 - utils.results_reporting - INFO - 
HYPOTHESIS 3: FAILED
2025-10-18 10:55:46,352 - __main__ - ERROR - Pipeline failed: 'summary'
Traceback (most recent call last):
  File "C:\Users\hugos\Desktop\Dyslexia_Time_Paper\Dyslexia_Time_Cost_Analysis\main.py", line 759, in main
    pipeline.run_hypothesis_testing_analysis()  # NEW
  File "C:\Users\hugos\Desktop\Dyslexia_Time_Paper\Dyslexia_Time_Cost_Analysis\main.py", line 439, in run_hypothesis_testing_analysis
    report = generate_hypothesis_testing_report(
  File "C:\Users\hugos\Desktop\Dyslexia_Time_Paper\Dyslexia_Time_Cost_Analysis\utils\results_reporting.py", line 51, in generate_hypothesis_testing_report
    generate_text_report(report)
  File "C:\Users\hugos\Desktop\Dyslexia_Time_Paper\Dyslexia_Time_Cost_Analysis\utils\results_reporting.py", line 438, in generate_text_report
    logger.info(f"  {h3['summary']}")
KeyError: 'summary'
2025-10-18 11:05:30,131 - __main__ - INFO - Dyslexia Time Analysis Pipeline initialized
2025-10-18 11:05:30,132 - __main__ - INFO - Dyslexia Time Analysis Pipeline initialized
2025-10-18 11:05:32,364 - __main__ - INFO - Running hypothesis testing analysis...
2025-10-18 11:05:32,364 - __main__ - INFO - ================================================================================
2025-10-18 11:05:32,364 - __main__ - INFO - HYPOTHESIS TESTING ANALYSIS
2025-10-18 11:05:32,364 - __main__ - INFO - ================================================================================
2025-10-18 11:05:32,364 - __main__ - INFO - Loading CopCo dataset...
2025-10-18 11:05:32,365 - utils.data_utils - INFO - Loading 57 participant files...
2025-10-18 11:05:34,163 - utils.data_utils - INFO - Starting with 335,203 total word entries
2025-10-18 11:05:34,332 - utils.data_utils - INFO - Word fixation patterns:
2025-10-18 11:05:34,332 - utils.data_utils - INFO -   - Skipped words (0 fixations): 126,302
2025-10-18 11:05:34,332 - utils.data_utils - INFO -   - Fixated words (1+ fixations): 208,901
2025-10-18 11:05:34,332 - utils.data_utils - INFO -   - Unknown fixations (NaN): 0
2025-10-18 11:05:34,362 - utils.data_utils - INFO - Fixated words reading times: median 272ms, 99th percentile 1777ms
2025-10-18 11:05:34,365 - utils.data_utils - INFO - Removed 14 fixated words with extreme reading times (0 too short, 14 too long)
2025-10-18 11:05:34,463 - utils.data_utils - INFO - Removed 23 words longer than 30 characters (likely data errors)
2025-10-18 11:05:34,499 - utils.data_utils - INFO - Final dataset: 126,302 skipped words, 208,864 fixated words
2025-10-18 11:05:34,499 - utils.data_utils - INFO - Data cleaning complete: 335,166 words retained (100.0% of original)
2025-10-18 11:05:34,508 - utils.data_utils - INFO - Groups identified: 19 dyslexic, 39 control
2025-10-18 11:05:34,577 - __main__ - INFO - Calculating skipping probabilities...
2025-10-18 11:05:34,581 - utils.skipping_utils - INFO - Skipping analysis from ExtractedFeatures:
2025-10-18 11:05:34,581 - utils.skipping_utils - INFO -   Total words: 335,166
2025-10-18 11:05:34,581 - utils.skipping_utils - INFO -   Skipped: 126,302 (37.7%)
2025-10-18 11:05:34,581 - utils.skipping_utils - INFO -   Fixated: 208,864 (62.3%)
2025-10-18 11:05:34,627 - __main__ - INFO - Skipping analysis: 37.7% overall rate
2025-10-18 11:05:34,645 - __main__ - INFO - Loaded: 335,166 words from 57 participants
2025-10-18 11:05:34,645 - __main__ - INFO - ============================================================
2025-10-18 11:05:34,645 - __main__ - INFO - COMPUTING LINGUISTIC FEATURES
2025-10-18 11:05:34,645 - __main__ - INFO - ============================================================
2025-10-18 11:05:34,646 - utils.linguistic_features - INFO - Loading Danish frequency list from danish_frequencies\danish_leipzig_for_analysis.txt
2025-10-18 11:05:36,125 - utils.linguistic_features - WARNING - Found 2 duplicate words after lowercasing. 
2025-10-18 11:05:36,562 - utils.linguistic_features - INFO - Loaded 1,499,999 word proportions from Leipzig Corpora
2025-10-18 11:05:36,622 - utils.linguistic_features - INFO - Computing word frequency...
2025-10-18 11:05:36,622 - utils.linguistic_features - INFO -   Stripping punctuation from words before frequency lookup
2025-10-18 11:05:37,284 - utils.linguistic_features - INFO - 13 missing word instances were punctuation-only
2025-10-18 11:05:37,284 - utils.linguistic_features - WARNING - 4,586 word instances (1.4%) not found in frequency list (197 unique valid words)
2025-10-18 11:05:37,284 - utils.linguistic_features - INFO - Sample of 197 missing valid words: ['9. og dronning', 'abrams efter', 'adunyadet', 'alauda', 'amerikansk science', 'april 1940 pÃ¥ amalienborg', 'bjergstien', 'blintzes', 'by-spildevand', 'cybermind', 'dambrugsomrÃ¥det', 'elevrÃ¥dsarrangementer', 'entrÃ©belÃ¸b', 'fattigdomsfÃ¦ngel', 'fosforudnyttelsen', 'frederiksavn', 'geografilÃ¦rers', 'hâer', 'idahot-forum', 'initiativlyst', 'istandgÃ¸re', 'itx-klassen', 'kaldet lemma', 'klimatilpasningspakke', 'kusine, christine', 'lederun', 'lgbtqi-diskrimination', 'live-action-udgaven', 'livsgrÃ¸den', 'lysfester', 'meduddannere', 'midsommeraftner', 'minervafester', 'naturlovgivning', 'pinsesalmerne', 'pÃ¥ charlottenborg', 'rekrutteringsindsatsen', 'siden margrethe', 'skraldepigerne', 'spejder-juniorer', 'spÃ¥domsevner', 'top-omstillingsparate', 'traume for', 'tusindÃ¥rsfornemmelser', 'valborgsnatten', 'vaneslÃ¦gt', 'var sveriges', 'vindmÃ¸lle-testanlÃ¦gget', 'vk-fÃ¦llesskabet', 'Ã¥rstidshjulet']... (147 more)
2025-10-18 11:05:37,290 - utils.linguistic_features - INFO - Excluding 4,599 word instances (1.4%) with missing frequencies from analysis
2025-10-18 11:05:37,398 - utils.linguistic_features - INFO - Remaining dataset: 330,567 words
2025-10-18 11:05:37,398 - utils.linguistic_features - INFO - Final dataset: 330,567 words with valid frequencies
2025-10-18 11:05:41,726 - utils.linguistic_features - INFO - Loading causal language model: KennethTM/gpt2-medium-danish
2025-10-18 11:05:43,338 - utils.linguistic_features - INFO - Using CPU for surprisal computation
2025-10-18 11:05:43,338 - utils.linguistic_features - INFO - Causal language model loaded successfully
2025-10-18 11:05:43,338 - utils.linguistic_features - INFO - Computing surprisal with causal GPT-2 (left-to-right)...
2025-10-18 11:05:44,607 - utils.linguistic_features - INFO - Dataset statistics:
2025-10-18 11:05:44,607 - utils.linguistic_features - INFO -   Total participant-sentence instances: 20,707
2025-10-18 11:05:44,607 - utils.linguistic_features - INFO -   Unique sentence texts: 1,986
2025-10-18 11:05:44,608 - utils.linguistic_features - INFO -   Average participants per sentence: 10.4
2025-10-18 11:05:44,608 - utils.linguistic_features - INFO - Loading cached surprisal values from word_surprisal\surprisal_cache_gpt2.pkl
2025-10-18 11:05:44,620 - utils.linguistic_features - INFO - Loaded surprisal for 1,986 unique sentences
2025-10-18 11:05:44,621 - utils.linguistic_features - INFO - Broadcasting surprisal values to all participant instances...
2025-10-18 11:05:44,621 - utils.linguistic_features - INFO -   Mapping surprisal to words...
2025-10-18 11:05:47,697 - utils.linguistic_features - INFO -   Mapped 326,496 words
2025-10-18 11:05:47,699 - utils.linguistic_features - INFO - 
Surprisal Computation Results:
2025-10-18 11:05:47,699 - utils.linguistic_features - INFO -   Unique sentences processed: 1,986
2025-10-18 11:05:47,699 - utils.linguistic_features - INFO -   Total words with surprisal: 326,496 / 330,567
2025-10-18 11:05:47,700 - utils.linguistic_features - INFO -   Mean: 6.93 bits
2025-10-18 11:05:47,704 - utils.linguistic_features - INFO -   Median: 5.69 bits
2025-10-18 11:05:47,705 - utils.linguistic_features - INFO -   Std: 5.55 bits
2025-10-18 11:05:47,707 - utils.linguistic_features - INFO -   Range: [0.00, 59.34] bits
2025-10-18 11:05:47,719 - utils.linguistic_features - INFO - Linguistic features added successfully
2025-10-18 11:05:47,719 - utils.linguistic_features - INFO - 
Feature Summary:
2025-10-18 11:05:47,722 - utils.linguistic_features - INFO -   Word length: mean=4.67, std=3.08
2025-10-18 11:05:47,724 - utils.linguistic_features - INFO -   Zipf frequency: mean=5.85, std=1.38, range=[0.91, 7.51]
2025-10-18 11:05:47,727 - utils.linguistic_features - INFO -   Surprisal: mean=6.93, std=5.55
2025-10-18 11:05:47,734 - utils.hypothesis_testing_utils - INFO - Preparing data for hypothesis testing...
2025-10-18 11:05:47,783 - utils.hypothesis_testing_utils - INFO - Creating ERT variable...
2025-10-18 11:05:47,786 - utils.hypothesis_testing_utils - INFO -   ERT created: 123,666 skipped (0ms), 206,901 fixated
2025-10-18 11:05:47,786 - utils.hypothesis_testing_utils - INFO - Centering and scaling predictors...
2025-10-18 11:05:47,802 - utils.hypothesis_testing_utils - INFO -   word_length: mean=4.67, scale=3.08
2025-10-18 11:05:47,819 - utils.hypothesis_testing_utils - INFO -   word_frequency_zipf: mean=5.85, scale=1.38
2025-10-18 11:05:47,834 - utils.hypothesis_testing_utils - INFO -   surprisal: mean=6.93, scale=5.55
2025-10-18 11:05:47,835 - utils.hypothesis_testing_utils - INFO - Checking collinearity (VIF)...
2025-10-18 11:05:47,959 - utils.hypothesis_testing_utils - INFO - VIF Results:
2025-10-18 11:05:47,960 - utils.hypothesis_testing_utils - INFO -   Length: 2.82 (OK)
2025-10-18 11:05:47,960 - utils.hypothesis_testing_utils - INFO -   Frequency: 3.18 (OK)
2025-10-18 11:05:47,960 - utils.hypothesis_testing_utils - INFO -   Surprisal: 1.41 (OK)
2025-10-18 11:05:47,961 - utils.hypothesis_testing_utils - INFO - Creating residualized surprisal...
2025-10-18 11:05:47,976 - utils.hypothesis_testing_utils - INFO -   Correlation (Frequency-Surprisal): r=-0.539
2025-10-18 11:05:47,976 - utils.hypothesis_testing_utils - INFO -   Residualized surprisal created
2025-10-18 11:05:47,976 - utils.hypothesis_testing_utils - INFO - Defining pooled quartiles...
2025-10-18 11:05:47,989 - utils.hypothesis_testing_utils - INFO -   word_length: Q1=2.00, Q3=6.00
2025-10-18 11:05:48,002 - utils.hypothesis_testing_utils - INFO -   word_frequency_zipf: Q1=4.91, Q3=7.10
2025-10-18 11:05:48,015 - utils.hypothesis_testing_utils - INFO -   surprisal: Q1=2.76, Q3=9.97
2025-10-18 11:05:48,015 - utils.hypothesis_testing_utils - INFO - Data preparation complete: 330,567 words ready for analysis
2025-10-18 11:05:48,028 - utils.quartile_analysis - INFO - ============================================================
2025-10-18 11:05:48,028 - utils.quartile_analysis - INFO - PART A: QUARTILE ANALYSIS (Q1 vs Q3)
2025-10-18 11:05:48,028 - utils.quartile_analysis - INFO - ============================================================
2025-10-18 11:05:48,028 - utils.quartile_analysis - INFO - 
Analyzing word_length...
2025-10-18 11:05:48,822 - utils.quartile_analysis - INFO -   Computed means for 57 participants
2025-10-18 11:05:48,823 - utils.quartile_analysis - INFO -     Control Q3-Q1: 259.7ms
2025-10-18 11:05:48,823 - utils.quartile_analysis - INFO -     Dyslexic Q3-Q1: 442.6ms
2025-10-18 11:05:48,896 - utils.quartile_analysis - INFO -   Fitting mixed model on 152,465 words...
2025-10-18 11:05:49,619 - utils.quartile_analysis - INFO -   GroupÃBin interaction: beta=134.79, p=0.0000
2025-10-18 11:05:49,654 - utils.quartile_analysis - INFO -   Computing bootstrap CIs (1000 iterations)...
2025-10-18 11:05:51,367 - utils.quartile_analysis - INFO -   Bootstrap 95% CI for interaction: [98.47, 259.71]
2025-10-18 11:05:51,368 - utils.quartile_analysis - INFO - 
Analyzing word_frequency_zipf...
2025-10-18 11:05:52,149 - utils.quartile_analysis - INFO -   Computed means for 57 participants
2025-10-18 11:05:52,149 - utils.quartile_analysis - INFO -     Control Q3-Q1: -225.9ms
2025-10-18 11:05:52,151 - utils.quartile_analysis - INFO -     Dyslexic Q3-Q1: -388.2ms
2025-10-18 11:05:52,214 - utils.quartile_analysis - INFO -   Fitting mixed model on 162,606 words...
2025-10-18 11:05:54,996 - utils.quartile_analysis - INFO -   GroupÃBin interaction: beta=-122.40, p=0.0000
2025-10-18 11:05:55,023 - utils.quartile_analysis - INFO -   Computing bootstrap CIs (1000 iterations)...
2025-10-18 11:05:56,715 - utils.quartile_analysis - INFO -   Bootstrap 95% CI for interaction: [-225.59, -87.90]
2025-10-18 11:05:56,717 - utils.quartile_analysis - INFO - 
Analyzing surprisal...
2025-10-18 11:05:57,512 - utils.quartile_analysis - INFO -   Computed means for 57 participants
2025-10-18 11:05:57,513 - utils.quartile_analysis - INFO -     Control Q3-Q1: 135.8ms
2025-10-18 11:05:57,515 - utils.quartile_analysis - INFO -     Dyslexic Q3-Q1: 277.3ms
2025-10-18 11:05:57,581 - utils.quartile_analysis - INFO -   Fitting mixed model on 163,257 words...
2025-10-18 11:06:00,124 - utils.quartile_analysis - INFO -   GroupÃBin interaction: beta=105.53, p=0.0000
2025-10-18 11:06:00,154 - utils.quartile_analysis - INFO -   Computing bootstrap CIs (1000 iterations)...
2025-10-18 11:06:01,837 - utils.quartile_analysis - INFO -   Bootstrap 95% CI for interaction: [84.99, 194.82]
2025-10-18 11:06:01,838 - utils.continuous_models - INFO - ============================================================
2025-10-18 11:06:01,838 - utils.continuous_models - INFO - PART B: CONTINUOUS MODELS (TWO-PART)
2025-10-18 11:06:01,838 - utils.continuous_models - INFO - ============================================================
2025-10-18 11:06:01,838 - utils.continuous_models - INFO - 
1. SKIPPING MODEL (Logistic with Clustered SEs)
2025-10-18 11:06:01,942 - utils.continuous_models - INFO -   Formula: skipped ~ dyslexic_int * (word_length_scaled + word_frequency_zipf_scaled + surprisal_scaled)
2025-10-18 11:06:01,942 - utils.continuous_models - INFO -   Fitting on 326,496 words...
2025-10-18 11:06:02,689 - utils.continuous_models - INFO -   Model fitted successfully with clustered SEs
2025-10-18 11:06:02,691 - utils.continuous_models - INFO -     dyslexic_int:word_length_scaled: beta=-0.0250, p=0.6714
2025-10-18 11:06:02,691 - utils.continuous_models - INFO -     dyslexic_int:word_frequency_zipf_scaled: beta=-0.0640, p=0.1975
2025-10-18 11:06:02,691 - utils.continuous_models - INFO -     dyslexic_int:surprisal_scaled: beta=-0.0272, p=0.2667
2025-10-18 11:06:02,700 - utils.continuous_models - INFO - 
2. DURATION MODEL (Log-TRT | Fixated)
2025-10-18 11:06:02,827 - utils.continuous_models - INFO -   Formula: log_TRT ~ dyslexic_int * (word_length_scaled + word_frequency_zipf_scaled + surprisal_scaled)
2025-10-18 11:06:02,828 - utils.continuous_models - INFO -   Fitting on 204,224 fixated words...
2025-10-18 11:06:03,904 - utils.continuous_models - INFO -   Model fitted successfully
2025-10-18 11:06:03,904 - utils.continuous_models - INFO -   Smearing correction factor: 1.1562
2025-10-18 11:06:03,905 - utils.continuous_models - INFO -     dyslexic_int:word_length_scaled: beta=0.0078, p=0.0585
2025-10-18 11:06:03,905 - utils.continuous_models - INFO -     dyslexic_int:word_frequency_zipf_scaled: beta=-0.0084, p=0.0678
2025-10-18 11:06:03,905 - utils.continuous_models - INFO -     dyslexic_int:surprisal_scaled: beta=0.0349, p=0.0000
2025-10-18 11:06:03,913 - utils.continuous_models - INFO - 
3. PREDICTING EXPECTED ERT
2025-10-18 11:06:03,965 - utils.continuous_models - INFO -   Predicting expected ERT...
2025-10-18 11:06:04,217 - utils.continuous_models - INFO -   Predicted expected ERT for 326,496 words
2025-10-18 11:06:04,219 - utils.continuous_models - INFO -     Mean expected ERT: 228.71ms
2025-10-18 11:06:04,220 - utils.continuous_models - INFO -     Mean observed ERT: 236.03ms
2025-10-18 11:06:04,229 - utils.continuous_models - INFO - 
4. VARIANCE EXPLAINED (ÎRÂ² on Expected ERT)
2025-10-18 11:06:04,352 - utils.continuous_models - INFO -   Computing ÎRÂ² on 326,496 observations
2025-10-18 11:06:04,645 - utils.continuous_models - INFO -     M0: RÂ² = 0.2074
2025-10-18 11:06:04,971 - utils.continuous_models - INFO -     M1: RÂ² = 0.9267
2025-10-18 11:06:05,313 - utils.continuous_models - INFO -     M2: RÂ² = 0.9501
2025-10-18 11:06:05,711 - utils.continuous_models - INFO -     M3: RÂ² = 0.9608
2025-10-18 11:06:05,711 - utils.continuous_models - INFO - 
  Variance Explained (ÎRÂ²):
2025-10-18 11:06:05,711 - utils.continuous_models - INFO -     Length: ÎRÂ² = 0.7193 (71.93%)
2025-10-18 11:06:05,711 - utils.continuous_models - INFO -     Frequency: ÎRÂ² = 0.0233 (2.33%)
2025-10-18 11:06:05,711 - utils.continuous_models - INFO -     Surprisal: ÎRÂ² = 0.0107 (1.07%)
2025-10-18 11:06:05,741 - utils.continuous_models - INFO - 
5. MS SHIFTS (Q1âQ3 on Expected ERT)
2025-10-18 11:06:05,749 - utils.continuous_models - INFO - 
  word_length: Q1=2.00, Q3=6.00
2025-10-18 11:06:05,774 - utils.continuous_models - INFO -     Control: 136.3ms -> 220.5ms (Î = 84.1ms)
2025-10-18 11:06:05,801 - utils.continuous_models - INFO -     Dyslexic: 239.3ms -> 361.0ms (Î = 121.7ms)
2025-10-18 11:06:05,810 - utils.continuous_models - INFO - 
  word_frequency_zipf: Q1=4.91, Q3=7.10
2025-10-18 11:06:05,838 - utils.continuous_models - INFO -     Control: 209.3ms -> 167.5ms (Î = -41.8ms)
2025-10-18 11:06:05,861 - utils.continuous_models - INFO -     Dyslexic: 342.6ms -> 290.3ms (Î = -52.3ms)
2025-10-18 11:06:05,871 - utils.continuous_models - INFO - 
  surprisal: Q1=2.76, Q3=9.97
2025-10-18 11:06:05,891 - utils.continuous_models - INFO -     Control: 185.2ms -> 195.4ms (Î = 10.2ms)
2025-10-18 11:06:05,908 - utils.continuous_models - INFO -     Dyslexic: 300.9ms -> 334.1ms (Î = 33.3ms)
2025-10-18 11:06:05,908 - utils.continuous_models - INFO - 
6. SLOPE RATIOS (Finite Differences on Expected ERT)
2025-10-18 11:06:05,946 - utils.continuous_models - INFO -   word_length: SR = 1.447 (AMPLIFIED)
2025-10-18 11:06:05,988 - utils.continuous_models - INFO -   word_frequency_zipf: SR = 1.251 (AMPLIFIED)
2025-10-18 11:06:06,029 - utils.continuous_models - INFO -   surprisal: SR = 3.257 (AMPLIFIED)
2025-10-18 11:06:06,030 - utils.continuous_models - INFO - 
7. BOOTSTRAP CONFIDENCE INTERVALS
2025-10-18 11:06:06,030 - utils.continuous_models - INFO -   Computing bootstrap CIs (100 iterations)...
2025-10-18 11:06:28,503 - utils.gap_decomposition - INFO - ============================================================
2025-10-18 11:06:28,504 - utils.gap_decomposition - INFO - PART C: GAP DECOMPOSITION
2025-10-18 11:06:28,504 - utils.gap_decomposition - INFO - ============================================================
2025-10-18 11:06:28,555 - utils.gap_decomposition - INFO - 
Fitting M0 (main effects only)...
2025-10-18 11:06:28,555 - utils.gap_decomposition - INFO -   Formula: ERT_expected ~ dyslexic_int
2025-10-18 11:06:28,905 - utils.gap_decomposition - INFO -   M0 fitted successfully (OLS with clustered SEs)
2025-10-18 11:06:28,905 - utils.gap_decomposition - INFO - 
Fitting M1 (main effects only)...
2025-10-18 11:06:28,905 - utils.gap_decomposition - INFO -   Formula: ERT_expected ~ dyslexic_int + word_length_scaled
2025-10-18 11:06:29,274 - utils.gap_decomposition - INFO -   M1 fitted successfully (OLS with clustered SEs)
2025-10-18 11:06:29,275 - utils.gap_decomposition - INFO - 
Fitting M2 (main effects only)...
2025-10-18 11:06:29,275 - utils.gap_decomposition - INFO -   Formula: ERT_expected ~ dyslexic_int + word_length_scaled + word_frequency_zipf_scaled
2025-10-18 11:06:29,695 - utils.gap_decomposition - INFO -   M2 fitted successfully (OLS with clustered SEs)
2025-10-18 11:06:29,695 - utils.gap_decomposition - INFO - 
Fitting M3 (main effects only)...
2025-10-18 11:06:29,695 - utils.gap_decomposition - INFO -   Formula: ERT_expected ~ dyslexic_int + word_length_scaled + word_frequency_zipf_scaled + surprisal_scaled
2025-10-18 11:06:30,118 - utils.gap_decomposition - INFO -   M3 fitted successfully (OLS with clustered SEs)
2025-10-18 11:06:30,128 - utils.gap_decomposition - INFO - 
Computing counterfactual gaps...
2025-10-18 11:06:30,345 - utils.gap_decomposition - INFO -   M0: Gap = 133.03ms
2025-10-18 11:06:30,598 - utils.gap_decomposition - INFO -   M1: Gap = 132.03ms
2025-10-18 11:06:30,862 - utils.gap_decomposition - INFO -   M2: Gap = 132.16ms
2025-10-18 11:06:31,121 - utils.gap_decomposition - INFO -   M3: Gap = 132.02ms
2025-10-18 11:06:31,147 - utils.gap_decomposition - INFO - 
Computing RÂ²...
2025-10-18 11:06:31,156 - utils.gap_decomposition - INFO -   M0: RÂ² = 0.2074
2025-10-18 11:06:31,165 - utils.gap_decomposition - INFO -   M1: RÂ² = 0.9267
2025-10-18 11:06:31,175 - utils.gap_decomposition - INFO -   M2: RÂ² = 0.9501
2025-10-18 11:06:31,187 - utils.gap_decomposition - INFO -   M3: RÂ² = 0.9608
2025-10-18 11:06:31,188 - utils.gap_decomposition - INFO - 
Fitting interaction models (Oaxaca/Blinder decomposition)...
2025-10-18 11:06:31,304 - utils.gap_decomposition - INFO -   Fitting M1_int...
2025-10-18 11:06:31,633 - utils.gap_decomposition - INFO -     M1_int fitted successfully
2025-10-18 11:06:31,704 - utils.gap_decomposition - INFO -   Fitting M2_int...
2025-10-18 11:06:32,136 - utils.gap_decomposition - INFO -     M2_int fitted successfully
2025-10-18 11:06:32,204 - utils.gap_decomposition - INFO -   Fitting M3_int...
2025-10-18 11:06:32,666 - utils.gap_decomposition - INFO -     M3_int fitted successfully
2025-10-18 11:06:32,677 - utils.gap_decomposition - INFO - 
Oaxaca/Blinder Decomposition:
2025-10-18 11:06:33,839 - utils.gap_decomposition - INFO -   Baseline gap: 133.03ms
2025-10-18 11:06:33,839 - utils.gap_decomposition - INFO -   Composition effect: 1.00ms (0.8%)
2025-10-18 11:06:33,839 - utils.gap_decomposition - INFO -   Coefficient effect: -0.30ms (-0.2%)
2025-10-18 11:06:33,839 - utils.gap_decomposition - INFO -   Residual gap: 131.72ms
2025-10-18 11:06:33,910 - utils.gap_decomposition - INFO - 
GAP DECOMPOSITION SUMMARY:
2025-10-18 11:06:33,911 - utils.gap_decomposition - INFO -   Baseline gap (M0): 133.03ms
2025-10-18 11:06:33,911 - utils.gap_decomposition - INFO -   M1: Gap=132.03ms, Explained=0.7%, DeltaRÂ²=0.7193
2025-10-18 11:06:33,911 - utils.gap_decomposition - INFO -   M2: Gap=132.16ms, Explained=0.6%, DeltaRÂ²=0.0233
2025-10-18 11:06:33,911 - utils.gap_decomposition - INFO -   M3: Gap=132.02ms, Explained=0.8%, DeltaRÂ²=0.0107
2025-10-18 11:06:33,912 - utils.sensitivity_analysis - INFO - ============================================================
2025-10-18 11:06:33,912 - utils.sensitivity_analysis - INFO - SENSITIVITY ANALYSES
2025-10-18 11:06:33,912 - utils.sensitivity_analysis - INFO - ============================================================
2025-10-18 11:06:33,912 - utils.sensitivity_analysis - INFO - 
1. RESIDUALIZED SURPRISAL MODEL
2025-10-18 11:06:33,992 - utils.sensitivity_analysis - INFO -   Formula: ERT ~ dyslexic_int * (word_length_scaled + word_frequency_zipf_scaled + surprisal_resid)
2025-10-18 11:06:34,586 - utils.sensitivity_analysis - INFO -   Residualized surprisal: beta=11.6330, p=0.0000
2025-10-18 11:06:34,587 - utils.sensitivity_analysis - INFO -   [OK] Surprisal effect robust to frequency collinearity
2025-10-18 11:06:34,598 - utils.sensitivity_analysis - INFO - 
2. SUBJECT-WISE CROSS-VALIDATION
2025-10-18 11:06:34,599 - utils.sensitivity_analysis - INFO -   Running 10-fold subject-wise CV...
2025-10-18 11:06:34,845 - utils.sensitivity_analysis - INFO -     Fold 1/10
2025-10-18 11:06:35,431 - utils.sensitivity_analysis - INFO -     Fold 2/10
2025-10-18 11:06:36,126 - utils.sensitivity_analysis - INFO -     Fold 3/10
2025-10-18 11:06:36,733 - utils.sensitivity_analysis - INFO -     Fold 4/10
2025-10-18 11:06:37,299 - utils.sensitivity_analysis - INFO -     Fold 5/10
2025-10-18 11:06:37,874 - utils.sensitivity_analysis - INFO -     Fold 6/10
2025-10-18 11:06:38,970 - utils.sensitivity_analysis - INFO -     Fold 7/10
2025-10-18 11:06:39,557 - utils.sensitivity_analysis - INFO -     Fold 8/10
2025-10-18 11:06:40,084 - utils.sensitivity_analysis - INFO -     Fold 9/10
2025-10-18 11:06:40,631 - utils.sensitivity_analysis - INFO -     Fold 10/10
2025-10-18 11:06:41,167 - utils.sensitivity_analysis - INFO -   Cross-validation RÂ²: -0.3352 Â± 0.2999
2025-10-18 11:06:41,167 - utils.sensitivity_analysis - INFO -   Based on 10 successful folds
2025-10-18 11:06:41,203 - utils.sensitivity_analysis - INFO - 
3. ALTERNATIVE BINNING (Terciles & Quintiles)
2025-10-18 11:06:41,204 - utils.sensitivity_analysis - INFO - 
  Testing terciles...
2025-10-18 11:06:41,325 - utils.sensitivity_analysis - INFO -     word_length: Control Î=202.4ms, Dyslexic Î=304.4ms
2025-10-18 11:06:41,425 - utils.sensitivity_analysis - INFO -     word_frequency_zipf: Control Î=-187.4ms, Dyslexic Î=-283.4ms
2025-10-18 11:06:41,529 - utils.sensitivity_analysis - INFO -     surprisal: Control Î=112.9ms, Dyslexic Î=200.7ms
2025-10-18 11:06:41,530 - utils.sensitivity_analysis - INFO - 
  Testing quintiles...
2025-10-18 11:06:41,606 - utils.sensitivity_analysis - INFO -     word_length: Control Î=284.7ms, Dyslexic Î=452.5ms
2025-10-18 11:06:41,680 - utils.sensitivity_analysis - INFO -     word_frequency_zipf: Control Î=-242.1ms, Dyslexic Î=-393.1ms
2025-10-18 11:06:41,762 - utils.sensitivity_analysis - INFO -     surprisal: Control Î=150.5ms, Dyslexic Î=270.2ms
2025-10-18 11:06:41,768 - utils.hypothesis_visualization - INFO - ============================================================
2025-10-18 11:06:41,768 - utils.hypothesis_visualization - INFO - CREATING VISUALIZATIONS
2025-10-18 11:06:41,769 - utils.hypothesis_visualization - INFO - ============================================================
2025-10-18 11:06:41,770 - utils.hypothesis_visualization - INFO - 
1. Continuous effect curves...
2025-10-18 11:06:43,021 - utils.hypothesis_visualization - INFO -   Saved to results\continuous_effects_with_quartiles.png
2025-10-18 11:06:43,024 - utils.hypothesis_visualization - INFO - 2. Gap decomposition...
2025-10-18 11:06:43,323 - utils.hypothesis_visualization - INFO -   Saved to results\gap_decomposition.png
2025-10-18 11:06:43,323 - utils.hypothesis_visualization - INFO - 3. Slope ratios...
2025-10-18 11:06:43,605 - utils.hypothesis_visualization - INFO -   Saved to results\slope_ratios.png
2025-10-18 11:06:43,606 - utils.hypothesis_visualization - INFO - 4. Model comparison...
2025-10-18 11:06:43,619 - matplotlib.category - INFO - Using categorical units to plot a list of strings that are all parsable as floats or dates. If these strings should be plotted as numbers, cast to the appropriate data type before plotting.
2025-10-18 11:06:43,620 - matplotlib.category - INFO - Using categorical units to plot a list of strings that are all parsable as floats or dates. If these strings should be plotted as numbers, cast to the appropriate data type before plotting.
2025-10-18 11:06:43,976 - utils.hypothesis_visualization - INFO -   Saved to results\model_comparison.png
2025-10-18 11:06:43,977 - utils.hypothesis_visualization - INFO - 5. Quartile effects...
2025-10-18 11:06:44,564 - utils.hypothesis_visualization - INFO -   Saved to results\quartile_effects.png
2025-10-18 11:06:44,565 - utils.hypothesis_visualization - INFO - 6. Predicted vs observed...
2025-10-18 11:06:44,663 - __main__ - ERROR - Pipeline failed: Input contains NaN.
Traceback (most recent call last):
  File "C:\Users\hugos\Desktop\Dyslexia_Time_Paper\Dyslexia_Time_Cost_Analysis\main.py", line 759, in main
    pipeline.run_hypothesis_testing_analysis()  # NEW
  File "C:\Users\hugos\Desktop\Dyslexia_Time_Paper\Dyslexia_Time_Cost_Analysis\main.py", line 434, in run_hypothesis_testing_analysis
    create_hypothesis_testing_visualizations(
  File "C:\Users\hugos\Desktop\Dyslexia_Time_Paper\Dyslexia_Time_Cost_Analysis\utils\hypothesis_visualization.py", line 63, in create_hypothesis_testing_visualizations
    plot_predicted_vs_observed(
  File "C:\Users\hugos\Desktop\Dyslexia_Time_Paper\Dyslexia_Time_Cost_Analysis\utils\hypothesis_visualization.py", line 645, in plot_predicted_vs_observed
    r2 = r2_score(observed, predicted)
  File "C:\Users\hugos\miniconda3\envs\dyslexia-time-analysis\lib\site-packages\sklearn\utils\_param_validation.py", line 218, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\hugos\miniconda3\envs\dyslexia-time-analysis\lib\site-packages\sklearn\metrics\_regression.py", line 1276, in r2_score
    _check_reg_targets_with_floating_dtype(
  File "C:\Users\hugos\miniconda3\envs\dyslexia-time-analysis\lib\site-packages\sklearn\metrics\_regression.py", line 209, in _check_reg_targets_with_floating_dtype
    y_type, y_true, y_pred, sample_weight, multioutput = _check_reg_targets(
  File "C:\Users\hugos\miniconda3\envs\dyslexia-time-analysis\lib\site-packages\sklearn\metrics\_regression.py", line 116, in _check_reg_targets
    y_pred = check_array(y_pred, ensure_2d=False, dtype=dtype)
  File "C:\Users\hugos\miniconda3\envs\dyslexia-time-analysis\lib\site-packages\sklearn\utils\validation.py", line 1105, in check_array
    _assert_all_finite(
  File "C:\Users\hugos\miniconda3\envs\dyslexia-time-analysis\lib\site-packages\sklearn\utils\validation.py", line 120, in _assert_all_finite
    _assert_all_finite_element_wise(
  File "C:\Users\hugos\miniconda3\envs\dyslexia-time-analysis\lib\site-packages\sklearn\utils\validation.py", line 169, in _assert_all_finite_element_wise
    raise ValueError(msg_err)
ValueError: Input contains NaN.
2025-10-18 11:21:06,578 - __main__ - INFO - Dyslexia Time Analysis Pipeline initialized
2025-10-18 11:21:06,578 - __main__ - INFO - Dyslexia Time Analysis Pipeline initialized
2025-10-18 11:21:08,243 - __main__ - INFO - Running hypothesis testing analysis...
2025-10-18 11:21:08,243 - __main__ - INFO - ================================================================================
2025-10-18 11:21:08,244 - __main__ - INFO - HYPOTHESIS TESTING ANALYSIS
2025-10-18 11:21:08,244 - __main__ - INFO - ================================================================================
2025-10-18 11:21:08,244 - __main__ - INFO - Loading CopCo dataset...
2025-10-18 11:21:08,245 - utils.data_utils - INFO - Loading 57 participant files...
2025-10-18 11:21:09,982 - utils.data_utils - INFO - Starting with 335,203 total word entries
2025-10-18 11:21:10,151 - utils.data_utils - INFO - Word fixation patterns:
2025-10-18 11:21:10,152 - utils.data_utils - INFO -   - Skipped words (0 fixations): 126,302
2025-10-18 11:21:10,152 - utils.data_utils - INFO -   - Fixated words (1+ fixations): 208,901
2025-10-18 11:21:10,153 - utils.data_utils - INFO -   - Unknown fixations (NaN): 0
2025-10-18 11:21:10,187 - utils.data_utils - INFO - Fixated words reading times: median 272ms, 99th percentile 1777ms
2025-10-18 11:21:10,190 - utils.data_utils - INFO - Removed 14 fixated words with extreme reading times (0 too short, 14 too long)
2025-10-18 11:21:10,291 - utils.data_utils - INFO - Removed 23 words longer than 30 characters (likely data errors)
2025-10-18 11:21:10,330 - utils.data_utils - INFO - Final dataset: 126,302 skipped words, 208,864 fixated words
2025-10-18 11:21:10,330 - utils.data_utils - INFO - Data cleaning complete: 335,166 words retained (100.0% of original)
2025-10-18 11:21:10,339 - utils.data_utils - INFO - Groups identified: 19 dyslexic, 39 control
2025-10-18 11:21:10,414 - __main__ - INFO - Calculating skipping probabilities...
2025-10-18 11:21:10,417 - utils.skipping_utils - INFO - Skipping analysis from ExtractedFeatures:
2025-10-18 11:21:10,417 - utils.skipping_utils - INFO -   Total words: 335,166
2025-10-18 11:21:10,417 - utils.skipping_utils - INFO -   Skipped: 126,302 (37.7%)
2025-10-18 11:21:10,418 - utils.skipping_utils - INFO -   Fixated: 208,864 (62.3%)
2025-10-18 11:21:10,465 - __main__ - INFO - Skipping analysis: 37.7% overall rate
2025-10-18 11:21:10,484 - __main__ - INFO - Loaded: 335,166 words from 57 participants
2025-10-18 11:21:10,484 - __main__ - INFO - ============================================================
2025-10-18 11:21:10,484 - __main__ - INFO - COMPUTING LINGUISTIC FEATURES
2025-10-18 11:21:10,484 - __main__ - INFO - ============================================================
2025-10-18 11:21:10,485 - utils.linguistic_features - INFO - Loading Danish frequency list from danish_frequencies\danish_leipzig_for_analysis.txt
2025-10-18 11:21:11,919 - utils.linguistic_features - WARNING - Found 2 duplicate words after lowercasing. 
2025-10-18 11:21:12,399 - utils.linguistic_features - INFO - Loaded 1,499,999 word proportions from Leipzig Corpora
2025-10-18 11:21:12,491 - utils.linguistic_features - INFO - Computing word frequency...
2025-10-18 11:21:12,492 - utils.linguistic_features - INFO -   Stripping punctuation from words before frequency lookup
2025-10-18 11:21:13,209 - utils.linguistic_features - INFO - 13 missing word instances were punctuation-only
2025-10-18 11:21:13,210 - utils.linguistic_features - WARNING - 4,586 word instances (1.4%) not found in frequency list (197 unique valid words)
2025-10-18 11:21:13,210 - utils.linguistic_features - INFO - Sample of 197 missing valid words: ['1926-2016', '2000-direktiverne', '9. og dronning', 'af christian', 'april 1940 pÃ¥ amalienborg', 'at blomsterstanden er', 'blÃ¦redygtige', 'broder-sÃ¸sterligt', 'cybermind', 'cÃ¸libatÃ¦gteskabet', 'demonstrationsland', 'downcycling', 'efter star', 'elevrÃ¥dsarrangementer', 'fosforressourcer', 'grillparties', 'havtema', 'hejre (bromus', 'heksejagte', 'hetzbÃ¸lger', 'hâer', 'ingrid, danmarks', 'isotropic', 'it-mulighederne', 'itx-klasse', 'itx-klassen', 'jedi (2017', 'kabeltromlerne', 'kaldet lemma', 'klimatilpasningspakke', 'lgbtqi-miljÃ¸et', 'lgbtqi-personer', 'lgbtqi-rettigheder', 'lÃ¸vmand og', 'meduddannere', 'minervafester', 'naturlovgivning', 'og star', 'pÃ¥ charlottenborg', 'rekrutteringsindsatsen', 'sankthansormen', 'skraldepigerne', 'solhversfesten', 'spejder-juniorer', 'terracottafabrik', 'vandmiljÃ¸indsats', 'var sveriges', 'vindmÃ¸lle-testanlÃ¦gget', 'vk-Ã¥nden', 'Ã¥rshjulets']... (147 more)
2025-10-18 11:21:13,217 - utils.linguistic_features - INFO - Excluding 4,599 word instances (1.4%) with missing frequencies from analysis
2025-10-18 11:21:13,342 - utils.linguistic_features - INFO - Remaining dataset: 330,567 words
2025-10-18 11:21:13,342 - utils.linguistic_features - INFO - Final dataset: 330,567 words with valid frequencies
2025-10-18 11:21:17,633 - utils.linguistic_features - INFO - Loading causal language model: KennethTM/gpt2-medium-danish
2025-10-18 11:21:19,161 - utils.linguistic_features - INFO - Using CPU for surprisal computation
2025-10-18 11:21:19,161 - utils.linguistic_features - INFO - Causal language model loaded successfully
2025-10-18 11:21:19,161 - utils.linguistic_features - INFO - Computing surprisal with causal GPT-2 (left-to-right)...
2025-10-18 11:21:20,472 - utils.linguistic_features - INFO - Dataset statistics:
2025-10-18 11:21:20,472 - utils.linguistic_features - INFO -   Total participant-sentence instances: 20,707
2025-10-18 11:21:20,472 - utils.linguistic_features - INFO -   Unique sentence texts: 1,986
2025-10-18 11:21:20,472 - utils.linguistic_features - INFO -   Average participants per sentence: 10.4
2025-10-18 11:21:20,473 - utils.linguistic_features - INFO - Loading cached surprisal values from word_surprisal\surprisal_cache_gpt2.pkl
2025-10-18 11:21:20,484 - utils.linguistic_features - INFO - Loaded surprisal for 1,986 unique sentences
2025-10-18 11:21:20,485 - utils.linguistic_features - INFO - Broadcasting surprisal values to all participant instances...
2025-10-18 11:21:20,485 - utils.linguistic_features - INFO -   Mapping surprisal to words...
2025-10-18 11:21:23,720 - utils.linguistic_features - INFO -   Mapped 326,496 words
2025-10-18 11:21:23,722 - utils.linguistic_features - INFO - 
Surprisal Computation Results:
2025-10-18 11:21:23,722 - utils.linguistic_features - INFO -   Unique sentences processed: 1,986
2025-10-18 11:21:23,722 - utils.linguistic_features - INFO -   Total words with surprisal: 326,496 / 330,567
2025-10-18 11:21:23,722 - utils.linguistic_features - INFO -   Mean: 6.93 bits
2025-10-18 11:21:23,726 - utils.linguistic_features - INFO -   Median: 5.69 bits
2025-10-18 11:21:23,728 - utils.linguistic_features - INFO -   Std: 5.55 bits
2025-10-18 11:21:23,728 - utils.linguistic_features - INFO -   Range: [0.00, 59.34] bits
2025-10-18 11:21:23,745 - utils.linguistic_features - INFO - Linguistic features added successfully
2025-10-18 11:21:23,746 - utils.linguistic_features - INFO - 
Feature Summary:
2025-10-18 11:21:23,748 - utils.linguistic_features - INFO -   Word length: mean=4.67, std=3.08
2025-10-18 11:21:23,749 - utils.linguistic_features - INFO -   Zipf frequency: mean=5.85, std=1.38, range=[0.91, 7.51]
2025-10-18 11:21:23,752 - utils.linguistic_features - INFO -   Surprisal: mean=6.93, std=5.55
2025-10-18 11:21:23,760 - utils.hypothesis_testing_utils - INFO - Preparing data for hypothesis testing...
2025-10-18 11:21:23,800 - utils.hypothesis_testing_utils - INFO - Creating ERT variable...
2025-10-18 11:21:23,803 - utils.hypothesis_testing_utils - INFO -   ERT created: 123,666 skipped (0ms), 206,901 fixated
2025-10-18 11:21:23,803 - utils.hypothesis_testing_utils - INFO - Centering and scaling predictors...
2025-10-18 11:21:23,821 - utils.hypothesis_testing_utils - INFO -   word_length: mean=4.67, scale=3.08
2025-10-18 11:21:23,837 - utils.hypothesis_testing_utils - INFO -   word_frequency_zipf: mean=5.85, scale=1.38
2025-10-18 11:21:23,849 - utils.hypothesis_testing_utils - INFO -   surprisal: mean=6.93, scale=5.55
2025-10-18 11:21:23,850 - utils.hypothesis_testing_utils - INFO - Checking collinearity (VIF)...
2025-10-18 11:21:23,958 - utils.hypothesis_testing_utils - INFO - VIF Results:
2025-10-18 11:21:23,959 - utils.hypothesis_testing_utils - INFO -   Length: 2.82 (OK)
2025-10-18 11:21:23,959 - utils.hypothesis_testing_utils - INFO -   Frequency: 3.18 (OK)
2025-10-18 11:21:23,959 - utils.hypothesis_testing_utils - INFO -   Surprisal: 1.41 (OK)
2025-10-18 11:21:23,960 - utils.hypothesis_testing_utils - INFO - Creating residualized surprisal...
2025-10-18 11:21:23,977 - utils.hypothesis_testing_utils - INFO -   Correlation (Frequency-Surprisal): r=-0.539
2025-10-18 11:21:23,977 - utils.hypothesis_testing_utils - INFO -   Residualized surprisal created
2025-10-18 11:21:23,977 - utils.hypothesis_testing_utils - INFO - Defining pooled quartiles...
2025-10-18 11:21:23,990 - utils.hypothesis_testing_utils - INFO -   word_length: Q1=2.00, Q3=6.00
2025-10-18 11:21:24,001 - utils.hypothesis_testing_utils - INFO -   word_frequency_zipf: Q1=4.91, Q3=7.10
2025-10-18 11:21:24,015 - utils.hypothesis_testing_utils - INFO -   surprisal: Q1=2.76, Q3=9.97
2025-10-18 11:21:24,015 - utils.hypothesis_testing_utils - INFO - Data preparation complete: 330,567 words ready for analysis
2025-10-18 11:21:24,027 - utils.quartile_analysis - INFO - ============================================================
2025-10-18 11:21:24,028 - utils.quartile_analysis - INFO - PART A: QUARTILE ANALYSIS (Q1 vs Q3)
2025-10-18 11:21:24,028 - utils.quartile_analysis - INFO - ============================================================
2025-10-18 11:21:24,028 - utils.quartile_analysis - INFO - 
Analyzing word_length...
2025-10-18 11:21:24,848 - utils.quartile_analysis - INFO -   Computed means for 57 participants
2025-10-18 11:21:24,849 - utils.quartile_analysis - INFO -     Control Q3-Q1: 259.7ms
2025-10-18 11:21:24,849 - utils.quartile_analysis - INFO -     Dyslexic Q3-Q1: 442.6ms
2025-10-18 11:21:24,906 - utils.quartile_analysis - INFO -   Fitting mixed model on 152,465 words...
2025-10-18 11:21:25,492 - utils.quartile_analysis - INFO -   GroupÃBin interaction: beta=134.79, p=0.0000
2025-10-18 11:21:25,524 - utils.quartile_analysis - INFO -   Computing bootstrap CIs (1000 iterations)...
2025-10-18 11:21:27,258 - utils.quartile_analysis - INFO -   Bootstrap 95% CI for interaction: [98.47, 259.71]
2025-10-18 11:21:27,259 - utils.quartile_analysis - INFO - 
Analyzing word_frequency_zipf...
2025-10-18 11:21:28,073 - utils.quartile_analysis - INFO -   Computed means for 57 participants
2025-10-18 11:21:28,073 - utils.quartile_analysis - INFO -     Control Q3-Q1: -225.9ms
2025-10-18 11:21:28,074 - utils.quartile_analysis - INFO -     Dyslexic Q3-Q1: -388.2ms
2025-10-18 11:21:28,135 - utils.quartile_analysis - INFO -   Fitting mixed model on 162,606 words...
2025-10-18 11:21:30,977 - utils.quartile_analysis - INFO -   GroupÃBin interaction: beta=-122.40, p=0.0000
2025-10-18 11:21:31,004 - utils.quartile_analysis - INFO -   Computing bootstrap CIs (1000 iterations)...
2025-10-18 11:21:32,709 - utils.quartile_analysis - INFO -   Bootstrap 95% CI for interaction: [-225.59, -87.90]
2025-10-18 11:21:32,709 - utils.quartile_analysis - INFO - 
Analyzing surprisal...
2025-10-18 11:21:33,513 - utils.quartile_analysis - INFO -   Computed means for 57 participants
2025-10-18 11:21:33,514 - utils.quartile_analysis - INFO -     Control Q3-Q1: 135.8ms
2025-10-18 11:21:33,515 - utils.quartile_analysis - INFO -     Dyslexic Q3-Q1: 277.3ms
2025-10-18 11:21:33,578 - utils.quartile_analysis - INFO -   Fitting mixed model on 163,257 words...
2025-10-18 11:21:36,230 - utils.quartile_analysis - INFO -   GroupÃBin interaction: beta=105.53, p=0.0000
2025-10-18 11:21:36,263 - utils.quartile_analysis - INFO -   Computing bootstrap CIs (1000 iterations)...
2025-10-18 11:21:38,005 - utils.quartile_analysis - INFO -   Bootstrap 95% CI for interaction: [84.99, 194.82]
2025-10-18 11:21:38,005 - utils.continuous_models - INFO - ============================================================
2025-10-18 11:21:38,005 - utils.continuous_models - INFO - PART B: CONTINUOUS MODELS (TWO-PART)
2025-10-18 11:21:38,005 - utils.continuous_models - INFO - ============================================================
2025-10-18 11:21:38,005 - utils.continuous_models - INFO - 
1. SKIPPING MODEL (Logistic with Clustered SEs)
2025-10-18 11:21:38,106 - utils.continuous_models - INFO -   Formula: skipped ~ dyslexic_int * (word_length_scaled + word_frequency_zipf_scaled + surprisal_scaled)
2025-10-18 11:21:38,106 - utils.continuous_models - INFO -   Fitting on 326,496 words...
2025-10-18 11:21:38,859 - utils.continuous_models - INFO -   Model fitted successfully with clustered SEs
2025-10-18 11:21:38,860 - utils.continuous_models - INFO -     dyslexic_int:word_length_scaled: beta=-0.0250, p=0.6714
2025-10-18 11:21:38,860 - utils.continuous_models - INFO -     dyslexic_int:word_frequency_zipf_scaled: beta=-0.0640, p=0.1975
2025-10-18 11:21:38,860 - utils.continuous_models - INFO -     dyslexic_int:surprisal_scaled: beta=-0.0272, p=0.2667
2025-10-18 11:21:38,869 - utils.continuous_models - INFO - 
2. DURATION MODEL (Log-TRT | Fixated)
2025-10-18 11:21:38,997 - utils.continuous_models - INFO -   Formula: log_TRT ~ dyslexic_int * (word_length_scaled + word_frequency_zipf_scaled + surprisal_scaled)
2025-10-18 11:21:38,998 - utils.continuous_models - INFO -   Fitting on 204,224 fixated words...
2025-10-18 11:21:40,297 - utils.continuous_models - INFO -   Model fitted successfully
2025-10-18 11:21:40,297 - utils.continuous_models - INFO -   Smearing correction factor: 1.1562
2025-10-18 11:21:40,298 - utils.continuous_models - INFO -     dyslexic_int:word_length_scaled: beta=0.0078, p=0.0585
2025-10-18 11:21:40,298 - utils.continuous_models - INFO -     dyslexic_int:word_frequency_zipf_scaled: beta=-0.0084, p=0.0678
2025-10-18 11:21:40,299 - utils.continuous_models - INFO -     dyslexic_int:surprisal_scaled: beta=0.0349, p=0.0000
2025-10-18 11:21:40,308 - utils.continuous_models - INFO - 
3. PREDICTING EXPECTED ERT
2025-10-18 11:21:40,359 - utils.continuous_models - INFO -   Predicting expected ERT...
2025-10-18 11:21:40,576 - utils.continuous_models - INFO -   Predicted expected ERT for 326,496 words
2025-10-18 11:21:40,579 - utils.continuous_models - INFO -     Mean expected ERT: 228.71ms
2025-10-18 11:21:40,579 - utils.continuous_models - INFO -     Mean observed ERT: 236.03ms
2025-10-18 11:21:40,587 - utils.continuous_models - INFO - 
4. VARIANCE EXPLAINED (ÎRÂ² on Expected ERT)
2025-10-18 11:21:40,694 - utils.continuous_models - INFO -   Computing ÎRÂ² on 326,496 observations
2025-10-18 11:21:41,023 - utils.continuous_models - INFO -     M0: RÂ² = 0.2074
2025-10-18 11:21:41,385 - utils.continuous_models - INFO -     M1: RÂ² = 0.9267
2025-10-18 11:21:41,734 - utils.continuous_models - INFO -     M2: RÂ² = 0.9501
2025-10-18 11:21:42,114 - utils.continuous_models - INFO -     M3: RÂ² = 0.9608
2025-10-18 11:21:42,114 - utils.continuous_models - INFO - 
  Variance Explained (ÎRÂ²):
2025-10-18 11:21:42,115 - utils.continuous_models - INFO -     Length: ÎRÂ² = 0.7193 (71.93%)
2025-10-18 11:21:42,115 - utils.continuous_models - INFO -     Frequency: ÎRÂ² = 0.0233 (2.33%)
2025-10-18 11:21:42,115 - utils.continuous_models - INFO -     Surprisal: ÎRÂ² = 0.0107 (1.07%)
2025-10-18 11:21:42,140 - utils.continuous_models - INFO - 
5. MS SHIFTS (Q1âQ3 on Expected ERT)
2025-10-18 11:21:42,147 - utils.continuous_models - INFO - 
  word_length: Q1=2.00, Q3=6.00
2025-10-18 11:21:42,166 - utils.continuous_models - INFO -     Control: 136.3ms -> 220.5ms (Î = 84.1ms)
2025-10-18 11:21:42,187 - utils.continuous_models - INFO -     Dyslexic: 239.3ms -> 361.0ms (Î = 121.7ms)
2025-10-18 11:21:42,195 - utils.continuous_models - INFO - 
  word_frequency_zipf: Q1=4.91, Q3=7.10
2025-10-18 11:21:42,219 - utils.continuous_models - INFO -     Control: 209.3ms -> 167.5ms (Î = -41.8ms)
2025-10-18 11:21:42,239 - utils.continuous_models - INFO -     Dyslexic: 342.6ms -> 290.3ms (Î = -52.3ms)
2025-10-18 11:21:42,249 - utils.continuous_models - INFO - 
  surprisal: Q1=2.76, Q3=9.97
2025-10-18 11:21:42,268 - utils.continuous_models - INFO -     Control: 185.2ms -> 195.4ms (Î = 10.2ms)
2025-10-18 11:21:42,296 - utils.continuous_models - INFO -     Dyslexic: 300.9ms -> 334.1ms (Î = 33.3ms)
2025-10-18 11:21:42,296 - utils.continuous_models - INFO - 
6. SLOPE RATIOS (Finite Differences on Expected ERT)
2025-10-18 11:21:42,349 - utils.continuous_models - INFO -   word_length: SR = 1.447 (AMPLIFIED)
2025-10-18 11:21:42,388 - utils.continuous_models - INFO -   word_frequency_zipf: SR = 1.251 (AMPLIFIED)
2025-10-18 11:21:42,431 - utils.continuous_models - INFO -   surprisal: SR = 3.257 (AMPLIFIED)
2025-10-18 11:21:42,432 - utils.continuous_models - INFO - 
7. BOOTSTRAP CONFIDENCE INTERVALS
2025-10-18 11:21:42,432 - utils.continuous_models - INFO -   Computing bootstrap CIs (100 iterations)...
2025-10-18 11:22:05,458 - utils.gap_decomposition - INFO - ============================================================
2025-10-18 11:22:05,458 - utils.gap_decomposition - INFO - PART C: GAP DECOMPOSITION
2025-10-18 11:22:05,459 - utils.gap_decomposition - INFO - ============================================================
2025-10-18 11:22:05,558 - utils.gap_decomposition - INFO - Using common sample of 326,496 observations for all models
2025-10-18 11:22:05,559 - utils.gap_decomposition - INFO - 
Fitting M0 (main effects only)...
2025-10-18 11:22:05,559 - utils.gap_decomposition - INFO -   Formula: ERT_expected ~ dyslexic_int
2025-10-18 11:22:05,858 - utils.gap_decomposition - INFO -   M0 fitted successfully (OLS with clustered SEs)
2025-10-18 11:22:05,858 - utils.gap_decomposition - INFO - 
Fitting M1 (main effects only)...
2025-10-18 11:22:05,858 - utils.gap_decomposition - INFO -   Formula: ERT_expected ~ dyslexic_int + word_length_scaled
2025-10-18 11:22:06,168 - utils.gap_decomposition - INFO -   M1 fitted successfully (OLS with clustered SEs)
2025-10-18 11:22:06,169 - utils.gap_decomposition - INFO - 
Fitting M2 (main effects only)...
2025-10-18 11:22:06,169 - utils.gap_decomposition - INFO -   Formula: ERT_expected ~ dyslexic_int + word_length_scaled + word_frequency_zipf_scaled
2025-10-18 11:22:06,510 - utils.gap_decomposition - INFO -   M2 fitted successfully (OLS with clustered SEs)
2025-10-18 11:22:06,511 - utils.gap_decomposition - INFO - 
Fitting M3 (main effects only)...
2025-10-18 11:22:06,511 - utils.gap_decomposition - INFO -   Formula: ERT_expected ~ dyslexic_int + word_length_scaled + word_frequency_zipf_scaled + surprisal_scaled
2025-10-18 11:22:06,883 - utils.gap_decomposition - INFO -   M3 fitted successfully (OLS with clustered SEs)
2025-10-18 11:22:06,893 - utils.gap_decomposition - INFO - 
Computing counterfactual gaps...
2025-10-18 11:22:07,076 - utils.gap_decomposition - INFO -   M0: Gap = 133.03ms
2025-10-18 11:22:07,314 - utils.gap_decomposition - INFO -   M1: Gap = 132.03ms
2025-10-18 11:22:07,530 - utils.gap_decomposition - INFO -   M2: Gap = 132.16ms
2025-10-18 11:22:07,770 - utils.gap_decomposition - INFO -   M3: Gap = 132.02ms
2025-10-18 11:22:07,785 - utils.gap_decomposition - INFO - 
Computing RÂ²...
2025-10-18 11:22:07,795 - utils.gap_decomposition - INFO -   M0: RÂ² = 0.2074
2025-10-18 11:22:07,801 - utils.gap_decomposition - INFO -   M1: RÂ² = 0.9267
2025-10-18 11:22:07,809 - utils.gap_decomposition - INFO -   M2: RÂ² = 0.9501
2025-10-18 11:22:07,815 - utils.gap_decomposition - INFO -   M3: RÂ² = 0.9608
2025-10-18 11:22:07,815 - utils.gap_decomposition - INFO - 
Fitting interaction models (Oaxaca/Blinder decomposition)...
2025-10-18 11:22:07,918 - utils.gap_decomposition - INFO -   Fitting M1_int...
2025-10-18 11:22:08,248 - utils.gap_decomposition - INFO -     M1_int fitted successfully
2025-10-18 11:22:08,310 - utils.gap_decomposition - INFO -   Fitting M2_int...
2025-10-18 11:22:08,692 - utils.gap_decomposition - INFO -     M2_int fitted successfully
2025-10-18 11:22:08,768 - utils.gap_decomposition - INFO -   Fitting M3_int...
2025-10-18 11:22:09,232 - utils.gap_decomposition - INFO -     M3_int fitted successfully
2025-10-18 11:22:09,241 - utils.gap_decomposition - INFO - 
Oaxaca/Blinder Decomposition:
2025-10-18 11:22:10,247 - utils.gap_decomposition - INFO -   Baseline gap: 133.03ms
2025-10-18 11:22:10,248 - utils.gap_decomposition - INFO -   Composition effect: 1.00ms (0.8%)
2025-10-18 11:22:10,248 - utils.gap_decomposition - INFO -   Coefficient effect: -0.30ms (-0.2%)
2025-10-18 11:22:10,248 - utils.gap_decomposition - INFO -   Residual gap: 131.72ms
2025-10-18 11:22:10,330 - utils.gap_decomposition - INFO - 
GAP DECOMPOSITION SUMMARY:
2025-10-18 11:22:10,331 - utils.gap_decomposition - INFO -   Baseline gap (M0): 133.03ms
2025-10-18 11:22:10,331 - utils.gap_decomposition - INFO -   M1: Gap=132.03ms, Explained=0.7%, DeltaRÂ²=0.7193
2025-10-18 11:22:10,332 - utils.gap_decomposition - INFO -   M2: Gap=132.16ms, Explained=0.6%, DeltaRÂ²=0.0233
2025-10-18 11:22:10,332 - utils.gap_decomposition - INFO -   M3: Gap=132.02ms, Explained=0.8%, DeltaRÂ²=0.0107
2025-10-18 11:22:10,332 - utils.sensitivity_analysis - INFO - ============================================================
2025-10-18 11:22:10,332 - utils.sensitivity_analysis - INFO - SENSITIVITY ANALYSES
2025-10-18 11:22:10,332 - utils.sensitivity_analysis - INFO - ============================================================
2025-10-18 11:22:10,333 - utils.sensitivity_analysis - INFO - 
1. RESIDUALIZED SURPRISAL MODEL
2025-10-18 11:22:10,395 - utils.sensitivity_analysis - INFO -   Formula: ERT ~ dyslexic_int * (word_length_scaled + word_frequency_zipf_scaled + surprisal_resid)
2025-10-18 11:22:11,008 - utils.sensitivity_analysis - INFO -   Residualized surprisal: beta=11.6330, p=0.0000
2025-10-18 11:22:11,008 - utils.sensitivity_analysis - INFO -   [OK] Surprisal effect robust to frequency collinearity
2025-10-18 11:22:11,025 - utils.sensitivity_analysis - INFO - 
2. SUBJECT-WISE CROSS-VALIDATION
2025-10-18 11:22:11,025 - utils.sensitivity_analysis - INFO -   Running 10-fold subject-wise CV...
2025-10-18 11:22:11,250 - utils.sensitivity_analysis - INFO -     Fold 1/10
2025-10-18 11:22:11,805 - utils.sensitivity_analysis - INFO -     Fold 2/10
2025-10-18 11:22:12,515 - utils.sensitivity_analysis - INFO -     Fold 3/10
2025-10-18 11:22:13,092 - utils.sensitivity_analysis - INFO -     Fold 4/10
2025-10-18 11:22:13,637 - utils.sensitivity_analysis - INFO -     Fold 5/10
2025-10-18 11:22:14,173 - utils.sensitivity_analysis - INFO -     Fold 6/10
2025-10-18 11:22:15,266 - utils.sensitivity_analysis - INFO -     Fold 7/10
2025-10-18 11:22:15,838 - utils.sensitivity_analysis - INFO -     Fold 8/10
2025-10-18 11:22:16,354 - utils.sensitivity_analysis - INFO -     Fold 9/10
2025-10-18 11:22:16,884 - utils.sensitivity_analysis - INFO -     Fold 10/10
2025-10-18 11:22:17,417 - utils.sensitivity_analysis - INFO -   Cross-validation RÂ²: -0.3352 Â± 0.2999
2025-10-18 11:22:17,418 - utils.sensitivity_analysis - INFO -   Based on 10 successful folds
2025-10-18 11:22:17,460 - utils.sensitivity_analysis - INFO - 
3. ALTERNATIVE BINNING (Terciles & Quintiles)
2025-10-18 11:22:17,460 - utils.sensitivity_analysis - INFO - 
  Testing terciles...
2025-10-18 11:22:17,576 - utils.sensitivity_analysis - INFO -     word_length: Control Î=202.4ms, Dyslexic Î=304.4ms
2025-10-18 11:22:17,675 - utils.sensitivity_analysis - INFO -     word_frequency_zipf: Control Î=-187.4ms, Dyslexic Î=-283.4ms
2025-10-18 11:22:17,780 - utils.sensitivity_analysis - INFO -     surprisal: Control Î=112.9ms, Dyslexic Î=200.7ms
2025-10-18 11:22:17,780 - utils.sensitivity_analysis - INFO - 
  Testing quintiles...
2025-10-18 11:22:17,856 - utils.sensitivity_analysis - INFO -     word_length: Control Î=284.7ms, Dyslexic Î=452.5ms
2025-10-18 11:22:17,931 - utils.sensitivity_analysis - INFO -     word_frequency_zipf: Control Î=-242.1ms, Dyslexic Î=-393.1ms
2025-10-18 11:22:18,013 - utils.sensitivity_analysis - INFO -     surprisal: Control Î=150.5ms, Dyslexic Î=270.2ms
2025-10-18 11:22:18,020 - utils.hypothesis_visualization - INFO - ============================================================
2025-10-18 11:22:18,020 - utils.hypothesis_visualization - INFO - CREATING VISUALIZATIONS
2025-10-18 11:22:18,020 - utils.hypothesis_visualization - INFO - ============================================================
2025-10-18 11:22:18,020 - utils.hypothesis_visualization - INFO - 
1. Continuous effect curves...
2025-10-18 11:22:19,240 - utils.hypothesis_visualization - INFO -   Saved to results\continuous_effects_with_quartiles.png
2025-10-18 11:22:19,242 - utils.hypothesis_visualization - INFO - 2. Gap decomposition...
2025-10-18 11:22:19,546 - utils.hypothesis_visualization - INFO -   Saved to results\gap_decomposition.png
2025-10-18 11:22:19,546 - utils.hypothesis_visualization - INFO - 3. Slope ratios...
2025-10-18 11:22:19,848 - utils.hypothesis_visualization - INFO -   Saved to results\slope_ratios.png
2025-10-18 11:22:19,850 - utils.hypothesis_visualization - INFO - 4. Model comparison...
2025-10-18 11:22:19,862 - matplotlib.category - INFO - Using categorical units to plot a list of strings that are all parsable as floats or dates. If these strings should be plotted as numbers, cast to the appropriate data type before plotting.
2025-10-18 11:22:19,863 - matplotlib.category - INFO - Using categorical units to plot a list of strings that are all parsable as floats or dates. If these strings should be plotted as numbers, cast to the appropriate data type before plotting.
2025-10-18 11:22:20,244 - utils.hypothesis_visualization - INFO -   Saved to results\model_comparison.png
2025-10-18 11:22:20,244 - utils.hypothesis_visualization - INFO - 5. Quartile effects...
2025-10-18 11:22:20,855 - utils.hypothesis_visualization - INFO -   Saved to results\quartile_effects.png
2025-10-18 11:22:20,856 - utils.hypothesis_visualization - INFO - 6. Predicted vs observed...
2025-10-18 11:22:21,754 - utils.hypothesis_visualization - INFO -   Saved to results\predicted_vs_observed.png
2025-10-18 11:22:21,755 - utils.hypothesis_visualization - INFO - 
All visualizations saved to results
2025-10-18 11:22:21,755 - utils.results_reporting - INFO - ============================================================
2025-10-18 11:22:21,755 - utils.results_reporting - INFO - GENERATING RESULTS REPORT
2025-10-18 11:22:21,755 - utils.results_reporting - INFO - ============================================================
2025-10-18 11:22:21,758 - utils.results_reporting - INFO - 
Testing Hypothesis 1: Feature effects on reading time
2025-10-18 11:22:21,758 - utils.results_reporting - INFO -   Length: beta=0.1222, p=0.0000 - CONFIRMED
2025-10-18 11:22:21,759 - utils.results_reporting - INFO -   Frequency: beta=-0.0486, p=0.0000 - CONFIRMED
2025-10-18 11:22:21,759 - utils.results_reporting - INFO -   Surprisal: beta=0.0317, p=0.0000 - CONFIRMED
2025-10-18 11:22:21,759 - utils.results_reporting - INFO - 
Hypothesis 1: CONFIRMED
2025-10-18 11:22:21,759 - utils.results_reporting - INFO - 
Testing Hypothesis 2: Dyslexic amplification
2025-10-18 11:22:21,759 - utils.results_reporting - INFO - 
Hypothesis 2: CONFIRMED
2025-10-18 11:22:21,759 - utils.results_reporting - INFO - 
Testing Hypothesis 3: Gap explanation
2025-10-18 11:22:21,759 - utils.results_reporting - INFO -   Baseline gap: 133.03ms
2025-10-18 11:22:21,759 - utils.results_reporting - INFO -   Final gap: 132.02ms
2025-10-18 11:22:21,759 - utils.results_reporting - INFO -   Total explained: 0.8%
2025-10-18 11:22:21,761 - utils.results_reporting - INFO -     Length: 0.7%
2025-10-18 11:22:21,761 - utils.results_reporting - INFO -     Frequency: -0.1%
2025-10-18 11:22:21,761 - utils.results_reporting - INFO -     Surprisal: 0.1%
2025-10-18 11:22:21,761 - utils.results_reporting - INFO - 
Hypothesis 3: NOT CONFIRMED
2025-10-18 11:22:21,762 - utils.results_reporting - INFO - 
================================================================================
2025-10-18 11:22:21,762 - utils.results_reporting - INFO - HYPOTHESIS TESTING RESULTS SUMMARY
2025-10-18 11:22:21,762 - utils.results_reporting - INFO - ================================================================================
2025-10-18 11:22:21,762 - utils.results_reporting - INFO - 
HYPOTHESIS 1: CONFIRMED
2025-10-18 11:22:21,762 - utils.results_reporting - INFO -   All features predict reading time in expected directions
2025-10-18 11:22:21,762 - utils.results_reporting - INFO - 
HYPOTHESIS 2: CONFIRMED
2025-10-18 11:22:21,763 - utils.results_reporting - INFO -   All features show dyslexic amplification (SR > 1)
2025-10-18 11:22:21,763 - utils.results_reporting - INFO - 
HYPOTHESIS 3: NOT CONFIRMED
2025-10-18 11:22:21,763 - utils.results_reporting - INFO -   Features explain 0.8% of the dyslexic-control gap
2025-10-18 11:22:21,763 - utils.results_reporting - INFO - 
OVERALL: MIXED RESULTS
2025-10-18 11:22:21,763 - utils.results_reporting - INFO - 
Key Findings:
2025-10-18 11:22:21,763 - utils.results_reporting - INFO -   â¢ 3/3 features show dyslexic amplification
2025-10-18 11:22:21,763 - utils.results_reporting - INFO -   â¢ Features explain 0.8% of group gap
2025-10-18 11:22:21,763 - utils.results_reporting - INFO -   â¢ Effects consistent across multiple analyses
2025-10-18 11:22:21,764 - utils.results_reporting - INFO - Report generation complete
2025-10-18 11:22:21,765 - utils.misc_utils - ERROR - Failed to save results to results\hypothesis_testing_results.json: Object of type bool is not JSON serializable
2025-10-18 11:22:21,766 - __main__ - INFO - 
Hypothesis testing complete! Results saved to results
2025-10-18 11:28:07,732 - __main__ - INFO - Exiting...
2025-10-18 11:28:07,732 - __main__ - INFO - Analysis complete!
2025-10-18 11:33:11,749 - __main__ - INFO - Dyslexia Time Analysis Pipeline initialized
2025-10-18 11:33:11,750 - __main__ - INFO - Dyslexia Time Analysis Pipeline initialized
2025-10-18 11:33:28,587 - __main__ - INFO - Running hypothesis testing analysis...
2025-10-18 11:33:28,588 - __main__ - INFO - ================================================================================
2025-10-18 11:33:28,588 - __main__ - INFO - HYPOTHESIS TESTING ANALYSIS
2025-10-18 11:33:28,588 - __main__ - INFO - ================================================================================
2025-10-18 11:33:28,588 - __main__ - INFO - Loading CopCo dataset...
2025-10-18 11:33:28,589 - utils.data_utils - INFO - Loading 57 participant files...
2025-10-18 11:33:30,248 - utils.data_utils - INFO - Starting with 335,203 total word entries
2025-10-18 11:33:30,406 - utils.data_utils - INFO - Word fixation patterns:
2025-10-18 11:33:30,407 - utils.data_utils - INFO -   - Skipped words (0 fixations): 126,302
2025-10-18 11:33:30,407 - utils.data_utils - INFO -   - Fixated words (1+ fixations): 208,901
2025-10-18 11:33:30,407 - utils.data_utils - INFO -   - Unknown fixations (NaN): 0
2025-10-18 11:33:30,435 - utils.data_utils - INFO - Fixated words reading times: median 272ms, 99th percentile 1777ms
2025-10-18 11:33:30,438 - utils.data_utils - INFO - Removed 14 fixated words with extreme reading times (0 too short, 14 too long)
2025-10-18 11:33:30,536 - utils.data_utils - INFO - Removed 23 words longer than 30 characters (likely data errors)
2025-10-18 11:33:30,572 - utils.data_utils - INFO - Final dataset: 126,302 skipped words, 208,864 fixated words
2025-10-18 11:33:30,572 - utils.data_utils - INFO - Data cleaning complete: 335,166 words retained (100.0% of original)
2025-10-18 11:33:30,580 - utils.data_utils - INFO - Groups identified: 19 dyslexic, 39 control
2025-10-18 11:33:30,648 - __main__ - INFO - Calculating skipping probabilities...
2025-10-18 11:33:30,652 - utils.skipping_utils - INFO - Skipping analysis from ExtractedFeatures:
2025-10-18 11:33:30,652 - utils.skipping_utils - INFO -   Total words: 335,166
2025-10-18 11:33:30,652 - utils.skipping_utils - INFO -   Skipped: 126,302 (37.7%)
2025-10-18 11:33:30,652 - utils.skipping_utils - INFO -   Fixated: 208,864 (62.3%)
2025-10-18 11:33:30,691 - __main__ - INFO - Skipping analysis: 37.7% overall rate
2025-10-18 11:33:30,705 - __main__ - INFO - Loaded: 335,166 words from 57 participants
2025-10-18 11:33:30,705 - __main__ - INFO - ============================================================
2025-10-18 11:33:30,705 - __main__ - INFO - COMPUTING LINGUISTIC FEATURES
2025-10-18 11:33:30,707 - __main__ - INFO - ============================================================
2025-10-18 11:33:30,707 - utils.linguistic_features - INFO - Loading Danish frequency list from danish_frequencies\danish_leipzig_for_analysis.txt
2025-10-18 11:33:32,020 - utils.linguistic_features - WARNING - Found 2 duplicate words after lowercasing. 
2025-10-18 11:33:32,374 - utils.linguistic_features - INFO - Loaded 1,499,999 word proportions from Leipzig Corpora
2025-10-18 11:33:32,431 - utils.linguistic_features - INFO - Computing word frequency...
2025-10-18 11:33:32,432 - utils.linguistic_features - INFO -   Stripping punctuation from words before frequency lookup
2025-10-18 11:33:33,080 - utils.linguistic_features - INFO - 13 missing word instances were punctuation-only
2025-10-18 11:33:33,080 - utils.linguistic_features - WARNING - 4,586 word instances (1.4%) not found in frequency list (197 unique valid words)
2025-10-18 11:33:33,080 - utils.linguistic_features - INFO - Sample of 197 missing valid words: ['2. (margrethe', 'abilifyer', 'abrams efter', 'adunyadet', 'blintzes', 'broderet messehagler og', 'bygnings-konstruktioner', 'cÃ¸libatÃ¦gteskabet', 'efter star', 'emancipationskravet', 'en klase med', 'frederiksavn', 'frejakult', 'havstrategidirektivets', 'havtema', 'hejre (bromus', 'heksejagte', 'i grÃ¦s-familien', 'i star', 'ingrid, danmarks', 'intersex-inkluderende', 'jedi (2017', 'lgbtqi-diskrimination', 'livsresultat', 'midsommeraftner', 'minervafester', 'nabofolkeslag', 'naturlovgivning', 'nyreligiÃ¸st', 'pÃ¥ p', 'regnvandsbidrag', 'selvetablerede', 'skraldepigerne', 'skywalker ogsÃ¥', 'slomo', 'som star', 'spÃ¡kona', 'stress-sygdomme', 'stÃ¦rk lup', 'tilran', 'tscherning (1817-1890', 'tusindÃ¥rsfornemmelser', 'udstillingsparate', 'vindmÃ¸lle-testanlÃ¦gget', 'vindmÃ¸llehoveder', 'vk-Ã¥nden', 'wadup', 'Ã¥bningsriffet', 'Ã¥rstidshjulet', 'Ã¦ttesamfund']... (147 more)
2025-10-18 11:33:33,086 - utils.linguistic_features - INFO - Excluding 4,599 word instances (1.4%) with missing frequencies from analysis
2025-10-18 11:33:33,172 - utils.linguistic_features - INFO - Remaining dataset: 330,567 words
2025-10-18 11:33:33,173 - utils.linguistic_features - INFO - Final dataset: 330,567 words with valid frequencies
2025-10-18 11:33:36,900 - utils.linguistic_features - INFO - Loading causal language model: KennethTM/gpt2-medium-danish
2025-10-18 11:33:38,441 - utils.linguistic_features - INFO - Using CPU for surprisal computation
2025-10-18 11:33:38,441 - utils.linguistic_features - INFO - Causal language model loaded successfully
2025-10-18 11:33:38,441 - utils.linguistic_features - INFO - Computing surprisal with causal GPT-2 (left-to-right)...
2025-10-18 11:33:39,687 - utils.linguistic_features - INFO - Dataset statistics:
2025-10-18 11:33:39,688 - utils.linguistic_features - INFO -   Total participant-sentence instances: 20,707
2025-10-18 11:33:39,688 - utils.linguistic_features - INFO -   Unique sentence texts: 1,986
2025-10-18 11:33:39,688 - utils.linguistic_features - INFO -   Average participants per sentence: 10.4
2025-10-18 11:33:39,688 - utils.linguistic_features - INFO - Loading cached surprisal values from word_surprisal\surprisal_cache_gpt2.pkl
2025-10-18 11:33:39,699 - utils.linguistic_features - INFO - Loaded surprisal for 1,986 unique sentences
2025-10-18 11:33:39,699 - utils.linguistic_features - INFO - Broadcasting surprisal values to all participant instances...
2025-10-18 11:33:39,700 - utils.linguistic_features - INFO -   Mapping surprisal to words...
2025-10-18 11:33:42,840 - utils.linguistic_features - INFO -   Mapped 326,496 words
2025-10-18 11:33:42,842 - utils.linguistic_features - INFO - 
Surprisal Computation Results:
2025-10-18 11:33:42,842 - utils.linguistic_features - INFO -   Unique sentences processed: 1,986
2025-10-18 11:33:42,842 - utils.linguistic_features - INFO -   Total words with surprisal: 326,496 / 330,567
2025-10-18 11:33:42,843 - utils.linguistic_features - INFO -   Mean: 6.93 bits
2025-10-18 11:33:42,846 - utils.linguistic_features - INFO -   Median: 5.69 bits
2025-10-18 11:33:42,848 - utils.linguistic_features - INFO -   Std: 5.55 bits
2025-10-18 11:33:42,848 - utils.linguistic_features - INFO -   Range: [0.00, 59.34] bits
2025-10-18 11:33:42,864 - utils.linguistic_features - INFO - Linguistic features added successfully
2025-10-18 11:33:42,864 - utils.linguistic_features - INFO - 
Feature Summary:
2025-10-18 11:33:42,865 - utils.linguistic_features - INFO -   Word length: mean=4.67, std=3.08
2025-10-18 11:33:42,868 - utils.linguistic_features - INFO -   Zipf frequency: mean=5.85, std=1.38, range=[0.91, 7.51]
2025-10-18 11:33:42,870 - utils.linguistic_features - INFO -   Surprisal: mean=6.93, std=5.55
2025-10-18 11:33:42,878 - utils.hypothesis_testing_utils - INFO - Preparing data for hypothesis testing...
2025-10-18 11:33:42,915 - utils.hypothesis_testing_utils - INFO - Creating ERT variable...
2025-10-18 11:33:42,918 - utils.hypothesis_testing_utils - INFO -   ERT created: 123,666 skipped (0ms), 206,901 fixated
2025-10-18 11:33:42,918 - utils.hypothesis_testing_utils - INFO - Centering and scaling predictors...
2025-10-18 11:33:42,931 - utils.hypothesis_testing_utils - INFO -   word_length: mean=4.67, scale=3.08
2025-10-18 11:33:42,945 - utils.hypothesis_testing_utils - INFO -   word_frequency_zipf: mean=5.85, scale=1.38
2025-10-18 11:33:42,958 - utils.hypothesis_testing_utils - INFO -   surprisal: mean=6.93, scale=5.55
2025-10-18 11:33:42,959 - utils.hypothesis_testing_utils - INFO - Checking collinearity (VIF)...
2025-10-18 11:33:43,036 - utils.hypothesis_testing_utils - INFO - VIF Results:
2025-10-18 11:33:43,036 - utils.hypothesis_testing_utils - INFO -   Length: 2.82 (OK)
2025-10-18 11:33:43,037 - utils.hypothesis_testing_utils - INFO -   Frequency: 3.18 (OK)
2025-10-18 11:33:43,037 - utils.hypothesis_testing_utils - INFO -   Surprisal: 1.41 (OK)
2025-10-18 11:33:43,038 - utils.hypothesis_testing_utils - INFO - Creating residualized surprisal...
2025-10-18 11:33:43,050 - utils.hypothesis_testing_utils - INFO -   Correlation (Frequency-Surprisal): r=-0.539
2025-10-18 11:33:43,050 - utils.hypothesis_testing_utils - INFO -   Residualized surprisal created
2025-10-18 11:33:43,050 - utils.hypothesis_testing_utils - INFO - Defining pooled quartiles...
2025-10-18 11:33:43,062 - utils.hypothesis_testing_utils - INFO -   word_length: Q1=2.00, Q3=6.00
2025-10-18 11:33:43,073 - utils.hypothesis_testing_utils - INFO -   word_frequency_zipf: Q1=4.91, Q3=7.10
2025-10-18 11:33:43,086 - utils.hypothesis_testing_utils - INFO -   surprisal: Q1=2.76, Q3=9.97
2025-10-18 11:33:43,087 - utils.hypothesis_testing_utils - INFO - Data preparation complete: 330,567 words ready for analysis
2025-10-18 11:33:43,095 - utils.quartile_analysis - INFO - ============================================================
2025-10-18 11:33:43,095 - utils.quartile_analysis - INFO - PART A: QUARTILE ANALYSIS (Q1 vs Q3)
2025-10-18 11:33:43,096 - utils.quartile_analysis - INFO - ============================================================
2025-10-18 11:33:43,096 - utils.quartile_analysis - INFO - 
Analyzing word_length...
2025-10-18 11:33:43,909 - utils.quartile_analysis - INFO -   Computed means for 57 participants
2025-10-18 11:33:43,910 - utils.quartile_analysis - INFO -     Control Q3-Q1: 259.7ms
2025-10-18 11:33:43,910 - utils.quartile_analysis - INFO -     Dyslexic Q3-Q1: 442.6ms
2025-10-18 11:33:43,968 - utils.quartile_analysis - INFO -   Fitting mixed model on 152,465 words...
2025-10-18 11:33:44,616 - utils.quartile_analysis - INFO -   GroupÃBin interaction: beta=134.79, p=0.0000
2025-10-18 11:33:44,647 - utils.quartile_analysis - INFO -   Computing bootstrap CIs (1000 iterations)...
2025-10-18 11:33:46,326 - utils.quartile_analysis - INFO -   Bootstrap 95% CI for interaction: [98.47, 259.71]
2025-10-18 11:33:46,327 - utils.quartile_analysis - INFO - 
Analyzing word_frequency_zipf...
2025-10-18 11:33:47,114 - utils.quartile_analysis - INFO -   Computed means for 57 participants
2025-10-18 11:33:47,115 - utils.quartile_analysis - INFO -     Control Q3-Q1: -225.9ms
2025-10-18 11:33:47,115 - utils.quartile_analysis - INFO -     Dyslexic Q3-Q1: -388.2ms
2025-10-18 11:33:47,178 - utils.quartile_analysis - INFO -   Fitting mixed model on 162,606 words...
2025-10-18 11:33:50,016 - utils.quartile_analysis - INFO -   GroupÃBin interaction: beta=-122.40, p=0.0000
2025-10-18 11:33:50,042 - utils.quartile_analysis - INFO -   Computing bootstrap CIs (1000 iterations)...
2025-10-18 11:33:51,809 - utils.quartile_analysis - INFO -   Bootstrap 95% CI for interaction: [-225.59, -87.90]
2025-10-18 11:33:51,809 - utils.quartile_analysis - INFO - 
Analyzing surprisal...
2025-10-18 11:33:52,626 - utils.quartile_analysis - INFO -   Computed means for 57 participants
2025-10-18 11:33:52,627 - utils.quartile_analysis - INFO -     Control Q3-Q1: 135.8ms
2025-10-18 11:33:52,628 - utils.quartile_analysis - INFO -     Dyslexic Q3-Q1: 277.3ms
2025-10-18 11:33:52,691 - utils.quartile_analysis - INFO -   Fitting mixed model on 163,257 words...
2025-10-18 11:33:55,405 - utils.quartile_analysis - INFO -   GroupÃBin interaction: beta=105.53, p=0.0000
2025-10-18 11:33:55,437 - utils.quartile_analysis - INFO -   Computing bootstrap CIs (1000 iterations)...
2025-10-18 11:33:57,138 - utils.quartile_analysis - INFO -   Bootstrap 95% CI for interaction: [84.99, 194.82]
2025-10-18 11:33:57,139 - utils.continuous_models - INFO - ============================================================
2025-10-18 11:33:57,139 - utils.continuous_models - INFO - PART B: CONTINUOUS MODELS (TWO-PART)
2025-10-18 11:33:57,139 - utils.continuous_models - INFO - ============================================================
2025-10-18 11:33:57,139 - utils.continuous_models - INFO - 
1. SKIPPING MODEL (Logistic with Clustered SEs)
2025-10-18 11:33:57,242 - utils.continuous_models - INFO -   Formula: skipped ~ dyslexic_int * (word_length_scaled + word_frequency_zipf_scaled + surprisal_scaled)
2025-10-18 11:33:57,242 - utils.continuous_models - INFO -   Fitting on 326,496 words...
2025-10-18 11:33:57,973 - utils.continuous_models - INFO -   Model fitted successfully with clustered SEs
2025-10-18 11:33:57,975 - utils.continuous_models - INFO -     dyslexic_int:word_length_scaled: beta=-0.0250, p=0.6714
2025-10-18 11:33:57,975 - utils.continuous_models - INFO -     dyslexic_int:word_frequency_zipf_scaled: beta=-0.0640, p=0.1975
2025-10-18 11:33:57,975 - utils.continuous_models - INFO -     dyslexic_int:surprisal_scaled: beta=-0.0272, p=0.2667
2025-10-18 11:33:57,985 - utils.continuous_models - INFO - 
2. DURATION MODEL (Log-TRT | Fixated)
2025-10-18 11:33:58,107 - utils.continuous_models - INFO -   Formula: log_TRT ~ dyslexic_int * (word_length_scaled + word_frequency_zipf_scaled + surprisal_scaled)
2025-10-18 11:33:58,107 - utils.continuous_models - INFO -   Fitting on 204,224 fixated words...
2025-10-18 11:33:59,124 - utils.continuous_models - INFO -   Model fitted successfully
2025-10-18 11:33:59,125 - utils.continuous_models - INFO -   Smearing correction factor: 1.1562
2025-10-18 11:33:59,125 - utils.continuous_models - INFO -     dyslexic_int:word_length_scaled: beta=0.0078, p=0.0585
2025-10-18 11:33:59,126 - utils.continuous_models - INFO -     dyslexic_int:word_frequency_zipf_scaled: beta=-0.0084, p=0.0678
2025-10-18 11:33:59,126 - utils.continuous_models - INFO -     dyslexic_int:surprisal_scaled: beta=0.0349, p=0.0000
2025-10-18 11:33:59,132 - utils.continuous_models - INFO - 
3. PREDICTING EXPECTED ERT
2025-10-18 11:33:59,177 - utils.continuous_models - INFO -   Predicting expected ERT...
2025-10-18 11:33:59,409 - utils.continuous_models - INFO -   Predicted expected ERT for 326,496 words
2025-10-18 11:33:59,411 - utils.continuous_models - INFO -     Mean expected ERT: 228.71ms
2025-10-18 11:33:59,412 - utils.continuous_models - INFO -     Mean observed ERT: 236.03ms
2025-10-18 11:33:59,421 - utils.continuous_models - INFO - 
4. VARIANCE EXPLAINED (ÎRÂ² on Expected ERT)
2025-10-18 11:33:59,525 - utils.continuous_models - INFO -   Computing ÎRÂ² on 326,496 observations
2025-10-18 11:33:59,838 - utils.continuous_models - INFO -     M0: RÂ² = 0.2074
2025-10-18 11:34:00,169 - utils.continuous_models - INFO -     M1: RÂ² = 0.9267
2025-10-18 11:34:00,542 - utils.continuous_models - INFO -     M2: RÂ² = 0.9501
2025-10-18 11:34:00,920 - utils.continuous_models - INFO -     M3: RÂ² = 0.9608
2025-10-18 11:34:00,920 - utils.continuous_models - INFO - 
  Variance Explained (ÎRÂ²):
2025-10-18 11:34:00,921 - utils.continuous_models - INFO -     Length: ÎRÂ² = 0.7193 (71.93%)
2025-10-18 11:34:00,921 - utils.continuous_models - INFO -     Frequency: ÎRÂ² = 0.0233 (2.33%)
2025-10-18 11:34:00,921 - utils.continuous_models - INFO -     Surprisal: ÎRÂ² = 0.0107 (1.07%)
2025-10-18 11:34:00,946 - utils.continuous_models - INFO - 
5. MS SHIFTS (Q1âQ3 on Expected ERT)
2025-10-18 11:34:00,953 - utils.continuous_models - INFO - 
  word_length: Q1=2.00, Q3=6.00
2025-10-18 11:34:00,975 - utils.continuous_models - INFO -     Control: 136.3ms -> 220.5ms (Î = 84.1ms)
2025-10-18 11:34:00,994 - utils.continuous_models - INFO -     Dyslexic: 239.3ms -> 361.0ms (Î = 121.7ms)
2025-10-18 11:34:01,003 - utils.continuous_models - INFO - 
  word_frequency_zipf: Q1=4.91, Q3=7.10
2025-10-18 11:34:01,026 - utils.continuous_models - INFO -     Control: 209.3ms -> 167.5ms (Î = -41.8ms)
2025-10-18 11:34:01,046 - utils.continuous_models - INFO -     Dyslexic: 342.6ms -> 290.3ms (Î = -52.3ms)
2025-10-18 11:34:01,055 - utils.continuous_models - INFO - 
  surprisal: Q1=2.76, Q3=9.97
2025-10-18 11:34:01,075 - utils.continuous_models - INFO -     Control: 185.2ms -> 195.4ms (Î = 10.2ms)
2025-10-18 11:34:01,093 - utils.continuous_models - INFO -     Dyslexic: 300.9ms -> 334.1ms (Î = 33.3ms)
2025-10-18 11:34:01,094 - utils.continuous_models - INFO - 
6. SLOPE RATIOS (Finite Differences on Expected ERT)
2025-10-18 11:34:01,135 - utils.continuous_models - INFO -   word_length: SR = 1.447 (AMPLIFIED)
2025-10-18 11:34:01,176 - utils.continuous_models - INFO -   word_frequency_zipf: SR = 1.251 (AMPLIFIED)
2025-10-18 11:34:01,217 - utils.continuous_models - INFO -   surprisal: SR = 3.257 (AMPLIFIED)
2025-10-18 11:34:01,218 - utils.continuous_models - INFO - 
7. BOOTSTRAP CONFIDENCE INTERVALS
2025-10-18 11:34:01,218 - utils.continuous_models - INFO -   Computing bootstrap CIs (100 iterations)...
2025-10-18 11:34:23,700 - utils.gap_decomposition - INFO - ============================================================
2025-10-18 11:34:23,701 - utils.gap_decomposition - INFO - PART C: GAP DECOMPOSITION
2025-10-18 11:34:23,701 - utils.gap_decomposition - INFO - ============================================================
2025-10-18 11:34:23,808 - utils.gap_decomposition - INFO - Using common sample of 326,496 observations for all models
2025-10-18 11:34:23,809 - utils.gap_decomposition - INFO - 
Fitting M0 (main effects only)...
2025-10-18 11:34:23,809 - utils.gap_decomposition - INFO -   Formula: ERT_expected ~ dyslexic_int
2025-10-18 11:34:24,138 - utils.gap_decomposition - INFO -   M0 fitted successfully (OLS with clustered SEs)
2025-10-18 11:34:24,138 - utils.gap_decomposition - INFO - 
Fitting M1 (main effects only)...
2025-10-18 11:34:24,138 - utils.gap_decomposition - INFO -   Formula: ERT_expected ~ dyslexic_int + word_length_scaled
2025-10-18 11:34:24,457 - utils.gap_decomposition - INFO -   M1 fitted successfully (OLS with clustered SEs)
2025-10-18 11:34:24,457 - utils.gap_decomposition - INFO - 
Fitting M2 (main effects only)...
2025-10-18 11:34:24,457 - utils.gap_decomposition - INFO -   Formula: ERT_expected ~ dyslexic_int + word_length_scaled + word_frequency_zipf_scaled
2025-10-18 11:34:24,771 - utils.gap_decomposition - INFO -   M2 fitted successfully (OLS with clustered SEs)
2025-10-18 11:34:24,772 - utils.gap_decomposition - INFO - 
Fitting M3 (main effects only)...
2025-10-18 11:34:24,772 - utils.gap_decomposition - INFO -   Formula: ERT_expected ~ dyslexic_int + word_length_scaled + word_frequency_zipf_scaled + surprisal_scaled
2025-10-18 11:34:25,114 - utils.gap_decomposition - INFO -   M3 fitted successfully (OLS with clustered SEs)
2025-10-18 11:34:25,124 - utils.gap_decomposition - INFO - 
Computing composition-based gaps (covariate differences)...
2025-10-18 11:34:25,324 - utils.gap_decomposition - INFO -   M0: Composition gap = -0.00ms
2025-10-18 11:34:25,324 - utils.gap_decomposition - INFO -     (Dyslexics at control slopes: 196.11ms, Controls: 196.11ms)
2025-10-18 11:34:25,537 - utils.gap_decomposition - INFO -   M1: Composition gap = 1.00ms
2025-10-18 11:34:25,537 - utils.gap_decomposition - INFO -     (Dyslexics at control slopes: 197.11ms, Controls: 196.11ms)
2025-10-18 11:34:25,756 - utils.gap_decomposition - INFO -   M2: Composition gap = 0.86ms
2025-10-18 11:34:25,757 - utils.gap_decomposition - INFO -     (Dyslexics at control slopes: 196.97ms, Controls: 196.11ms)
2025-10-18 11:34:25,965 - utils.gap_decomposition - INFO -   M3: Composition gap = 1.00ms
2025-10-18 11:34:25,965 - utils.gap_decomposition - INFO -     (Dyslexics at control slopes: 197.12ms, Controls: 196.11ms)
2025-10-18 11:34:25,988 - utils.gap_decomposition - INFO - 
Computing RÂ²...
2025-10-18 11:34:25,998 - utils.gap_decomposition - INFO -   M0: RÂ² = 0.2074
2025-10-18 11:34:26,007 - utils.gap_decomposition - INFO -   M1: RÂ² = 0.9267
2025-10-18 11:34:26,014 - utils.gap_decomposition - INFO -   M2: RÂ² = 0.9501
2025-10-18 11:34:26,023 - utils.gap_decomposition - INFO -   M3: RÂ² = 0.9608
2025-10-18 11:34:26,024 - utils.gap_decomposition - INFO - 
Fitting interaction models (Oaxaca/Blinder decomposition)...
2025-10-18 11:34:26,127 - utils.gap_decomposition - INFO -   Fitting M1_int...
2025-10-18 11:34:26,456 - utils.gap_decomposition - INFO -     M1_int fitted successfully
2025-10-18 11:34:26,517 - utils.gap_decomposition - INFO -   Fitting M2_int...
2025-10-18 11:34:26,919 - utils.gap_decomposition - INFO -     M2_int fitted successfully
2025-10-18 11:34:26,991 - utils.gap_decomposition - INFO -   Fitting M3_int...
2025-10-18 11:34:27,418 - utils.gap_decomposition - INFO -     M3_int fitted successfully
2025-10-18 11:34:27,427 - utils.gap_decomposition - INFO - 
Oaxaca/Blinder Decomposition:
2025-10-18 11:34:28,031 - utils.gap_decomposition - INFO -   Observed gap: 133.03ms
2025-10-18 11:34:28,031 - utils.gap_decomposition - INFO -   Composition effect: 1.00ms (0.8%)
2025-10-18 11:34:28,032 - utils.gap_decomposition - INFO -   Coefficient effect: 131.72ms (99.0%)
2025-10-18 11:34:28,032 - utils.gap_decomposition - INFO -   Residual: 0.30ms
2025-10-18 11:34:28,097 - utils.gap_decomposition - INFO - 
GAP DECOMPOSITION SUMMARY:
2025-10-18 11:34:28,097 - utils.gap_decomposition - INFO -   Baseline gap (M0): -0.00ms
2025-10-18 11:34:28,097 - utils.gap_decomposition - INFO -   M1: Gap=1.00ms, Explained=701953385026500.0%, DeltaRÂ²=0.7193
2025-10-18 11:34:28,098 - utils.gap_decomposition - INFO -   M2: Gap=0.86ms, Explained=606090486522660.0%, DeltaRÂ²=0.0233
2025-10-18 11:34:28,098 - utils.gap_decomposition - INFO -   M3: Gap=1.00ms, Explained=706635269263100.0%, DeltaRÂ²=0.0107
2025-10-18 11:34:28,098 - utils.sensitivity_analysis - INFO - ============================================================
2025-10-18 11:34:28,098 - utils.sensitivity_analysis - INFO - SENSITIVITY ANALYSES
2025-10-18 11:34:28,098 - utils.sensitivity_analysis - INFO - ============================================================
2025-10-18 11:34:28,098 - utils.sensitivity_analysis - INFO - 
1. RESIDUALIZED SURPRISAL MODEL
2025-10-18 11:34:28,154 - utils.sensitivity_analysis - INFO -   Formula: ERT ~ dyslexic_int * (word_length_scaled + word_frequency_zipf_scaled + surprisal_resid)
2025-10-18 11:34:28,672 - utils.sensitivity_analysis - INFO -   Residualized surprisal: beta=11.6330, p=0.0000
2025-10-18 11:34:28,673 - utils.sensitivity_analysis - INFO -   [OK] Surprisal effect robust to frequency collinearity
2025-10-18 11:34:28,685 - utils.sensitivity_analysis - INFO - 
2. SUBJECT-WISE CROSS-VALIDATION
2025-10-18 11:34:28,686 - utils.sensitivity_analysis - INFO -   Running 10-fold subject-wise CV...
2025-10-18 11:34:28,876 - utils.sensitivity_analysis - INFO -     Fold 1/10
2025-10-18 11:34:29,411 - utils.sensitivity_analysis - INFO -     Fold 2/10
2025-10-18 11:34:30,003 - utils.sensitivity_analysis - INFO -     Fold 3/10
2025-10-18 11:34:30,642 - utils.sensitivity_analysis - INFO -     Fold 4/10
2025-10-18 11:34:31,271 - utils.sensitivity_analysis - INFO -     Fold 5/10
2025-10-18 11:34:31,948 - utils.sensitivity_analysis - INFO -     Fold 6/10
2025-10-18 11:34:33,085 - utils.sensitivity_analysis - INFO -     Fold 7/10
2025-10-18 11:34:33,666 - utils.sensitivity_analysis - INFO -     Fold 8/10
2025-10-18 11:34:34,305 - utils.sensitivity_analysis - INFO -     Fold 9/10
2025-10-18 11:34:34,880 - utils.sensitivity_analysis - INFO -     Fold 10/10
2025-10-18 11:34:35,523 - utils.sensitivity_analysis - INFO -   Cross-validation RÂ²: -0.3352 Â± 0.2999
2025-10-18 11:34:35,523 - utils.sensitivity_analysis - INFO -   Based on 10 successful folds
2025-10-18 11:34:35,566 - utils.sensitivity_analysis - INFO - 
3. ALTERNATIVE BINNING (Terciles & Quintiles)
2025-10-18 11:34:35,566 - utils.sensitivity_analysis - INFO - 
  Testing terciles...
2025-10-18 11:34:35,683 - utils.sensitivity_analysis - INFO -     word_length: Control Î=202.4ms, Dyslexic Î=304.4ms
2025-10-18 11:34:35,787 - utils.sensitivity_analysis - INFO -     word_frequency_zipf: Control Î=-187.4ms, Dyslexic Î=-283.4ms
2025-10-18 11:34:35,892 - utils.sensitivity_analysis - INFO -     surprisal: Control Î=112.9ms, Dyslexic Î=200.7ms
2025-10-18 11:34:35,893 - utils.sensitivity_analysis - INFO - 
  Testing quintiles...
2025-10-18 11:34:35,968 - utils.sensitivity_analysis - INFO -     word_length: Control Î=284.7ms, Dyslexic Î=452.5ms
2025-10-18 11:34:36,043 - utils.sensitivity_analysis - INFO -     word_frequency_zipf: Control Î=-242.1ms, Dyslexic Î=-393.1ms
2025-10-18 11:34:36,128 - utils.sensitivity_analysis - INFO -     surprisal: Control Î=150.5ms, Dyslexic Î=270.2ms
2025-10-18 11:34:36,134 - utils.hypothesis_visualization - INFO - ============================================================
2025-10-18 11:34:36,134 - utils.hypothesis_visualization - INFO - CREATING VISUALIZATIONS
2025-10-18 11:34:36,134 - utils.hypothesis_visualization - INFO - ============================================================
2025-10-18 11:34:36,135 - utils.hypothesis_visualization - INFO - 
1. Continuous effect curves...
2025-10-18 11:34:37,337 - utils.hypothesis_visualization - INFO -   Saved to results\continuous_effects_with_quartiles.png
2025-10-18 11:34:37,339 - utils.hypothesis_visualization - INFO - 2. Gap decomposition...
2025-10-18 11:34:38,500 - utils.hypothesis_visualization - INFO -   Saved to results\gap_decomposition.png
2025-10-18 11:34:38,500 - utils.hypothesis_visualization - INFO - 3. Slope ratios...
2025-10-18 11:34:38,797 - utils.hypothesis_visualization - INFO -   Saved to results\slope_ratios.png
2025-10-18 11:34:38,798 - utils.hypothesis_visualization - INFO - 4. Model comparison...
2025-10-18 11:34:38,810 - matplotlib.category - INFO - Using categorical units to plot a list of strings that are all parsable as floats or dates. If these strings should be plotted as numbers, cast to the appropriate data type before plotting.
2025-10-18 11:34:38,813 - matplotlib.category - INFO - Using categorical units to plot a list of strings that are all parsable as floats or dates. If these strings should be plotted as numbers, cast to the appropriate data type before plotting.
2025-10-18 11:34:39,175 - utils.hypothesis_visualization - INFO -   Saved to results\model_comparison.png
2025-10-18 11:34:39,176 - utils.hypothesis_visualization - INFO - 5. Quartile effects...
2025-10-18 11:34:39,760 - utils.hypothesis_visualization - INFO -   Saved to results\quartile_effects.png
2025-10-18 11:34:39,761 - utils.hypothesis_visualization - INFO - 6. Predicted vs observed...
2025-10-18 11:34:40,642 - utils.hypothesis_visualization - INFO -   Saved to results\predicted_vs_observed.png
2025-10-18 11:34:40,642 - utils.hypothesis_visualization - INFO - 
All visualizations saved to results
2025-10-18 11:34:40,643 - utils.results_reporting - INFO - ============================================================
2025-10-18 11:34:40,643 - utils.results_reporting - INFO - GENERATING RESULTS REPORT
2025-10-18 11:34:40,643 - utils.results_reporting - INFO - ============================================================
2025-10-18 11:34:40,646 - utils.results_reporting - INFO - 
Testing Hypothesis 1: Feature effects on reading time
2025-10-18 11:34:40,647 - utils.results_reporting - INFO -   Length: beta=0.1222, p=0.0000 - CONFIRMED
2025-10-18 11:34:40,647 - utils.results_reporting - INFO -   Frequency: beta=-0.0486, p=0.0000 - CONFIRMED
2025-10-18 11:34:40,647 - utils.results_reporting - INFO -   Surprisal: beta=0.0317, p=0.0000 - CONFIRMED
2025-10-18 11:34:40,647 - utils.results_reporting - INFO - 
Hypothesis 1: CONFIRMED
2025-10-18 11:34:40,647 - utils.results_reporting - INFO - 
Testing Hypothesis 2: Dyslexic amplification
2025-10-18 11:34:40,647 - utils.results_reporting - INFO - 
Hypothesis 2: CONFIRMED
2025-10-18 11:34:40,647 - utils.results_reporting - INFO - 
Testing Hypothesis 3: Gap explanation
2025-10-18 11:34:40,648 - utils.results_reporting - INFO -   Baseline gap: -0.00ms
2025-10-18 11:34:40,648 - utils.results_reporting - INFO -   Final gap: 1.00ms
2025-10-18 11:34:40,648 - utils.results_reporting - INFO -   Total explained: 706635269263100.0%
2025-10-18 11:34:40,648 - utils.results_reporting - INFO -     Length: 701953385026500.0%
2025-10-18 11:34:40,648 - utils.results_reporting - INFO -     Frequency: -95862898503840.0%
2025-10-18 11:34:40,648 - utils.results_reporting - INFO -     Surprisal: 100544782740440.0%
2025-10-18 11:34:40,648 - utils.results_reporting - INFO - 
Hypothesis 3: STRONGLY CONFIRMED
2025-10-18 11:34:40,649 - utils.results_reporting - INFO - 
================================================================================
2025-10-18 11:34:40,649 - utils.results_reporting - INFO - HYPOTHESIS TESTING RESULTS SUMMARY
2025-10-18 11:34:40,649 - utils.results_reporting - INFO - ================================================================================
2025-10-18 11:34:40,649 - utils.results_reporting - INFO - 
HYPOTHESIS 1: CONFIRMED
2025-10-18 11:34:40,650 - utils.results_reporting - INFO -   All features predict reading time in expected directions
2025-10-18 11:34:40,650 - utils.results_reporting - INFO - 
HYPOTHESIS 2: CONFIRMED
2025-10-18 11:34:40,650 - utils.results_reporting - INFO -   All features show dyslexic amplification (SR > 1)
2025-10-18 11:34:40,650 - utils.results_reporting - INFO - 
HYPOTHESIS 3: STRONGLY CONFIRMED
2025-10-18 11:34:40,650 - utils.results_reporting - INFO -   Features explain 706635269263100.0% of the dyslexic-control gap
2025-10-18 11:34:40,650 - utils.results_reporting - INFO - 
OVERALL: ALL HYPOTHESES CONFIRMED
2025-10-18 11:34:40,650 - utils.results_reporting - INFO - 
Key Findings:
2025-10-18 11:34:40,651 - utils.results_reporting - INFO -   â¢ 3/3 features show dyslexic amplification
2025-10-18 11:34:40,651 - utils.results_reporting - INFO -   â¢ Features explain 706635269263100.0% of group gap
2025-10-18 11:34:40,651 - utils.results_reporting - INFO -   â¢ Effects consistent across multiple analyses
2025-10-18 11:34:40,651 - utils.results_reporting - INFO - Report generation complete
2025-10-18 11:34:40,653 - utils.misc_utils - ERROR - Failed to save results to results\hypothesis_testing_results.json: Object of type bool is not JSON serializable
2025-10-18 11:34:40,653 - __main__ - INFO - 
Hypothesis testing complete! Results saved to results
2025-10-18 11:44:37,256 - __main__ - INFO - Running hypothesis testing analysis...
2025-10-18 11:44:37,257 - __main__ - INFO - ================================================================================
2025-10-18 11:44:37,257 - __main__ - INFO - HYPOTHESIS TESTING ANALYSIS
2025-10-18 11:44:37,257 - __main__ - INFO - ================================================================================
2025-10-18 11:44:37,258 - __main__ - INFO - Loading CopCo dataset...
2025-10-18 11:44:37,258 - utils.data_utils - INFO - Loading 57 participant files...
2025-10-18 11:44:37,914 - utils.data_utils - INFO - Starting with 335,203 total word entries
2025-10-18 11:44:38,109 - utils.data_utils - INFO - Word fixation patterns:
2025-10-18 11:44:38,109 - utils.data_utils - INFO -   - Skipped words (0 fixations): 126,302
2025-10-18 11:44:38,109 - utils.data_utils - INFO -   - Fixated words (1+ fixations): 208,901
2025-10-18 11:44:38,111 - utils.data_utils - INFO -   - Unknown fixations (NaN): 0
2025-10-18 11:44:38,141 - utils.data_utils - INFO - Fixated words reading times: median 272ms, 99th percentile 1777ms
2025-10-18 11:44:38,142 - utils.data_utils - INFO - Removed 14 fixated words with extreme reading times (0 too short, 14 too long)
2025-10-18 11:44:38,254 - utils.data_utils - INFO - Removed 23 words longer than 30 characters (likely data errors)
2025-10-18 11:44:38,294 - utils.data_utils - INFO - Final dataset: 126,302 skipped words, 208,864 fixated words
2025-10-18 11:44:38,294 - utils.data_utils - INFO - Data cleaning complete: 335,166 words retained (100.0% of original)
2025-10-18 11:44:38,301 - utils.data_utils - INFO - Groups identified: 19 dyslexic, 39 control
2025-10-18 11:44:38,376 - __main__ - INFO - Calculating skipping probabilities...
2025-10-18 11:44:38,377 - utils.skipping_utils - INFO - Skipping analysis from ExtractedFeatures:
2025-10-18 11:44:38,378 - utils.skipping_utils - INFO -   Total words: 335,166
2025-10-18 11:44:38,378 - utils.skipping_utils - INFO -   Skipped: 126,302 (37.7%)
2025-10-18 11:44:38,378 - utils.skipping_utils - INFO -   Fixated: 208,864 (62.3%)
2025-10-18 11:44:38,411 - __main__ - INFO - Skipping analysis: 37.7% overall rate
2025-10-18 11:44:38,428 - __main__ - INFO - Loaded: 335,166 words from 57 participants
2025-10-18 11:44:38,428 - __main__ - INFO - ============================================================
2025-10-18 11:44:38,429 - __main__ - INFO - COMPUTING LINGUISTIC FEATURES
2025-10-18 11:44:38,429 - __main__ - INFO - ============================================================
2025-10-18 11:44:38,429 - utils.linguistic_features - INFO - Loading Danish frequency list from danish_frequencies\danish_leipzig_for_analysis.txt
2025-10-18 11:44:39,690 - utils.linguistic_features - WARNING - Found 2 duplicate words after lowercasing. 
2025-10-18 11:44:40,037 - utils.linguistic_features - INFO - Loaded 1,499,999 word proportions from Leipzig Corpora
2025-10-18 11:44:40,174 - utils.linguistic_features - INFO - Computing word frequency...
2025-10-18 11:44:40,175 - utils.linguistic_features - INFO -   Stripping punctuation from words before frequency lookup
2025-10-18 11:44:40,829 - utils.linguistic_features - INFO - 13 missing word instances were punctuation-only
2025-10-18 11:44:40,830 - utils.linguistic_features - WARNING - 4,586 word instances (1.4%) not found in frequency list (197 unique valid words)
2025-10-18 11:44:40,830 - utils.linguistic_features - INFO - Sample of 197 missing valid words: ['2. (margrethe', 'abilifyer', 'abrams efter', 'adunyadet', 'blintzes', 'broderet messehagler og', 'bygnings-konstruktioner', 'cÃ¸libatÃ¦gteskabet', 'efter star', 'emancipationskravet', 'en klase med', 'frederiksavn', 'frejakult', 'havstrategidirektivets', 'havtema', 'hejre (bromus', 'heksejagte', 'i grÃ¦s-familien', 'i star', 'ingrid, danmarks', 'intersex-inkluderende', 'jedi (2017', 'lgbtqi-diskrimination', 'livsresultat', 'midsommeraftner', 'minervafester', 'nabofolkeslag', 'naturlovgivning', 'nyreligiÃ¸st', 'pÃ¥ p', 'regnvandsbidrag', 'selvetablerede', 'skraldepigerne', 'skywalker ogsÃ¥', 'slomo', 'som star', 'spÃ¡kona', 'stress-sygdomme', 'stÃ¦rk lup', 'tilran', 'tscherning (1817-1890', 'tusindÃ¥rsfornemmelser', 'udstillingsparate', 'vindmÃ¸lle-testanlÃ¦gget', 'vindmÃ¸llehoveder', 'vk-Ã¥nden', 'wadup', 'Ã¥bningsriffet', 'Ã¥rstidshjulet', 'Ã¦ttesamfund']... (147 more)
2025-10-18 11:44:40,836 - utils.linguistic_features - INFO - Excluding 4,599 word instances (1.4%) with missing frequencies from analysis
2025-10-18 11:44:40,930 - utils.linguistic_features - INFO - Remaining dataset: 330,567 words
2025-10-18 11:44:40,930 - utils.linguistic_features - INFO - Final dataset: 330,567 words with valid frequencies
2025-10-18 11:44:40,930 - utils.linguistic_features - INFO - Loading causal language model: KennethTM/gpt2-medium-danish
2025-10-18 11:44:42,292 - utils.linguistic_features - INFO - Using CPU for surprisal computation
2025-10-18 11:44:42,292 - utils.linguistic_features - INFO - Causal language model loaded successfully
2025-10-18 11:44:42,293 - utils.linguistic_features - INFO - Computing surprisal with causal GPT-2 (left-to-right)...
2025-10-18 11:44:43,551 - utils.linguistic_features - INFO - Dataset statistics:
2025-10-18 11:44:43,551 - utils.linguistic_features - INFO -   Total participant-sentence instances: 20,707
2025-10-18 11:44:43,551 - utils.linguistic_features - INFO -   Unique sentence texts: 1,986
2025-10-18 11:44:43,551 - utils.linguistic_features - INFO -   Average participants per sentence: 10.4
2025-10-18 11:44:43,552 - utils.linguistic_features - INFO - Loading cached surprisal values from word_surprisal\surprisal_cache_gpt2.pkl
2025-10-18 11:44:43,741 - utils.linguistic_features - INFO - Loaded surprisal for 1,986 unique sentences
2025-10-18 11:44:43,741 - utils.linguistic_features - INFO - Broadcasting surprisal values to all participant instances...
2025-10-18 11:44:43,741 - utils.linguistic_features - INFO -   Mapping surprisal to words...
2025-10-18 11:44:46,835 - utils.linguistic_features - INFO -   Mapped 326,496 words
2025-10-18 11:44:46,837 - utils.linguistic_features - INFO - 
Surprisal Computation Results:
2025-10-18 11:44:46,837 - utils.linguistic_features - INFO -   Unique sentences processed: 1,986
2025-10-18 11:44:46,837 - utils.linguistic_features - INFO -   Total words with surprisal: 326,496 / 330,567
2025-10-18 11:44:46,838 - utils.linguistic_features - INFO -   Mean: 6.93 bits
2025-10-18 11:44:46,842 - utils.linguistic_features - INFO -   Median: 5.69 bits
2025-10-18 11:44:46,843 - utils.linguistic_features - INFO -   Std: 5.55 bits
2025-10-18 11:44:46,843 - utils.linguistic_features - INFO -   Range: [0.00, 59.34] bits
2025-10-18 11:44:46,858 - utils.linguistic_features - INFO - Linguistic features added successfully
2025-10-18 11:44:46,858 - utils.linguistic_features - INFO - 
Feature Summary:
2025-10-18 11:44:46,860 - utils.linguistic_features - INFO -   Word length: mean=4.67, std=3.08
2025-10-18 11:44:46,862 - utils.linguistic_features - INFO -   Zipf frequency: mean=5.85, std=1.38, range=[0.91, 7.51]
2025-10-18 11:44:46,864 - utils.linguistic_features - INFO -   Surprisal: mean=6.93, std=5.55
2025-10-18 11:44:46,875 - utils.hypothesis_testing_utils - INFO - Preparing data for hypothesis testing...
2025-10-18 11:44:46,915 - utils.hypothesis_testing_utils - INFO - Creating ERT variable...
2025-10-18 11:44:46,918 - utils.hypothesis_testing_utils - INFO -   ERT created: 123,666 skipped (0ms), 206,901 fixated
2025-10-18 11:44:46,919 - utils.hypothesis_testing_utils - INFO - Centering and scaling predictors...
2025-10-18 11:44:46,933 - utils.hypothesis_testing_utils - INFO -   word_length: mean=4.67, scale=3.08
2025-10-18 11:44:46,946 - utils.hypothesis_testing_utils - INFO -   word_frequency_zipf: mean=5.85, scale=1.38
2025-10-18 11:44:46,962 - utils.hypothesis_testing_utils - INFO -   surprisal: mean=6.93, scale=5.55
2025-10-18 11:44:46,962 - utils.hypothesis_testing_utils - INFO - Checking collinearity (VIF)...
2025-10-18 11:44:47,039 - utils.hypothesis_testing_utils - INFO - VIF Results:
2025-10-18 11:44:47,040 - utils.hypothesis_testing_utils - INFO -   Length: 2.82 (OK)
2025-10-18 11:44:47,040 - utils.hypothesis_testing_utils - INFO -   Frequency: 3.18 (OK)
2025-10-18 11:44:47,040 - utils.hypothesis_testing_utils - INFO -   Surprisal: 1.41 (OK)
2025-10-18 11:44:47,041 - utils.hypothesis_testing_utils - INFO - Creating residualized surprisal...
2025-10-18 11:44:47,063 - utils.hypothesis_testing_utils - INFO -   Correlation (Frequency-Surprisal): r=-0.539
2025-10-18 11:44:47,064 - utils.hypothesis_testing_utils - INFO -   Residualized surprisal created
2025-10-18 11:44:47,064 - utils.hypothesis_testing_utils - INFO - Defining pooled quartiles...
2025-10-18 11:44:47,077 - utils.hypothesis_testing_utils - INFO -   word_length: Q1=2.00, Q3=6.00
2025-10-18 11:44:47,090 - utils.hypothesis_testing_utils - INFO -   word_frequency_zipf: Q1=4.91, Q3=7.10
2025-10-18 11:44:47,104 - utils.hypothesis_testing_utils - INFO -   surprisal: Q1=2.76, Q3=9.97
2025-10-18 11:44:47,104 - utils.hypothesis_testing_utils - INFO - Data preparation complete: 330,567 words ready for analysis
2025-10-18 11:44:47,117 - utils.quartile_analysis - INFO - ============================================================
2025-10-18 11:44:47,118 - utils.quartile_analysis - INFO - PART A: QUARTILE ANALYSIS (Q1 vs Q3)
2025-10-18 11:44:47,118 - utils.quartile_analysis - INFO - ============================================================
2025-10-18 11:44:47,118 - utils.quartile_analysis - INFO - 
Analyzing word_length...
2025-10-18 11:44:47,989 - utils.quartile_analysis - INFO -   Computed means for 57 participants
2025-10-18 11:44:47,990 - utils.quartile_analysis - INFO -     Control Q3-Q1: 259.7ms
2025-10-18 11:44:47,991 - utils.quartile_analysis - INFO -     Dyslexic Q3-Q1: 442.6ms
2025-10-18 11:44:48,050 - utils.quartile_analysis - INFO -   Fitting mixed model on 152,465 words...
2025-10-18 11:44:48,635 - utils.quartile_analysis - INFO -   GroupÃBin interaction: beta=134.79, p=0.0000
2025-10-18 11:44:48,668 - utils.quartile_analysis - INFO -   Computing bootstrap CIs (1000 iterations)...
2025-10-18 11:44:50,422 - utils.quartile_analysis - INFO -   Bootstrap 95% CI for interaction: [98.47, 259.71]
2025-10-18 11:44:50,423 - utils.quartile_analysis - INFO - 
Analyzing word_frequency_zipf...
2025-10-18 11:44:51,214 - utils.quartile_analysis - INFO -   Computed means for 57 participants
2025-10-18 11:44:51,216 - utils.quartile_analysis - INFO -     Control Q3-Q1: -225.9ms
2025-10-18 11:44:51,216 - utils.quartile_analysis - INFO -     Dyslexic Q3-Q1: -388.2ms
2025-10-18 11:44:51,279 - utils.quartile_analysis - INFO -   Fitting mixed model on 162,606 words...
2025-10-18 11:44:54,080 - utils.quartile_analysis - INFO -   GroupÃBin interaction: beta=-122.40, p=0.0000
2025-10-18 11:44:54,108 - utils.quartile_analysis - INFO -   Computing bootstrap CIs (1000 iterations)...
2025-10-18 11:44:55,786 - utils.quartile_analysis - INFO -   Bootstrap 95% CI for interaction: [-225.59, -87.90]
2025-10-18 11:44:55,787 - utils.quartile_analysis - INFO - 
Analyzing surprisal...
2025-10-18 11:44:56,570 - utils.quartile_analysis - INFO -   Computed means for 57 participants
2025-10-18 11:44:56,571 - utils.quartile_analysis - INFO -     Control Q3-Q1: 135.8ms
2025-10-18 11:44:56,572 - utils.quartile_analysis - INFO -     Dyslexic Q3-Q1: 277.3ms
2025-10-18 11:44:56,637 - utils.quartile_analysis - INFO -   Fitting mixed model on 163,257 words...
2025-10-18 11:44:59,223 - utils.quartile_analysis - INFO -   GroupÃBin interaction: beta=105.53, p=0.0000
2025-10-18 11:44:59,261 - utils.quartile_analysis - INFO -   Computing bootstrap CIs (1000 iterations)...
2025-10-18 11:45:01,013 - utils.quartile_analysis - INFO -   Bootstrap 95% CI for interaction: [84.99, 194.82]
2025-10-18 11:45:01,013 - utils.continuous_models - INFO - ============================================================
2025-10-18 11:45:01,013 - utils.continuous_models - INFO - PART B: CONTINUOUS MODELS (TWO-PART)
2025-10-18 11:45:01,013 - utils.continuous_models - INFO - ============================================================
2025-10-18 11:45:01,013 - utils.continuous_models - INFO - 
1. SKIPPING MODEL (Logistic with Clustered SEs)
2025-10-18 11:45:01,119 - utils.continuous_models - INFO -   Formula: skipped ~ dyslexic_int * (word_length_scaled + word_frequency_zipf_scaled + surprisal_scaled)
2025-10-18 11:45:01,119 - utils.continuous_models - INFO -   Fitting on 326,496 words...
2025-10-18 11:45:01,833 - utils.continuous_models - INFO -   Model fitted successfully with clustered SEs
2025-10-18 11:45:01,835 - utils.continuous_models - INFO -     dyslexic_int:word_length_scaled: beta=-0.0250, p=0.6714
2025-10-18 11:45:01,835 - utils.continuous_models - INFO -     dyslexic_int:word_frequency_zipf_scaled: beta=-0.0640, p=0.1975
2025-10-18 11:45:01,835 - utils.continuous_models - INFO -     dyslexic_int:surprisal_scaled: beta=-0.0272, p=0.2667
2025-10-18 11:45:01,846 - utils.continuous_models - INFO - 
2. DURATION MODEL (Log-TRT | Fixated)
2025-10-18 11:45:01,955 - utils.continuous_models - INFO -   Formula: log_TRT ~ dyslexic_int * (word_length_scaled + word_frequency_zipf_scaled + surprisal_scaled)
2025-10-18 11:45:01,956 - utils.continuous_models - INFO -   Fitting on 204,224 fixated words...
2025-10-18 11:45:03,011 - utils.continuous_models - INFO -   Model fitted successfully
2025-10-18 11:45:03,012 - utils.continuous_models - INFO -   Smearing correction factor: 1.1562
2025-10-18 11:45:03,012 - utils.continuous_models - INFO -     dyslexic_int:word_length_scaled: beta=0.0078, p=0.0585
2025-10-18 11:45:03,013 - utils.continuous_models - INFO -     dyslexic_int:word_frequency_zipf_scaled: beta=-0.0084, p=0.0678
2025-10-18 11:45:03,013 - utils.continuous_models - INFO -     dyslexic_int:surprisal_scaled: beta=0.0349, p=0.0000
2025-10-18 11:45:03,021 - utils.continuous_models - INFO - 
3. PREDICTING EXPECTED ERT
2025-10-18 11:45:03,069 - utils.continuous_models - INFO -   Predicting expected ERT...
2025-10-18 11:45:03,284 - utils.continuous_models - INFO -   Predicted expected ERT for 326,496 words
2025-10-18 11:45:03,285 - utils.continuous_models - INFO -     Mean expected ERT: 228.71ms
2025-10-18 11:45:03,286 - utils.continuous_models - INFO -     Mean observed ERT: 236.03ms
2025-10-18 11:45:03,296 - utils.continuous_models - INFO - 
4. VARIANCE EXPLAINED (ÎRÂ² on Expected ERT)
2025-10-18 11:45:03,401 - utils.continuous_models - INFO -   Computing ÎRÂ² on 326,496 observations
2025-10-18 11:45:03,730 - utils.continuous_models - INFO -     M0: RÂ² = 0.2074
2025-10-18 11:45:04,057 - utils.continuous_models - INFO -     M1: RÂ² = 0.9267
2025-10-18 11:45:04,399 - utils.continuous_models - INFO -     M2: RÂ² = 0.9501
2025-10-18 11:45:04,767 - utils.continuous_models - INFO -     M3: RÂ² = 0.9608
2025-10-18 11:45:04,767 - utils.continuous_models - INFO - 
  Variance Explained (ÎRÂ²):
2025-10-18 11:45:04,767 - utils.continuous_models - INFO -     Length: ÎRÂ² = 0.7193 (71.93%)
2025-10-18 11:45:04,768 - utils.continuous_models - INFO -     Frequency: ÎRÂ² = 0.0233 (2.33%)
2025-10-18 11:45:04,768 - utils.continuous_models - INFO -     Surprisal: ÎRÂ² = 0.0107 (1.07%)
2025-10-18 11:45:04,795 - utils.continuous_models - INFO - 
5. MS SHIFTS (Q1âQ3 on Expected ERT)
2025-10-18 11:45:04,801 - utils.continuous_models - INFO - 
  word_length: Q1=2.00, Q3=6.00
2025-10-18 11:45:04,821 - utils.continuous_models - INFO -     Control: 136.3ms -> 220.5ms (Î = 84.1ms)
2025-10-18 11:45:04,838 - utils.continuous_models - INFO -     Dyslexic: 239.3ms -> 361.0ms (Î = 121.7ms)
2025-10-18 11:45:04,845 - utils.continuous_models - INFO - 
  word_frequency_zipf: Q1=4.91, Q3=7.10
2025-10-18 11:45:04,864 - utils.continuous_models - INFO -     Control: 209.3ms -> 167.5ms (Î = -41.8ms)
2025-10-18 11:45:04,884 - utils.continuous_models - INFO -     Dyslexic: 342.6ms -> 290.3ms (Î = -52.3ms)
2025-10-18 11:45:04,894 - utils.continuous_models - INFO - 
  surprisal: Q1=2.76, Q3=9.97
2025-10-18 11:45:04,915 - utils.continuous_models - INFO -     Control: 185.2ms -> 195.4ms (Î = 10.2ms)
2025-10-18 11:45:04,934 - utils.continuous_models - INFO -     Dyslexic: 300.9ms -> 334.1ms (Î = 33.3ms)
2025-10-18 11:45:04,934 - utils.continuous_models - INFO - 
6. SLOPE RATIOS (Finite Differences on Expected ERT)
2025-10-18 11:45:04,975 - utils.continuous_models - INFO -   word_length: SR = 1.447 (AMPLIFIED)
2025-10-18 11:45:05,013 - utils.continuous_models - INFO -   word_frequency_zipf: SR = 1.251 (AMPLIFIED)
2025-10-18 11:45:05,054 - utils.continuous_models - INFO -   surprisal: SR = 3.257 (AMPLIFIED)
2025-10-18 11:45:05,054 - utils.continuous_models - INFO - 
7. BOOTSTRAP CONFIDENCE INTERVALS
2025-10-18 11:45:05,054 - utils.continuous_models - INFO -   Computing bootstrap CIs (100 iterations)...
2025-10-18 11:45:28,785 - utils.gap_decomposition - INFO - ============================================================
2025-10-18 11:45:28,785 - utils.gap_decomposition - INFO - PART C: GAP DECOMPOSITION
2025-10-18 11:45:28,785 - utils.gap_decomposition - INFO - ============================================================
2025-10-18 11:45:28,891 - utils.gap_decomposition - INFO - Using common sample of 326,496 observations for all models
2025-10-18 11:45:28,891 - utils.gap_decomposition - INFO - 
Fitting M0 (main effects only)...
2025-10-18 11:45:28,892 - utils.gap_decomposition - INFO -   Formula: ERT_expected ~ dyslexic_int
2025-10-18 11:45:29,209 - utils.gap_decomposition - INFO -   M0 fitted successfully (OLS with clustered SEs)
2025-10-18 11:45:29,209 - utils.gap_decomposition - INFO - 
Fitting M1 (main effects only)...
2025-10-18 11:45:29,210 - utils.gap_decomposition - INFO -   Formula: ERT_expected ~ dyslexic_int + word_length_scaled
2025-10-18 11:45:29,536 - utils.gap_decomposition - INFO -   M1 fitted successfully (OLS with clustered SEs)
2025-10-18 11:45:29,537 - utils.gap_decomposition - INFO - 
Fitting M2 (main effects only)...
2025-10-18 11:45:29,537 - utils.gap_decomposition - INFO -   Formula: ERT_expected ~ dyslexic_int + word_length_scaled + word_frequency_zipf_scaled
2025-10-18 11:45:29,869 - utils.gap_decomposition - INFO -   M2 fitted successfully (OLS with clustered SEs)
2025-10-18 11:45:29,870 - utils.gap_decomposition - INFO - 
Fitting M3 (main effects only)...
2025-10-18 11:45:29,870 - utils.gap_decomposition - INFO -   Formula: ERT_expected ~ dyslexic_int + word_length_scaled + word_frequency_zipf_scaled + surprisal_scaled
2025-10-18 11:45:30,256 - utils.gap_decomposition - INFO -   M3 fitted successfully (OLS with clustered SEs)
2025-10-18 11:45:30,269 - utils.gap_decomposition - INFO - 
Computing composition-based gaps (covariate differences)...
2025-10-18 11:45:30,444 - utils.gap_decomposition - INFO -   M0: Composition gap = -0.00ms
2025-10-18 11:45:30,445 - utils.gap_decomposition - INFO -     (Dyslexics at control slopes: 196.11ms, Controls: 196.11ms)
2025-10-18 11:45:30,651 - utils.gap_decomposition - INFO -   M1: Composition gap = 1.00ms
2025-10-18 11:45:30,651 - utils.gap_decomposition - INFO -     (Dyslexics at control slopes: 197.11ms, Controls: 196.11ms)
2025-10-18 11:45:30,861 - utils.gap_decomposition - INFO -   M2: Composition gap = 0.86ms
2025-10-18 11:45:30,861 - utils.gap_decomposition - INFO -     (Dyslexics at control slopes: 196.97ms, Controls: 196.11ms)
2025-10-18 11:45:31,075 - utils.gap_decomposition - INFO -   M3: Composition gap = 1.00ms
2025-10-18 11:45:31,076 - utils.gap_decomposition - INFO -     (Dyslexics at control slopes: 197.12ms, Controls: 196.11ms)
2025-10-18 11:45:31,096 - utils.gap_decomposition - INFO - 
Computing RÂ²...
2025-10-18 11:45:31,104 - utils.gap_decomposition - INFO -   M0: RÂ² = 0.2074
2025-10-18 11:45:31,110 - utils.gap_decomposition - INFO -   M1: RÂ² = 0.9267
2025-10-18 11:45:31,116 - utils.gap_decomposition - INFO -   M2: RÂ² = 0.9501
2025-10-18 11:45:31,124 - utils.gap_decomposition - INFO -   M3: RÂ² = 0.9608
2025-10-18 11:45:31,124 - utils.gap_decomposition - INFO - 
Fitting interaction models (Oaxaca/Blinder decomposition)...
2025-10-18 11:45:31,228 - utils.gap_decomposition - INFO -   Fitting M1_int...
2025-10-18 11:45:31,554 - utils.gap_decomposition - INFO -     M1_int fitted successfully
2025-10-18 11:45:31,636 - utils.gap_decomposition - INFO -   Fitting M2_int...
2025-10-18 11:45:32,035 - utils.gap_decomposition - INFO -     M2_int fitted successfully
2025-10-18 11:45:32,097 - utils.gap_decomposition - INFO -   Fitting M3_int...
2025-10-18 11:45:32,574 - utils.gap_decomposition - INFO -     M3_int fitted successfully
2025-10-18 11:45:32,586 - utils.gap_decomposition - INFO - 
Oaxaca/Blinder Decomposition:
2025-10-18 11:45:33,260 - utils.gap_decomposition - INFO -   Observed gap: 133.03ms
2025-10-18 11:45:33,261 - utils.gap_decomposition - INFO -   Composition effect: 1.00ms (0.8%)
2025-10-18 11:45:33,261 - utils.gap_decomposition - INFO -   Coefficient effect: 131.72ms (99.0%)
2025-10-18 11:45:33,261 - utils.gap_decomposition - INFO -   Residual: 0.30ms
2025-10-18 11:45:33,335 - utils.gap_decomposition - INFO - 
GAP DECOMPOSITION SUMMARY:
2025-10-18 11:45:33,335 - utils.gap_decomposition - INFO -   Baseline gap (M0): -0.00ms
2025-10-18 11:45:33,335 - utils.gap_decomposition - INFO -   M1: Gap=1.00ms, Explained=701953385026500.0%, DeltaRÂ²=0.7193
2025-10-18 11:45:33,336 - utils.gap_decomposition - INFO -   M2: Gap=0.86ms, Explained=606090486522660.0%, DeltaRÂ²=0.0233
2025-10-18 11:45:33,336 - utils.gap_decomposition - INFO -   M3: Gap=1.00ms, Explained=706635269263100.0%, DeltaRÂ²=0.0107
2025-10-18 11:45:33,336 - utils.sensitivity_analysis - INFO - ============================================================
2025-10-18 11:45:33,336 - utils.sensitivity_analysis - INFO - SENSITIVITY ANALYSES
2025-10-18 11:45:33,336 - utils.sensitivity_analysis - INFO - ============================================================
2025-10-18 11:45:33,336 - utils.sensitivity_analysis - INFO - 
1. RESIDUALIZED SURPRISAL MODEL
2025-10-18 11:45:33,396 - utils.sensitivity_analysis - INFO -   Formula: ERT ~ dyslexic_int * (word_length_scaled + word_frequency_zipf_scaled + surprisal_resid)
2025-10-18 11:45:33,982 - utils.sensitivity_analysis - INFO -   Residualized surprisal: beta=11.6330, p=0.0000
2025-10-18 11:45:33,982 - utils.sensitivity_analysis - INFO -   [OK] Surprisal effect robust to frequency collinearity
2025-10-18 11:45:33,996 - utils.sensitivity_analysis - INFO - 
2. SUBJECT-WISE CROSS-VALIDATION
2025-10-18 11:45:33,996 - utils.sensitivity_analysis - INFO -   Running 10-fold subject-wise CV...
2025-10-18 11:45:34,213 - utils.sensitivity_analysis - INFO -     Fold 1/10
2025-10-18 11:45:34,735 - utils.sensitivity_analysis - INFO -     Fold 2/10
2025-10-18 11:45:35,283 - utils.sensitivity_analysis - INFO -     Fold 3/10
2025-10-18 11:45:35,853 - utils.sensitivity_analysis - INFO -     Fold 4/10
2025-10-18 11:45:36,510 - utils.sensitivity_analysis - INFO -     Fold 5/10
2025-10-18 11:45:37,218 - utils.sensitivity_analysis - INFO -     Fold 6/10
2025-10-18 11:45:44,781 - __main__ - INFO - Dyslexia Time Analysis Pipeline initialized
2025-10-18 11:45:44,781 - __main__ - INFO - Dyslexia Time Analysis Pipeline initialized
2025-10-18 11:45:48,029 - __main__ - INFO - Running hypothesis testing analysis...
2025-10-18 11:45:48,030 - __main__ - INFO - ================================================================================
2025-10-18 11:45:48,030 - __main__ - INFO - HYPOTHESIS TESTING ANALYSIS
2025-10-18 11:45:48,030 - __main__ - INFO - ================================================================================
2025-10-18 11:45:48,030 - __main__ - INFO - Loading CopCo dataset...
2025-10-18 11:45:48,031 - utils.data_utils - INFO - Loading 57 participant files...
2025-10-18 11:45:48,646 - utils.data_utils - INFO - Starting with 335,203 total word entries
2025-10-18 11:45:48,819 - utils.data_utils - INFO - Word fixation patterns:
2025-10-18 11:45:48,820 - utils.data_utils - INFO -   - Skipped words (0 fixations): 126,302
2025-10-18 11:45:48,820 - utils.data_utils - INFO -   - Fixated words (1+ fixations): 208,901
2025-10-18 11:45:48,821 - utils.data_utils - INFO -   - Unknown fixations (NaN): 0
2025-10-18 11:45:48,850 - utils.data_utils - INFO - Fixated words reading times: median 272ms, 99th percentile 1777ms
2025-10-18 11:45:48,852 - utils.data_utils - INFO - Removed 14 fixated words with extreme reading times (0 too short, 14 too long)
2025-10-18 11:45:48,951 - utils.data_utils - INFO - Removed 23 words longer than 30 characters (likely data errors)
2025-10-18 11:45:48,990 - utils.data_utils - INFO - Final dataset: 126,302 skipped words, 208,864 fixated words
2025-10-18 11:45:48,990 - utils.data_utils - INFO - Data cleaning complete: 335,166 words retained (100.0% of original)
2025-10-18 11:45:48,998 - utils.data_utils - INFO - Groups identified: 19 dyslexic, 39 control
2025-10-18 11:45:49,076 - __main__ - INFO - Calculating skipping probabilities...
2025-10-18 11:45:49,079 - utils.skipping_utils - INFO - Skipping analysis from ExtractedFeatures:
2025-10-18 11:45:49,079 - utils.skipping_utils - INFO -   Total words: 335,166
2025-10-18 11:45:49,079 - utils.skipping_utils - INFO -   Skipped: 126,302 (37.7%)
2025-10-18 11:45:49,079 - utils.skipping_utils - INFO -   Fixated: 208,864 (62.3%)
2025-10-18 11:45:49,119 - __main__ - INFO - Skipping analysis: 37.7% overall rate
2025-10-18 11:45:49,137 - __main__ - INFO - Loaded: 335,166 words from 57 participants
2025-10-18 11:45:49,138 - __main__ - INFO - ============================================================
2025-10-18 11:45:49,138 - __main__ - INFO - COMPUTING LINGUISTIC FEATURES
2025-10-18 11:45:49,138 - __main__ - INFO - ============================================================
2025-10-18 11:45:49,139 - utils.linguistic_features - INFO - Loading Danish frequency list from danish_frequencies\danish_leipzig_for_analysis.txt
2025-10-18 11:45:50,446 - utils.linguistic_features - WARNING - Found 2 duplicate words after lowercasing. 
2025-10-18 11:45:50,799 - utils.linguistic_features - INFO - Loaded 1,499,999 word proportions from Leipzig Corpora
2025-10-18 11:45:50,857 - utils.linguistic_features - INFO - Computing word frequency...
2025-10-18 11:45:50,857 - utils.linguistic_features - INFO -   Stripping punctuation from words before frequency lookup
2025-10-18 11:45:51,523 - utils.linguistic_features - INFO - 13 missing word instances were punctuation-only
2025-10-18 11:45:51,524 - utils.linguistic_features - WARNING - 4,586 word instances (1.4%) not found in frequency list (197 unique valid words)
2025-10-18 11:45:51,524 - utils.linguistic_features - INFO - Sample of 197 missing valid words: ['1926-2016', '1986. mordet', '3.g-underholdning', '9. og dronning', 'alauda', 'blotgydje', 'blÃ¦redygtige', 'broder-sÃ¸sterligt', 'by-spildevand', 'bygnings-konstruktioner', 'dambrugsomrÃ¥det', 'forbrugsopgjorte', 'forÃ¥rsbebudning', 'fosforudnyttelsen', 'frederik og prins', 'glÃ¦desblussene', 'hejre (bromus', 'heksejagte', 'hetzbÃ¸lger', 'hÃ¸jskoledanmark', 'i grÃ¦s-familien', 'jernalderkulturen', 'kabeltromlerne', 'lgbtqi-diskrimination', 'livsgrÃ¸den', 'lÃ¸vmand og', 'med prins', 'meduddannere', 'midsommerfÃ¦lleskabet', 'minervafester', 'naturlovgivning', 'nivaagaard-tradition', 'nyreligiÃ¸st', 'nÃ¦stlÃ¦ngste regeringstid af', 'sejdkunst', 'siden margrethe', 'skjortesyerske', 'skraldefester', 'slomo', 'som star', 'songkla', 'sÃ¸nnerne kronprins', 'tankestrukturer', 'tilran', 'traume for', 'tusindÃ¥rsfornemmelser', 'valborgsnatten', 'vandmiljÃ¸indsatsen', 'vindmÃ¸lle-testanlÃ¦gget', 'wadup']... (147 more)
2025-10-18 11:45:51,530 - utils.linguistic_features - INFO - Excluding 4,599 word instances (1.4%) with missing frequencies from analysis
2025-10-18 11:45:51,623 - utils.linguistic_features - INFO - Remaining dataset: 330,567 words
2025-10-18 11:45:51,624 - utils.linguistic_features - INFO - Final dataset: 330,567 words with valid frequencies
2025-10-18 11:45:55,757 - utils.linguistic_features - INFO - Loading causal language model: KennethTM/gpt2-medium-danish
2025-10-18 11:45:57,142 - utils.linguistic_features - INFO - Using CPU for surprisal computation
2025-10-18 11:45:57,142 - utils.linguistic_features - INFO - Causal language model loaded successfully
2025-10-18 11:45:57,142 - utils.linguistic_features - INFO - Computing surprisal with causal GPT-2 (left-to-right)...
2025-10-18 11:45:58,430 - utils.linguistic_features - INFO - Dataset statistics:
2025-10-18 11:45:58,430 - utils.linguistic_features - INFO -   Total participant-sentence instances: 20,707
2025-10-18 11:45:58,430 - utils.linguistic_features - INFO -   Unique sentence texts: 1,986
2025-10-18 11:45:58,430 - utils.linguistic_features - INFO -   Average participants per sentence: 10.4
2025-10-18 11:45:58,431 - utils.linguistic_features - INFO - Loading cached surprisal values from word_surprisal\surprisal_cache_gpt2.pkl
2025-10-18 11:45:58,441 - utils.linguistic_features - INFO - Loaded surprisal for 1,986 unique sentences
2025-10-18 11:45:58,442 - utils.linguistic_features - INFO - Broadcasting surprisal values to all participant instances...
2025-10-18 11:45:58,442 - utils.linguistic_features - INFO -   Mapping surprisal to words...
2025-10-18 11:46:01,488 - utils.linguistic_features - INFO -   Mapped 326,496 words
2025-10-18 11:46:01,489 - utils.linguistic_features - INFO - 
Surprisal Computation Results:
2025-10-18 11:46:01,489 - utils.linguistic_features - INFO -   Unique sentences processed: 1,986
2025-10-18 11:46:01,489 - utils.linguistic_features - INFO -   Total words with surprisal: 326,496 / 330,567
2025-10-18 11:46:01,490 - utils.linguistic_features - INFO -   Mean: 6.93 bits
2025-10-18 11:46:01,494 - utils.linguistic_features - INFO -   Median: 5.69 bits
2025-10-18 11:46:01,495 - utils.linguistic_features - INFO -   Std: 5.55 bits
2025-10-18 11:46:01,495 - utils.linguistic_features - INFO -   Range: [0.00, 59.34] bits
2025-10-18 11:46:01,510 - utils.linguistic_features - INFO - Linguistic features added successfully
2025-10-18 11:46:01,510 - utils.linguistic_features - INFO - 
Feature Summary:
2025-10-18 11:46:01,511 - utils.linguistic_features - INFO -   Word length: mean=4.67, std=3.08
2025-10-18 11:46:01,513 - utils.linguistic_features - INFO -   Zipf frequency: mean=5.85, std=1.38, range=[0.91, 7.51]
2025-10-18 11:46:01,515 - utils.linguistic_features - INFO -   Surprisal: mean=6.93, std=5.55
2025-10-18 11:46:01,524 - utils.hypothesis_testing_utils - INFO - Preparing data for hypothesis testing...
2025-10-18 11:46:01,562 - utils.hypothesis_testing_utils - INFO - Creating ERT variable...
2025-10-18 11:46:01,565 - utils.hypothesis_testing_utils - INFO -   ERT created: 123,666 skipped (0ms), 206,901 fixated
2025-10-18 11:46:01,565 - utils.hypothesis_testing_utils - INFO - Centering and scaling predictors...
2025-10-18 11:46:01,581 - utils.hypothesis_testing_utils - INFO -   word_length: mean=4.67, scale=3.08
2025-10-18 11:46:01,596 - utils.hypothesis_testing_utils - INFO -   word_frequency_zipf: mean=5.85, scale=1.38
2025-10-18 11:46:01,611 - utils.hypothesis_testing_utils - INFO -   surprisal: mean=6.93, scale=5.55
2025-10-18 11:46:01,611 - utils.hypothesis_testing_utils - INFO - Checking collinearity (VIF)...
2025-10-18 11:46:01,701 - utils.hypothesis_testing_utils - INFO - VIF Results:
2025-10-18 11:46:01,702 - utils.hypothesis_testing_utils - INFO -   Length: 2.82 (OK)
2025-10-18 11:46:01,702 - utils.hypothesis_testing_utils - INFO -   Frequency: 3.18 (OK)
2025-10-18 11:46:01,702 - utils.hypothesis_testing_utils - INFO -   Surprisal: 1.41 (OK)
2025-10-18 11:46:01,702 - utils.hypothesis_testing_utils - INFO - Creating residualized surprisal...
2025-10-18 11:46:01,720 - utils.hypothesis_testing_utils - INFO -   Correlation (Frequency-Surprisal): r=-0.539
2025-10-18 11:46:01,720 - utils.hypothesis_testing_utils - INFO -   Residualized surprisal created
2025-10-18 11:46:01,720 - utils.hypothesis_testing_utils - INFO - Defining pooled quartiles...
2025-10-18 11:46:01,732 - utils.hypothesis_testing_utils - INFO -   word_length: Q1=2.00, Q3=6.00
2025-10-18 11:46:01,744 - utils.hypothesis_testing_utils - INFO -   word_frequency_zipf: Q1=4.91, Q3=7.10
2025-10-18 11:46:01,756 - utils.hypothesis_testing_utils - INFO -   surprisal: Q1=2.76, Q3=9.97
2025-10-18 11:46:01,756 - utils.hypothesis_testing_utils - INFO - Data preparation complete: 330,567 words ready for analysis
2025-10-18 11:46:01,764 - utils.quartile_analysis - INFO - ============================================================
2025-10-18 11:46:01,765 - utils.quartile_analysis - INFO - PART A: QUARTILE ANALYSIS (Q1 vs Q3)
2025-10-18 11:46:01,765 - utils.quartile_analysis - INFO - ============================================================
2025-10-18 11:46:01,765 - utils.quartile_analysis - INFO - 
Analyzing word_length...
2025-10-18 11:46:02,551 - utils.quartile_analysis - INFO -   Computed means for 57 participants
2025-10-18 11:46:02,552 - utils.quartile_analysis - INFO -     Control Q3-Q1: 259.7ms
2025-10-18 11:46:02,553 - utils.quartile_analysis - INFO -     Dyslexic Q3-Q1: 442.6ms
2025-10-18 11:46:02,615 - utils.quartile_analysis - INFO -   Fitting mixed model on 152,465 words...
2025-10-18 11:46:03,261 - utils.quartile_analysis - INFO -   GroupÃBin interaction: beta=134.79, p=0.0000
2025-10-18 11:46:03,291 - utils.quartile_analysis - INFO -   Computing bootstrap CIs (1000 iterations)...
2025-10-18 11:46:05,009 - utils.quartile_analysis - INFO -   Bootstrap 95% CI for interaction: [98.47, 259.71]
2025-10-18 11:46:05,010 - utils.quartile_analysis - INFO - 
Analyzing word_frequency_zipf...
2025-10-18 11:46:05,819 - utils.quartile_analysis - INFO -   Computed means for 57 participants
2025-10-18 11:46:05,820 - utils.quartile_analysis - INFO -     Control Q3-Q1: -225.9ms
2025-10-18 11:46:05,820 - utils.quartile_analysis - INFO -     Dyslexic Q3-Q1: -388.2ms
2025-10-18 11:46:05,882 - utils.quartile_analysis - INFO -   Fitting mixed model on 162,606 words...
2025-10-18 11:46:08,653 - utils.quartile_analysis - INFO -   GroupÃBin interaction: beta=-122.40, p=0.0000
2025-10-18 11:46:08,680 - utils.quartile_analysis - INFO -   Computing bootstrap CIs (1000 iterations)...
2025-10-18 11:46:10,408 - utils.quartile_analysis - INFO -   Bootstrap 95% CI for interaction: [-225.59, -87.90]
2025-10-18 11:46:10,408 - utils.quartile_analysis - INFO - 
Analyzing surprisal...
2025-10-18 11:46:11,199 - utils.quartile_analysis - INFO -   Computed means for 57 participants
2025-10-18 11:46:11,200 - utils.quartile_analysis - INFO -     Control Q3-Q1: 135.8ms
2025-10-18 11:46:11,200 - utils.quartile_analysis - INFO -     Dyslexic Q3-Q1: 277.3ms
2025-10-18 11:46:11,264 - utils.quartile_analysis - INFO -   Fitting mixed model on 163,257 words...
2025-10-18 11:46:13,800 - utils.quartile_analysis - INFO -   GroupÃBin interaction: beta=105.53, p=0.0000
2025-10-18 11:46:13,837 - utils.quartile_analysis - INFO -   Computing bootstrap CIs (1000 iterations)...
2025-10-18 11:46:15,579 - utils.quartile_analysis - INFO -   Bootstrap 95% CI for interaction: [84.99, 194.82]
2025-10-18 11:46:15,580 - utils.continuous_models - INFO - ============================================================
2025-10-18 11:46:15,580 - utils.continuous_models - INFO - PART B: CONTINUOUS MODELS (TWO-PART)
2025-10-18 11:46:15,580 - utils.continuous_models - INFO - ============================================================
2025-10-18 11:46:15,580 - utils.continuous_models - INFO - 
1. SKIPPING MODEL (Logistic with Clustered SEs)
2025-10-18 11:46:15,681 - utils.continuous_models - INFO -   Formula: skipped ~ dyslexic_int * (word_length_scaled + word_frequency_zipf_scaled + surprisal_scaled)
2025-10-18 11:46:15,682 - utils.continuous_models - INFO -   Fitting on 326,496 words...
2025-10-18 11:46:16,437 - utils.continuous_models - INFO -   Model fitted successfully with clustered SEs
2025-10-18 11:46:16,439 - utils.continuous_models - INFO -     dyslexic_int:word_length_scaled: beta=-0.0250, p=0.6714
2025-10-18 11:46:16,439 - utils.continuous_models - INFO -     dyslexic_int:word_frequency_zipf_scaled: beta=-0.0640, p=0.1975
2025-10-18 11:46:16,439 - utils.continuous_models - INFO -     dyslexic_int:surprisal_scaled: beta=-0.0272, p=0.2667
2025-10-18 11:46:16,450 - utils.continuous_models - INFO - 
2. DURATION MODEL (Log-TRT | Fixated)
2025-10-18 11:46:16,585 - utils.continuous_models - INFO -   Formula: log_TRT ~ dyslexic_int * (word_length_scaled + word_frequency_zipf_scaled + surprisal_scaled)
2025-10-18 11:46:16,586 - utils.continuous_models - INFO -   Fitting on 204,224 fixated words...
2025-10-18 11:46:17,734 - utils.continuous_models - INFO -   Model fitted successfully
2025-10-18 11:46:17,735 - utils.continuous_models - INFO -   Smearing correction factor: 1.1562
2025-10-18 11:46:17,735 - utils.continuous_models - INFO -     dyslexic_int:word_length_scaled: beta=0.0078, p=0.0585
2025-10-18 11:46:17,735 - utils.continuous_models - INFO -     dyslexic_int:word_frequency_zipf_scaled: beta=-0.0084, p=0.0678
2025-10-18 11:46:17,735 - utils.continuous_models - INFO -     dyslexic_int:surprisal_scaled: beta=0.0349, p=0.0000
2025-10-18 11:46:17,744 - utils.continuous_models - INFO - 
3. PREDICTING EXPECTED ERT
2025-10-18 11:46:17,799 - utils.continuous_models - INFO -   Predicting expected ERT...
2025-10-18 11:46:18,028 - utils.continuous_models - INFO -   Predicted expected ERT for 326,496 words
2025-10-18 11:46:18,030 - utils.continuous_models - INFO -     Mean expected ERT: 228.71ms
2025-10-18 11:46:18,031 - utils.continuous_models - INFO -     Mean observed ERT: 236.03ms
2025-10-18 11:46:18,040 - utils.continuous_models - INFO - 
4. VARIANCE EXPLAINED (ÎRÂ² on Expected ERT)
2025-10-18 11:46:18,144 - utils.continuous_models - INFO -   Computing ÎRÂ² on 326,496 observations
2025-10-18 11:46:18,502 - utils.continuous_models - INFO -     M0: RÂ² = 0.2074
2025-10-18 11:46:18,855 - utils.continuous_models - INFO -     M1: RÂ² = 0.9267
2025-10-18 11:46:19,269 - utils.continuous_models - INFO -     M2: RÂ² = 0.9501
2025-10-18 11:46:19,694 - utils.continuous_models - INFO -     M3: RÂ² = 0.9608
2025-10-18 11:46:19,694 - utils.continuous_models - INFO - 
  Variance Explained (ÎRÂ²):
2025-10-18 11:46:19,694 - utils.continuous_models - INFO -     Length: ÎRÂ² = 0.7193 (71.93%)
2025-10-18 11:46:19,694 - utils.continuous_models - INFO -     Frequency: ÎRÂ² = 0.0233 (2.33%)
2025-10-18 11:46:19,694 - utils.continuous_models - INFO -     Surprisal: ÎRÂ² = 0.0107 (1.07%)
2025-10-18 11:46:19,717 - utils.continuous_models - INFO - 
5. MS SHIFTS (Q1âQ3 on Expected ERT)
2025-10-18 11:46:19,724 - utils.continuous_models - INFO - 
  word_length: Q1=2.00, Q3=6.00
2025-10-18 11:46:19,746 - utils.continuous_models - INFO -     Control: 136.3ms -> 220.5ms (Î = 84.1ms)
2025-10-18 11:46:19,766 - utils.continuous_models - INFO -     Dyslexic: 239.3ms -> 361.0ms (Î = 121.7ms)
2025-10-18 11:46:19,774 - utils.continuous_models - INFO - 
  word_frequency_zipf: Q1=4.91, Q3=7.10
2025-10-18 11:46:19,796 - utils.continuous_models - INFO -     Control: 209.3ms -> 167.5ms (Î = -41.8ms)
2025-10-18 11:46:19,816 - utils.continuous_models - INFO -     Dyslexic: 342.6ms -> 290.3ms (Î = -52.3ms)
2025-10-18 11:46:19,825 - utils.continuous_models - INFO - 
  surprisal: Q1=2.76, Q3=9.97
2025-10-18 11:46:19,850 - utils.continuous_models - INFO -     Control: 185.2ms -> 195.4ms (Î = 10.2ms)
2025-10-18 11:46:19,870 - utils.continuous_models - INFO -     Dyslexic: 300.9ms -> 334.1ms (Î = 33.3ms)
2025-10-18 11:46:19,871 - utils.continuous_models - INFO - 
6. SLOPE RATIOS (Finite Differences on Expected ERT)
2025-10-18 11:46:19,909 - utils.continuous_models - INFO -   word_length: SR = 1.447 (AMPLIFIED)
2025-10-18 11:46:19,949 - utils.continuous_models - INFO -   word_frequency_zipf: SR = 1.251 (AMPLIFIED)
2025-10-18 11:46:19,991 - utils.continuous_models - INFO -   surprisal: SR = 3.257 (AMPLIFIED)
2025-10-18 11:46:19,992 - utils.continuous_models - INFO - 
7. BOOTSTRAP CONFIDENCE INTERVALS
2025-10-18 11:46:19,992 - utils.continuous_models - INFO -   Computing bootstrap CIs (100 iterations)...
2025-10-18 11:46:42,267 - utils.gap_decomposition - INFO - ============================================================
2025-10-18 11:46:42,267 - utils.gap_decomposition - INFO - PART C: GAP DECOMPOSITION
2025-10-18 11:46:42,267 - utils.gap_decomposition - INFO - ============================================================
2025-10-18 11:46:42,367 - utils.gap_decomposition - INFO - Using common sample of 326,496 observations for all models
2025-10-18 11:46:42,368 - utils.gap_decomposition - INFO - 
Fitting M0 (main effects only)...
2025-10-18 11:46:42,368 - utils.gap_decomposition - INFO -   Formula: ERT_expected ~ dyslexic_int
2025-10-18 11:46:42,684 - utils.gap_decomposition - INFO -   M0 fitted successfully (OLS with clustered SEs)
2025-10-18 11:46:42,684 - utils.gap_decomposition - INFO - 
Fitting M1 (main effects only)...
2025-10-18 11:46:42,685 - utils.gap_decomposition - INFO -   Formula: ERT_expected ~ dyslexic_int + word_length_scaled
2025-10-18 11:46:42,994 - utils.gap_decomposition - INFO -   M1 fitted successfully (OLS with clustered SEs)
2025-10-18 11:46:42,994 - utils.gap_decomposition - INFO - 
Fitting M2 (main effects only)...
2025-10-18 11:46:42,994 - utils.gap_decomposition - INFO -   Formula: ERT_expected ~ dyslexic_int + word_length_scaled + word_frequency_zipf_scaled
2025-10-18 11:46:43,367 - utils.gap_decomposition - INFO -   M2 fitted successfully (OLS with clustered SEs)
2025-10-18 11:46:43,367 - utils.gap_decomposition - INFO - 
Fitting M3 (main effects only)...
2025-10-18 11:46:43,367 - utils.gap_decomposition - INFO -   Formula: ERT_expected ~ dyslexic_int + word_length_scaled + word_frequency_zipf_scaled + surprisal_scaled
2025-10-18 11:46:43,709 - utils.gap_decomposition - INFO -   M3 fitted successfully (OLS with clustered SEs)
2025-10-18 11:46:43,719 - utils.gap_decomposition - INFO - 
Computing observed gaps (actual group coefficients)...
2025-10-18 11:46:43,860 - utils.gap_decomposition - INFO -   M0: Observed gap = 133.03ms
2025-10-18 11:46:44,018 - utils.gap_decomposition - INFO -   M1: Observed gap = 133.03ms
2025-10-18 11:46:44,170 - utils.gap_decomposition - INFO -   M2: Observed gap = 133.03ms
2025-10-18 11:46:44,329 - utils.gap_decomposition - INFO -   M3: Observed gap = 133.03ms
2025-10-18 11:46:44,338 - utils.gap_decomposition - INFO - 
Computing composition gaps (covariate differences only)...
2025-10-18 11:46:44,493 - utils.gap_decomposition - INFO -   M0: Composition gap = -0.00ms
2025-10-18 11:46:44,672 - utils.gap_decomposition - INFO -   M1: Composition gap = 1.00ms
2025-10-18 11:46:44,850 - utils.gap_decomposition - INFO -   M2: Composition gap = 0.86ms
2025-10-18 11:46:45,031 - utils.gap_decomposition - INFO -   M3: Composition gap = 1.00ms
2025-10-18 11:46:45,049 - utils.gap_decomposition - INFO - 
Computing RÂ²...
2025-10-18 11:46:45,057 - utils.gap_decomposition - INFO -   M0: RÂ² = 0.2074
2025-10-18 11:46:45,063 - utils.gap_decomposition - INFO -   M1: RÂ² = 0.9267
2025-10-18 11:46:45,070 - utils.gap_decomposition - INFO -   M2: RÂ² = 0.9501
2025-10-18 11:46:45,076 - utils.gap_decomposition - INFO -   M3: RÂ² = 0.9608
2025-10-18 11:46:45,077 - utils.gap_decomposition - INFO - 
Fitting interaction models (Oaxaca/Blinder decomposition)...
2025-10-18 11:46:45,181 - utils.gap_decomposition - INFO -   Fitting M1_int...
2025-10-18 11:46:45,525 - utils.gap_decomposition - INFO -     M1_int fitted successfully
2025-10-18 11:46:45,588 - utils.gap_decomposition - INFO -   Fitting M2_int...
2025-10-18 11:46:45,956 - utils.gap_decomposition - INFO -     M2_int fitted successfully
2025-10-18 11:46:46,023 - utils.gap_decomposition - INFO -   Fitting M3_int...
2025-10-18 11:46:46,462 - utils.gap_decomposition - INFO -     M3_int fitted successfully
2025-10-18 11:46:46,470 - utils.gap_decomposition - INFO - 
Oaxaca/Blinder Decomposition:
2025-10-18 11:46:47,044 - utils.gap_decomposition - INFO -   Observed gap: 133.03ms
2025-10-18 11:46:47,044 - utils.gap_decomposition - INFO -   Composition effect: 1.00ms (0.8%)
2025-10-18 11:46:47,044 - utils.gap_decomposition - INFO -   Coefficient effect: 131.72ms (99.0%)
2025-10-18 11:46:47,045 - utils.gap_decomposition - INFO -   Residual: 0.30ms
2025-10-18 11:46:47,098 - utils.gap_decomposition - INFO - 
GAP DECOMPOSITION SUMMARY:
2025-10-18 11:46:47,098 - utils.gap_decomposition - INFO -   Observed baseline gap (M0): 133.03ms
2025-10-18 11:46:47,099 - utils.gap_decomposition - INFO -   Composition baseline gap: -0.00ms
2025-10-18 11:46:47,099 - utils.gap_decomposition - INFO -   M1: Observed=133.03ms, Composition=1.00ms, Explained=99.3%, ÎRÂ²=0.7193
2025-10-18 11:46:47,099 - utils.gap_decomposition - INFO -   M2: Observed=133.03ms, Composition=0.86ms, Explained=99.4%, ÎRÂ²=0.0233
2025-10-18 11:46:47,099 - utils.gap_decomposition - INFO -   M3: Observed=133.03ms, Composition=1.00ms, Explained=99.2%, ÎRÂ²=0.0107
2025-10-18 11:46:47,099 - utils.sensitivity_analysis - INFO - ============================================================
2025-10-18 11:46:47,100 - utils.sensitivity_analysis - INFO - SENSITIVITY ANALYSES
2025-10-18 11:46:47,100 - utils.sensitivity_analysis - INFO - ============================================================
2025-10-18 11:46:47,100 - utils.sensitivity_analysis - INFO - 
1. RESIDUALIZED SURPRISAL MODEL
2025-10-18 11:46:47,154 - utils.sensitivity_analysis - INFO -   Formula: ERT ~ dyslexic_int * (word_length_scaled + word_frequency_zipf_scaled + surprisal_resid)
2025-10-18 11:46:47,643 - utils.sensitivity_analysis - INFO -   Residualized surprisal: beta=11.6330, p=0.0000
2025-10-18 11:46:47,643 - utils.sensitivity_analysis - INFO -   [OK] Surprisal effect robust to frequency collinearity
2025-10-18 11:46:47,655 - utils.sensitivity_analysis - INFO - 
2. SUBJECT-WISE CROSS-VALIDATION
2025-10-18 11:46:47,655 - utils.sensitivity_analysis - INFO -   Running 10-fold subject-wise CV...
2025-10-18 11:46:47,881 - utils.sensitivity_analysis - INFO -     Fold 1/10
2025-10-18 11:46:48,438 - utils.sensitivity_analysis - INFO -     Fold 2/10
2025-10-18 11:46:49,013 - utils.sensitivity_analysis - INFO -     Fold 3/10
2025-10-18 11:46:49,704 - utils.sensitivity_analysis - INFO -     Fold 4/10
2025-10-18 11:46:50,269 - utils.sensitivity_analysis - INFO -     Fold 5/10
2025-10-18 11:46:50,899 - utils.sensitivity_analysis - INFO -     Fold 6/10
2025-10-18 11:46:52,044 - utils.sensitivity_analysis - INFO -     Fold 7/10
2025-10-18 11:46:52,584 - utils.sensitivity_analysis - INFO -     Fold 8/10
2025-10-18 11:46:53,128 - utils.sensitivity_analysis - INFO -     Fold 9/10
2025-10-18 11:46:53,701 - utils.sensitivity_analysis - INFO -     Fold 10/10
2025-10-18 11:46:54,272 - utils.sensitivity_analysis - INFO -   Cross-validation RÂ²: -0.3352 Â± 0.2999
2025-10-18 11:46:54,272 - utils.sensitivity_analysis - INFO -   Based on 10 successful folds
2025-10-18 11:46:54,312 - utils.sensitivity_analysis - INFO - 
3. ALTERNATIVE BINNING (Terciles & Quintiles)
2025-10-18 11:46:54,313 - utils.sensitivity_analysis - INFO - 
  Testing terciles...
2025-10-18 11:46:54,431 - utils.sensitivity_analysis - INFO -     word_length: Control Î=202.4ms, Dyslexic Î=304.4ms
2025-10-18 11:46:54,533 - utils.sensitivity_analysis - INFO -     word_frequency_zipf: Control Î=-187.4ms, Dyslexic Î=-283.4ms
2025-10-18 11:46:54,635 - utils.sensitivity_analysis - INFO -     surprisal: Control Î=112.9ms, Dyslexic Î=200.7ms
2025-10-18 11:46:54,635 - utils.sensitivity_analysis - INFO - 
  Testing quintiles...
2025-10-18 11:46:54,711 - utils.sensitivity_analysis - INFO -     word_length: Control Î=284.7ms, Dyslexic Î=452.5ms
2025-10-18 11:46:54,787 - utils.sensitivity_analysis - INFO -     word_frequency_zipf: Control Î=-242.1ms, Dyslexic Î=-393.1ms
2025-10-18 11:46:54,867 - utils.sensitivity_analysis - INFO -     surprisal: Control Î=150.5ms, Dyslexic Î=270.2ms
2025-10-18 11:46:54,873 - utils.hypothesis_visualization - INFO - ============================================================
2025-10-18 11:46:54,873 - utils.hypothesis_visualization - INFO - CREATING VISUALIZATIONS
2025-10-18 11:46:54,873 - utils.hypothesis_visualization - INFO - ============================================================
2025-10-18 11:46:54,873 - utils.hypothesis_visualization - INFO - 
1. Continuous effect curves...
2025-10-18 11:46:55,972 - utils.hypothesis_visualization - INFO -   Saved to results\continuous_effects_with_quartiles.png
2025-10-18 11:46:55,975 - utils.hypothesis_visualization - INFO - 2. Gap decomposition...
2025-10-18 11:46:55,975 - utils.hypothesis_visualization - WARNING - No gap results available
2025-10-18 11:46:55,975 - utils.hypothesis_visualization - INFO - 3. Slope ratios...
2025-10-18 11:46:56,265 - utils.hypothesis_visualization - INFO -   Saved to results\slope_ratios.png
2025-10-18 11:46:56,265 - utils.hypothesis_visualization - INFO - 4. Model comparison...
2025-10-18 11:46:56,280 - matplotlib.category - INFO - Using categorical units to plot a list of strings that are all parsable as floats or dates. If these strings should be plotted as numbers, cast to the appropriate data type before plotting.
2025-10-18 11:46:56,282 - matplotlib.category - INFO - Using categorical units to plot a list of strings that are all parsable as floats or dates. If these strings should be plotted as numbers, cast to the appropriate data type before plotting.
2025-10-18 11:46:56,645 - utils.hypothesis_visualization - INFO -   Saved to results\model_comparison.png
2025-10-18 11:46:56,645 - utils.hypothesis_visualization - INFO - 5. Quartile effects...
2025-10-18 11:46:57,229 - utils.hypothesis_visualization - INFO -   Saved to results\quartile_effects.png
2025-10-18 11:46:57,229 - utils.hypothesis_visualization - INFO - 6. Predicted vs observed...
2025-10-18 11:46:58,105 - utils.hypothesis_visualization - INFO -   Saved to results\predicted_vs_observed.png
2025-10-18 11:46:58,106 - utils.hypothesis_visualization - INFO - 
All visualizations saved to results
2025-10-18 11:46:58,106 - utils.results_reporting - INFO - ============================================================
2025-10-18 11:46:58,106 - utils.results_reporting - INFO - GENERATING RESULTS REPORT
2025-10-18 11:46:58,106 - utils.results_reporting - INFO - ============================================================
2025-10-18 11:46:58,108 - utils.results_reporting - INFO - 
Testing Hypothesis 1: Feature effects on reading time
2025-10-18 11:46:58,109 - utils.results_reporting - INFO -   Length: beta=0.1222, p=0.0000 - CONFIRMED
2025-10-18 11:46:58,109 - utils.results_reporting - INFO -   Frequency: beta=-0.0486, p=0.0000 - CONFIRMED
2025-10-18 11:46:58,109 - utils.results_reporting - INFO -   Surprisal: beta=0.0317, p=0.0000 - CONFIRMED
2025-10-18 11:46:58,109 - utils.results_reporting - INFO - 
Hypothesis 1: CONFIRMED
2025-10-18 11:46:58,109 - utils.results_reporting - INFO - 
Testing Hypothesis 2: Dyslexic amplification
2025-10-18 11:46:58,109 - utils.results_reporting - INFO - 
Hypothesis 2: CONFIRMED
2025-10-18 11:46:58,110 - utils.results_reporting - INFO - 
Testing Hypothesis 3: Gap explanation
2025-10-18 11:46:58,110 - utils.results_reporting - INFO - 
================================================================================
2025-10-18 11:46:58,110 - utils.results_reporting - INFO - HYPOTHESIS TESTING RESULTS SUMMARY
2025-10-18 11:46:58,110 - utils.results_reporting - INFO - ================================================================================
2025-10-18 11:46:58,111 - utils.results_reporting - INFO - 
HYPOTHESIS 1: CONFIRMED
2025-10-18 11:46:58,111 - utils.results_reporting - INFO -   All features predict reading time in expected directions
2025-10-18 11:46:58,111 - utils.results_reporting - INFO - 
HYPOTHESIS 2: CONFIRMED
2025-10-18 11:46:58,111 - utils.results_reporting - INFO -   All features show dyslexic amplification (SR > 1)
2025-10-18 11:46:58,111 - utils.results_reporting - INFO - 
HYPOTHESIS 3: FAILED
2025-10-18 11:46:58,111 - utils.results_reporting - INFO -   Gap decomposition failed - no baseline gap computed
2025-10-18 11:46:58,112 - utils.results_reporting - INFO - 
OVERALL: ALL HYPOTHESES CONFIRMED
2025-10-18 11:46:58,112 - utils.results_reporting - INFO - 
Key Findings:
2025-10-18 11:46:58,112 - utils.results_reporting - INFO -   â¢ 3/3 features show dyslexic amplification
2025-10-18 11:46:58,112 - utils.results_reporting - INFO -   â¢ Features explain 99.2% of group gap
2025-10-18 11:46:58,112 - utils.results_reporting - INFO -   â¢ Effects consistent across multiple analyses
2025-10-18 11:46:58,112 - utils.results_reporting - INFO - Report generation complete
2025-10-18 11:46:58,113 - utils.misc_utils - INFO - Results saved to results\hypothesis_testing_results.json
2025-10-18 11:46:58,114 - __main__ - INFO - 
Hypothesis testing complete! Results saved to results
2025-10-18 11:51:05,935 - __main__ - INFO - Exiting...
2025-10-18 11:51:05,935 - __main__ - INFO - Analysis complete!
2025-10-18 13:58:40,796 - __main__ - INFO - Dyslexia Time Analysis Pipeline initialized
2025-10-18 13:58:40,797 - __main__ - INFO - Dyslexia Time Analysis Pipeline initialized
2025-10-18 13:58:43,736 - __main__ - INFO - Running hypothesis testing analysis...
2025-10-18 13:58:43,736 - __main__ - INFO - ================================================================================
2025-10-18 13:58:43,736 - __main__ - INFO - HYPOTHESIS TESTING ANALYSIS
2025-10-18 13:58:43,736 - __main__ - INFO - ================================================================================
2025-10-18 13:58:43,737 - __main__ - INFO - Loading CopCo dataset...
2025-10-18 13:58:43,746 - utils.data_utils - INFO - Loading 57 participant files...
2025-10-18 13:58:45,530 - utils.data_utils - INFO - Starting with 335,203 total word entries
2025-10-18 13:58:45,735 - utils.data_utils - INFO - Word fixation patterns:
2025-10-18 13:58:45,735 - utils.data_utils - INFO -   - Skipped words (0 fixations): 126,302
2025-10-18 13:58:45,735 - utils.data_utils - INFO -   - Fixated words (1+ fixations): 208,901
2025-10-18 13:58:45,735 - utils.data_utils - INFO -   - Unknown fixations (NaN): 0
2025-10-18 13:58:45,773 - utils.data_utils - INFO - Fixated words reading times: median 272ms, 99th percentile 1777ms
2025-10-18 13:58:45,775 - utils.data_utils - INFO - Removed 14 fixated words with extreme reading times (0 too short, 14 too long)
2025-10-18 13:58:45,895 - utils.data_utils - INFO - Removed 23 words longer than 30 characters (likely data errors)
2025-10-18 13:58:45,935 - utils.data_utils - INFO - Final dataset: 126,302 skipped words, 208,864 fixated words
2025-10-18 13:58:45,935 - utils.data_utils - INFO - Data cleaning complete: 335,166 words retained (100.0% of original)
2025-10-18 13:58:45,946 - utils.data_utils - INFO - Groups identified: 19 dyslexic, 39 control
2025-10-18 13:58:46,018 - __main__ - INFO - Calculating skipping probabilities...
2025-10-18 13:58:46,022 - utils.skipping_utils - INFO - Skipping analysis from ExtractedFeatures:
2025-10-18 13:58:46,022 - utils.skipping_utils - INFO -   Total words: 335,166
2025-10-18 13:58:46,022 - utils.skipping_utils - INFO -   Skipped: 126,302 (37.7%)
2025-10-18 13:58:46,022 - utils.skipping_utils - INFO -   Fixated: 208,864 (62.3%)
2025-10-18 13:58:46,073 - __main__ - INFO - Skipping analysis: 37.7% overall rate
2025-10-18 13:58:46,091 - __main__ - INFO - Loaded: 335,166 words from 57 participants
2025-10-18 13:58:46,091 - __main__ - INFO - ============================================================
2025-10-18 13:58:46,091 - __main__ - INFO - COMPUTING LINGUISTIC FEATURES
2025-10-18 13:58:46,092 - __main__ - INFO - ============================================================
2025-10-18 13:58:46,092 - utils.linguistic_features - INFO - Loading Danish frequency list from danish_frequencies\danish_leipzig_for_analysis.txt
2025-10-18 13:58:47,747 - utils.linguistic_features - WARNING - Found 2 duplicate words after lowercasing. 
2025-10-18 13:58:48,230 - utils.linguistic_features - INFO - Loaded 1,499,999 word proportions from Leipzig Corpora
2025-10-18 13:58:48,318 - utils.linguistic_features - INFO - Computing word frequency...
2025-10-18 13:58:48,318 - utils.linguistic_features - INFO -   Stripping punctuation from words before frequency lookup
2025-10-18 13:58:49,018 - utils.linguistic_features - INFO - 13 missing word instances were punctuation-only
2025-10-18 13:58:49,019 - utils.linguistic_features - WARNING - 4,586 word instances (1.4%) not found in frequency list (197 unique valid words)
2025-10-18 13:58:49,019 - utils.linguistic_features - INFO - Sample of 197 missing valid words: ['1926-2016', '2. (margrethe', 'adunyadet', 'af christian', 'af imperialismen', 'af j.j', 'af kong', 'affaldspolitikken', 'amokkacino', 'april 1940 pÃ¥ amalienborg', 'bjergstien', 'blotgydje', 'certeau', 'chakri-dynasti', 'cochallenge', 'dallis', 'dambrugsomrÃ¥det', 'frederik og prins', 'frederiksavn', 'frejakult', 'fÃ¸rste krigsminister, a.f', 'go-to-ting', 'grÃ¦ssteppefugl', 'hejre (bromus', 'heksejagte', 'i grÃ¦s-familien', 'idahot-forum', 'intersex-inkluderende', 'isotropic', 'it-mulighederne', 'jernalderkulturen', 'kabeltromlerne', 'kaldet lemma', 'leartesâs', 'lgbtqi-personer', 'livsresultat', 'lysfester', 'magteslÃ¸ses', 'morgensamlingsudvalget', 'naturlovgivning', 'nul-fejlkultur', 'renÃ¦ssancekongen', 'sankthansormen', 'spejder-juniorer', 'spÃ¡kona', 'statsminister fra', 'tilran', 'top-omstillingsparate', 'traume for', 'tusindÃ¥rsfornemmelser']... (147 more)
2025-10-18 13:58:49,025 - utils.linguistic_features - INFO - Excluding 4,599 word instances (1.4%) with missing frequencies from analysis
2025-10-18 13:58:49,139 - utils.linguistic_features - INFO - Remaining dataset: 330,567 words
2025-10-18 13:58:49,140 - utils.linguistic_features - INFO - Final dataset: 330,567 words with valid frequencies
2025-10-18 13:58:53,965 - utils.linguistic_features - INFO - Loading causal language model: KennethTM/gpt2-medium-danish
2025-10-18 13:58:55,628 - utils.linguistic_features - INFO - Using CPU for surprisal computation
2025-10-18 13:58:55,628 - utils.linguistic_features - INFO - Causal language model loaded successfully
2025-10-18 13:58:55,628 - utils.linguistic_features - INFO - Computing surprisal with causal GPT-2 (left-to-right)...
2025-10-18 13:58:57,010 - utils.linguistic_features - INFO - Dataset statistics:
2025-10-18 13:58:57,010 - utils.linguistic_features - INFO -   Total participant-sentence instances: 20,707
2025-10-18 13:58:57,011 - utils.linguistic_features - INFO -   Unique sentence texts: 1,986
2025-10-18 13:58:57,011 - utils.linguistic_features - INFO -   Average participants per sentence: 10.4
2025-10-18 13:58:57,011 - utils.linguistic_features - INFO - Loading cached surprisal values from word_surprisal\surprisal_cache_gpt2.pkl
2025-10-18 13:58:57,023 - utils.linguistic_features - INFO - Loaded surprisal for 1,986 unique sentences
2025-10-18 13:58:57,025 - utils.linguistic_features - INFO - Broadcasting surprisal values to all participant instances...
2025-10-18 13:58:57,025 - utils.linguistic_features - INFO -   Mapping surprisal to words...
2025-10-18 13:59:00,316 - utils.linguistic_features - INFO -   Mapped 326,496 words
2025-10-18 13:59:00,318 - utils.linguistic_features - INFO - 
Surprisal Computation Results:
2025-10-18 13:59:00,318 - utils.linguistic_features - INFO -   Unique sentences processed: 1,986
2025-10-18 13:59:00,318 - utils.linguistic_features - INFO -   Total words with surprisal: 326,496 / 330,567
2025-10-18 13:59:00,319 - utils.linguistic_features - INFO -   Mean: 6.93 bits
2025-10-18 13:59:00,322 - utils.linguistic_features - INFO -   Median: 5.69 bits
2025-10-18 13:59:00,324 - utils.linguistic_features - INFO -   Std: 5.55 bits
2025-10-18 13:59:00,324 - utils.linguistic_features - INFO -   Range: [0.00, 59.34] bits
2025-10-18 13:59:00,341 - utils.linguistic_features - INFO - Linguistic features added successfully
2025-10-18 13:59:00,342 - utils.linguistic_features - INFO - 
Feature Summary:
2025-10-18 13:59:00,344 - utils.linguistic_features - INFO -   Word length: mean=4.67, std=3.08
2025-10-18 13:59:00,347 - utils.linguistic_features - INFO -   Zipf frequency: mean=5.85, std=1.38, range=[0.91, 7.51]
2025-10-18 13:59:00,350 - utils.linguistic_features - INFO -   Surprisal: mean=6.93, std=5.55
2025-10-18 13:59:00,358 - utils.hypothesis_testing_utils - INFO - Preparing data for hypothesis testing...
2025-10-18 13:59:00,414 - utils.hypothesis_testing_utils - INFO - Creating ERT variable...
2025-10-18 13:59:00,418 - utils.hypothesis_testing_utils - INFO -   ERT created: 123,666 skipped (0ms), 206,901 fixated
2025-10-18 13:59:00,418 - utils.hypothesis_testing_utils - INFO - Centering and scaling predictors...
2025-10-18 13:59:00,435 - utils.hypothesis_testing_utils - INFO -   word_length: mean=4.67, scale=3.08
2025-10-18 13:59:00,449 - utils.hypothesis_testing_utils - INFO -   word_frequency_zipf: mean=5.85, scale=1.38
2025-10-18 13:59:00,463 - utils.hypothesis_testing_utils - INFO -   surprisal: mean=6.93, scale=5.55
2025-10-18 13:59:00,463 - utils.hypothesis_testing_utils - INFO - Checking collinearity (VIF)...
2025-10-18 13:59:00,577 - utils.hypothesis_testing_utils - INFO - VIF Results:
2025-10-18 13:59:00,578 - utils.hypothesis_testing_utils - INFO -   Length: 2.82 (OK)
2025-10-18 13:59:00,578 - utils.hypothesis_testing_utils - INFO -   Frequency: 3.18 (OK)
2025-10-18 13:59:00,578 - utils.hypothesis_testing_utils - INFO -   Surprisal: 1.41 (OK)
2025-10-18 13:59:00,580 - utils.hypothesis_testing_utils - INFO - Creating residualized surprisal...
2025-10-18 13:59:00,595 - utils.hypothesis_testing_utils - INFO -   Correlation (Frequency-Surprisal): r=-0.539
2025-10-18 13:59:00,595 - utils.hypothesis_testing_utils - INFO -   Residualized surprisal created
2025-10-18 13:59:00,596 - utils.hypothesis_testing_utils - INFO - Defining pooled quartiles...
2025-10-18 13:59:00,609 - utils.hypothesis_testing_utils - INFO -   word_length: Q1=2.00, Q3=6.00
2025-10-18 13:59:00,622 - utils.hypothesis_testing_utils - INFO -   word_frequency_zipf: Q1=4.91, Q3=7.10
2025-10-18 13:59:00,636 - utils.hypothesis_testing_utils - INFO -   surprisal: Q1=2.76, Q3=9.97
2025-10-18 13:59:00,636 - utils.hypothesis_testing_utils - INFO - Data preparation complete: 330,567 words ready for analysis
2025-10-18 13:59:00,650 - utils.quartile_analysis - INFO - ============================================================
2025-10-18 13:59:00,650 - utils.quartile_analysis - INFO - PART A: QUARTILE ANALYSIS (Q1 vs Q3)
2025-10-18 13:59:00,650 - utils.quartile_analysis - INFO - ============================================================
2025-10-18 13:59:00,650 - utils.quartile_analysis - INFO - 
Analyzing word_length...
2025-10-18 13:59:01,497 - utils.quartile_analysis - INFO -   Computed means for 57 participants
2025-10-18 13:59:01,498 - utils.quartile_analysis - INFO -     Control Q3-Q1: 259.7ms
2025-10-18 13:59:01,498 - utils.quartile_analysis - INFO -     Dyslexic Q3-Q1: 442.6ms
2025-10-18 13:59:01,557 - utils.quartile_analysis - INFO -   Fitting mixed model on 152,465 words...
2025-10-18 13:59:02,170 - utils.quartile_analysis - INFO -   GroupÃBin interaction: beta=134.79, p=0.0000
2025-10-18 13:59:02,201 - utils.quartile_analysis - INFO -   Computing bootstrap CIs (1000 iterations)...
2025-10-18 13:59:03,977 - utils.quartile_analysis - INFO -   Bootstrap 95% CI for interaction: [98.47, 259.71]
2025-10-18 13:59:03,978 - utils.quartile_analysis - INFO - 
Analyzing word_frequency_zipf...
2025-10-18 13:59:04,815 - utils.quartile_analysis - INFO -   Computed means for 57 participants
2025-10-18 13:59:04,816 - utils.quartile_analysis - INFO -     Control Q3-Q1: -225.9ms
2025-10-18 13:59:04,816 - utils.quartile_analysis - INFO -     Dyslexic Q3-Q1: -388.2ms
2025-10-18 13:59:04,878 - utils.quartile_analysis - INFO -   Fitting mixed model on 162,606 words...
2025-10-18 13:59:07,927 - utils.quartile_analysis - INFO -   GroupÃBin interaction: beta=-122.40, p=0.0000
2025-10-18 13:59:07,961 - utils.quartile_analysis - INFO -   Computing bootstrap CIs (1000 iterations)...
2025-10-18 13:59:09,755 - utils.quartile_analysis - INFO -   Bootstrap 95% CI for interaction: [-225.59, -87.90]
2025-10-18 13:59:09,756 - utils.quartile_analysis - INFO - 
Analyzing surprisal...
2025-10-18 13:59:10,602 - utils.quartile_analysis - INFO -   Computed means for 57 participants
2025-10-18 13:59:10,603 - utils.quartile_analysis - INFO -     Control Q3-Q1: 135.8ms
2025-10-18 13:59:10,603 - utils.quartile_analysis - INFO -     Dyslexic Q3-Q1: 277.3ms
2025-10-18 13:59:10,667 - utils.quartile_analysis - INFO -   Fitting mixed model on 163,257 words...
2025-10-18 13:59:13,500 - utils.quartile_analysis - INFO -   GroupÃBin interaction: beta=105.53, p=0.0000
2025-10-18 13:59:13,535 - utils.quartile_analysis - INFO -   Computing bootstrap CIs (1000 iterations)...
2025-10-18 13:59:15,381 - utils.quartile_analysis - INFO -   Bootstrap 95% CI for interaction: [84.99, 194.82]
2025-10-18 13:59:15,381 - utils.continuous_models - INFO - ============================================================
2025-10-18 13:59:15,382 - utils.continuous_models - INFO - PART B: CONTINUOUS MODELS (TWO-PART)
2025-10-18 13:59:15,382 - utils.continuous_models - INFO - ============================================================
2025-10-18 13:59:15,382 - utils.continuous_models - INFO - 
1. SKIPPING MODEL (Logistic with Clustered SEs)
2025-10-18 13:59:15,506 - utils.continuous_models - INFO -   Formula: skipped ~ dyslexic_int * (word_length_scaled + word_frequency_zipf_scaled + surprisal_scaled)
2025-10-18 13:59:15,506 - utils.continuous_models - INFO -   Fitting on 326,496 words...
2025-10-18 13:59:16,459 - utils.continuous_models - INFO -   Model fitted successfully with clustered SEs
2025-10-18 13:59:16,461 - utils.continuous_models - INFO -     dyslexic_int:word_length_scaled: beta=-0.0250, p=0.6714
2025-10-18 13:59:16,461 - utils.continuous_models - INFO -     dyslexic_int:word_frequency_zipf_scaled: beta=-0.0640, p=0.1975
2025-10-18 13:59:16,461 - utils.continuous_models - INFO -     dyslexic_int:surprisal_scaled: beta=-0.0272, p=0.2667
2025-10-18 13:59:16,473 - utils.continuous_models - INFO - 
2. DURATION MODEL (Log-TRT | Fixated)
2025-10-18 13:59:16,598 - utils.continuous_models - INFO -   Formula: log_TRT ~ dyslexic_int * (word_length_scaled + word_frequency_zipf_scaled + surprisal_scaled)
2025-10-18 13:59:16,599 - utils.continuous_models - INFO -   Fitting on 204,224 fixated words...
2025-10-18 13:59:17,719 - utils.continuous_models - INFO -   Model fitted successfully
2025-10-18 13:59:17,719 - utils.continuous_models - INFO -   Smearing correction factor: 1.1562
2025-10-18 13:59:17,720 - utils.continuous_models - INFO -     dyslexic_int:word_length_scaled: beta=0.0078, p=0.0585
2025-10-18 13:59:17,720 - utils.continuous_models - INFO -     dyslexic_int:word_frequency_zipf_scaled: beta=-0.0084, p=0.0678
2025-10-18 13:59:17,720 - utils.continuous_models - INFO -     dyslexic_int:surprisal_scaled: beta=0.0349, p=0.0000
2025-10-18 13:59:17,728 - utils.continuous_models - INFO - 
3. PREDICTING EXPECTED ERT
2025-10-18 13:59:17,781 - utils.continuous_models - INFO -   Predicting expected ERT...
2025-10-18 13:59:18,047 - utils.continuous_models - INFO -   Predicted expected ERT for 326,496 words
2025-10-18 13:59:18,049 - utils.continuous_models - INFO -     Mean expected ERT: 228.71ms
2025-10-18 13:59:18,050 - utils.continuous_models - INFO -     Mean observed ERT: 236.03ms
2025-10-18 13:59:18,059 - utils.continuous_models - INFO - 
4. VARIANCE EXPLAINED (ÎRÂ² on Expected ERT)
2025-10-18 13:59:18,172 - utils.continuous_models - INFO -   Computing ÎRÂ² on 326,496 observations
2025-10-18 13:59:18,522 - utils.continuous_models - INFO -     M0: RÂ² = 0.2074
2025-10-18 13:59:18,894 - utils.continuous_models - INFO -     M1: RÂ² = 0.9267
2025-10-18 13:59:19,361 - utils.continuous_models - INFO -     M2: RÂ² = 0.9501
2025-10-18 13:59:19,815 - utils.continuous_models - INFO -     M3: RÂ² = 0.9608
2025-10-18 13:59:19,815 - utils.continuous_models - INFO - 
  Variance Explained (ÎRÂ²):
2025-10-18 13:59:19,815 - utils.continuous_models - INFO -     Length: ÎRÂ² = 0.7193 (71.93%)
2025-10-18 13:59:19,815 - utils.continuous_models - INFO -     Frequency: ÎRÂ² = 0.0233 (2.33%)
2025-10-18 13:59:19,816 - utils.continuous_models - INFO -     Surprisal: ÎRÂ² = 0.0107 (1.07%)
2025-10-18 13:59:19,842 - utils.continuous_models - INFO - 
5. MS SHIFTS (Q1âQ3 on Expected ERT)
2025-10-18 13:59:19,849 - utils.continuous_models - INFO - 
  word_length: Q1=2.00, Q3=6.00
2025-10-18 13:59:19,871 - utils.continuous_models - INFO -     Control: 136.3ms -> 220.5ms (Î = 84.1ms)
2025-10-18 13:59:19,890 - utils.continuous_models - INFO -     Dyslexic: 239.3ms -> 361.0ms (Î = 121.7ms)
2025-10-18 13:59:19,899 - utils.continuous_models - INFO - 
  word_frequency_zipf: Q1=4.91, Q3=7.10
2025-10-18 13:59:19,924 - utils.continuous_models - INFO -     Control: 209.3ms -> 167.5ms (Î = -41.8ms)
2025-10-18 13:59:19,945 - utils.continuous_models - INFO -     Dyslexic: 342.6ms -> 290.3ms (Î = -52.3ms)
2025-10-18 13:59:19,956 - utils.continuous_models - INFO - 
  surprisal: Q1=2.76, Q3=9.97
2025-10-18 13:59:19,981 - utils.continuous_models - INFO -     Control: 185.2ms -> 195.4ms (Î = 10.2ms)
2025-10-18 13:59:19,999 - utils.continuous_models - INFO -     Dyslexic: 300.9ms -> 334.1ms (Î = 33.3ms)
2025-10-18 13:59:19,999 - utils.continuous_models - INFO - 
6. SLOPE RATIOS (Finite Differences on Expected ERT)
2025-10-18 13:59:20,039 - utils.continuous_models - INFO -   word_length: SR = 1.447 (AMPLIFIED)
2025-10-18 13:59:20,081 - utils.continuous_models - INFO -   word_frequency_zipf: SR = 1.251 (AMPLIFIED)
2025-10-18 13:59:20,123 - utils.continuous_models - INFO -   surprisal: SR = 3.257 (AMPLIFIED)
2025-10-18 13:59:20,124 - utils.continuous_models - INFO - 
7. BOOTSTRAP CONFIDENCE INTERVALS
2025-10-18 13:59:20,124 - utils.continuous_models - INFO -   Computing bootstrap CIs (100 iterations)...
2025-10-18 13:59:44,141 - utils.gap_decomposition - INFO - ============================================================
2025-10-18 13:59:44,141 - utils.gap_decomposition - INFO - PART C: GAP DECOMPOSITION (ON OBSERVED ERT)
2025-10-18 13:59:44,141 - utils.gap_decomposition - INFO - ============================================================
2025-10-18 13:59:44,249 - utils.gap_decomposition - INFO - Using common sample of 326,496 observations for all models
2025-10-18 13:59:44,249 - utils.gap_decomposition - INFO - 
Fitting M0 (main effects only)...
2025-10-18 13:59:44,250 - utils.gap_decomposition - INFO -   Formula: ERT_expected ~ dyslexic_int
2025-10-18 13:59:44,562 - utils.gap_decomposition - INFO -   M0 fitted successfully (OLS with clustered SEs)
2025-10-18 13:59:44,562 - utils.gap_decomposition - INFO - 
Fitting M1 (main effects only)...
2025-10-18 13:59:44,562 - utils.gap_decomposition - INFO -   Formula: ERT_expected ~ dyslexic_int + word_length_scaled
2025-10-18 13:59:44,895 - utils.gap_decomposition - INFO -   M1 fitted successfully (OLS with clustered SEs)
2025-10-18 13:59:44,895 - utils.gap_decomposition - INFO - 
Fitting M2 (main effects only)...
2025-10-18 13:59:44,895 - utils.gap_decomposition - INFO -   Formula: ERT_expected ~ dyslexic_int + word_length_scaled + word_frequency_zipf_scaled
2025-10-18 13:59:45,292 - utils.gap_decomposition - INFO -   M2 fitted successfully (OLS with clustered SEs)
2025-10-18 13:59:45,293 - utils.gap_decomposition - INFO - 
Fitting M3 (main effects only)...
2025-10-18 13:59:45,293 - utils.gap_decomposition - INFO -   Formula: ERT_expected ~ dyslexic_int + word_length_scaled + word_frequency_zipf_scaled + surprisal_scaled
2025-10-18 13:59:45,690 - utils.gap_decomposition - INFO -   M3 fitted successfully (OLS with clustered SEs)
2025-10-18 13:59:45,699 - utils.gap_decomposition - INFO - 
Computing gaps on OBSERVED ERT (not model predictions)...
2025-10-18 13:59:45,700 - utils.gap_decomposition - INFO -   Computing gaps on observed ERT...
2025-10-18 13:59:45,903 - utils.gap_decomposition - INFO -     M0: Gap = 133.03ms
2025-10-18 13:59:46,120 - utils.gap_decomposition - INFO -     M1: Gap = 132.03ms
2025-10-18 13:59:46,372 - utils.gap_decomposition - INFO -     M2: Gap = 132.16ms
2025-10-18 13:59:46,653 - utils.gap_decomposition - INFO -     M3: Gap = 132.02ms
2025-10-18 13:59:46,678 - utils.gap_decomposition - INFO -   Computing composition gaps...
2025-10-18 13:59:46,877 - utils.gap_decomposition - INFO -     M0: Composition gap = -0.00ms
2025-10-18 13:59:47,083 - utils.gap_decomposition - INFO -     M1: Composition gap = 1.00ms
2025-10-18 13:59:47,311 - utils.gap_decomposition - INFO -     M2: Composition gap = 0.86ms
2025-10-18 13:59:47,528 - utils.gap_decomposition - INFO -     M3: Composition gap = 1.00ms
2025-10-18 13:59:47,549 - utils.gap_decomposition - INFO -   Computing RÂ² on observed ERT...
2025-10-18 13:59:47,558 - utils.gap_decomposition - INFO -     M0: RÂ² = 0.0348
2025-10-18 13:59:47,568 - utils.gap_decomposition - INFO -     M1: RÂ² = 0.1599
2025-10-18 13:59:47,576 - utils.gap_decomposition - INFO -     M2: RÂ² = 0.1638
2025-10-18 13:59:47,584 - utils.gap_decomposition - INFO -     M3: RÂ² = 0.1656
2025-10-18 13:59:47,584 - utils.gap_decomposition - INFO - 
Fitting interaction models...
2025-10-18 13:59:47,690 - utils.gap_decomposition - INFO -   Fitting M1_int...
2025-10-18 13:59:48,047 - utils.gap_decomposition - INFO -     M1_int fitted successfully
2025-10-18 13:59:48,107 - utils.gap_decomposition - INFO -   Fitting M2_int...
2025-10-18 13:59:48,539 - utils.gap_decomposition - INFO -     M2_int fitted successfully
2025-10-18 13:59:48,611 - utils.gap_decomposition - INFO -   Fitting M3_int...
2025-10-18 13:59:49,167 - utils.gap_decomposition - INFO -     M3_int fitted successfully
2025-10-18 13:59:49,177 - __main__ - ERROR - Pipeline failed: name 'decompose_gap_oaxaca_observed' is not defined
Traceback (most recent call last):
  File "C:\Users\hugos\Desktop\Dyslexia_Time_Paper\Dyslexia_Time_Cost_Analysis\main.py", line 759, in main
    pipeline.run_hypothesis_testing_analysis()  # NEW
  File "C:\Users\hugos\Desktop\Dyslexia_Time_Paper\Dyslexia_Time_Cost_Analysis\main.py", line 428, in run_hypothesis_testing_analysis
    gap_results = run_gap_decomposition(continuous_results["predictions"])
  File "C:\Users\hugos\Desktop\Dyslexia_Time_Paper\Dyslexia_Time_Cost_Analysis\utils\gap_decomposition.py", line 64, in run_gap_decomposition
    decomposition = decompose_gap_oaxaca_observed(data, models, interaction_models)
NameError: name 'decompose_gap_oaxaca_observed' is not defined
2025-10-18 14:03:43,317 - __main__ - INFO - Dyslexia Time Analysis Pipeline initialized
2025-10-18 14:03:43,317 - __main__ - INFO - Dyslexia Time Analysis Pipeline initialized
2025-10-18 14:03:45,636 - __main__ - INFO - Running hypothesis testing analysis...
2025-10-18 14:03:45,636 - __main__ - INFO - ================================================================================
2025-10-18 14:03:45,637 - __main__ - INFO - HYPOTHESIS TESTING ANALYSIS
2025-10-18 14:03:45,637 - __main__ - INFO - ================================================================================
2025-10-18 14:03:45,637 - __main__ - INFO - Loading CopCo dataset...
2025-10-18 14:03:45,638 - utils.data_utils - INFO - Loading 57 participant files...
2025-10-18 14:03:47,368 - utils.data_utils - INFO - Starting with 335,203 total word entries
2025-10-18 14:03:47,546 - utils.data_utils - INFO - Word fixation patterns:
2025-10-18 14:03:47,546 - utils.data_utils - INFO -   - Skipped words (0 fixations): 126,302
2025-10-18 14:03:47,547 - utils.data_utils - INFO -   - Fixated words (1+ fixations): 208,901
2025-10-18 14:03:47,547 - utils.data_utils - INFO -   - Unknown fixations (NaN): 0
2025-10-18 14:03:47,579 - utils.data_utils - INFO - Fixated words reading times: median 272ms, 99th percentile 1777ms
2025-10-18 14:03:47,582 - utils.data_utils - INFO - Removed 14 fixated words with extreme reading times (0 too short, 14 too long)
2025-10-18 14:03:47,682 - utils.data_utils - INFO - Removed 23 words longer than 30 characters (likely data errors)
2025-10-18 14:03:47,722 - utils.data_utils - INFO - Final dataset: 126,302 skipped words, 208,864 fixated words
2025-10-18 14:03:47,723 - utils.data_utils - INFO - Data cleaning complete: 335,166 words retained (100.0% of original)
2025-10-18 14:03:47,731 - utils.data_utils - INFO - Groups identified: 19 dyslexic, 39 control
2025-10-18 14:03:47,804 - __main__ - INFO - Calculating skipping probabilities...
2025-10-18 14:03:47,807 - utils.skipping_utils - INFO - Skipping analysis from ExtractedFeatures:
2025-10-18 14:03:47,808 - utils.skipping_utils - INFO -   Total words: 335,166
2025-10-18 14:03:47,808 - utils.skipping_utils - INFO -   Skipped: 126,302 (37.7%)
2025-10-18 14:03:47,808 - utils.skipping_utils - INFO -   Fixated: 208,864 (62.3%)
2025-10-18 14:03:47,847 - __main__ - INFO - Skipping analysis: 37.7% overall rate
2025-10-18 14:03:47,862 - __main__ - INFO - Loaded: 335,166 words from 57 participants
2025-10-18 14:03:47,863 - __main__ - INFO - ============================================================
2025-10-18 14:03:47,863 - __main__ - INFO - COMPUTING LINGUISTIC FEATURES
2025-10-18 14:03:47,863 - __main__ - INFO - ============================================================
2025-10-18 14:03:47,864 - utils.linguistic_features - INFO - Loading Danish frequency list from danish_frequencies\danish_leipzig_for_analysis.txt
2025-10-18 14:03:49,257 - utils.linguistic_features - WARNING - Found 2 duplicate words after lowercasing. 
2025-10-18 14:03:49,623 - utils.linguistic_features - INFO - Loaded 1,499,999 word proportions from Leipzig Corpora
2025-10-18 14:03:49,701 - utils.linguistic_features - INFO - Computing word frequency...
2025-10-18 14:03:49,701 - utils.linguistic_features - INFO -   Stripping punctuation from words before frequency lookup
2025-10-18 14:03:50,363 - utils.linguistic_features - INFO - 13 missing word instances were punctuation-only
2025-10-18 14:03:50,363 - utils.linguistic_features - WARNING - 4,586 word instances (1.4%) not found in frequency list (197 unique valid words)
2025-10-18 14:03:50,363 - utils.linguistic_features - INFO - Sample of 197 missing valid words: ['1986. mordet', '2000-direktiverne', 'af j.j', 'af kong', 'affaldspolitikken', 'april 1940 pÃ¥ amalienborg', 'awakens (2015', 'bjergstien', 'bliniopskrifter', 'blintzes', 'by-spildevand', 'cÃ¸libatÃ¦gteskabet', 'drengekammeraterne', 'ecodesign-direktivet', 'emancipationskravet', 'en klase med', 'entrÃ©belÃ¸b', 'er stakbÃ¦rende', 'forbrugsopgjorte', 'forÃ¥rsbebudning', 'havstrategier', 'henrik (prinsgemalen', 'hÃ¸jskoledanmark', 'hâer', 'hâerne', 'i grÃ¦s-familien', 'idahot-forum', 'issefjerene', 'istandgÃ¸re', 'jedi (2017', 'kabeltromlerne', 'klimatilpasningslov', 'lgbtqi-familien', 'lgbtqi-rettigheder', 'melatoninen', 'miljÃ¸sejr', 'ph.d.-stilling', 'pÃ¥ p', 'renÃ¦ssancekongen', 'sankthanstraditioner', 'skjortesyerske', 'spejder-juniorer', 'spÃ¥domsevner', 'stress-sygdomme', 'subapikalt', 'tscherning (1817-1890', 'tusindÃ¥rsfornemmelser', 'udstillingsparate', 'Ã¥rshjulets', 'Ã¦ttesamfund']... (147 more)
2025-10-18 14:03:50,370 - utils.linguistic_features - INFO - Excluding 4,599 word instances (1.4%) with missing frequencies from analysis
2025-10-18 14:03:50,503 - utils.linguistic_features - INFO - Remaining dataset: 330,567 words
2025-10-18 14:03:50,503 - utils.linguistic_features - INFO - Final dataset: 330,567 words with valid frequencies
2025-10-18 14:03:54,476 - utils.linguistic_features - INFO - Loading causal language model: KennethTM/gpt2-medium-danish
2025-10-18 14:03:55,953 - utils.linguistic_features - INFO - Using CPU for surprisal computation
2025-10-18 14:03:55,953 - utils.linguistic_features - INFO - Causal language model loaded successfully
2025-10-18 14:03:55,953 - utils.linguistic_features - INFO - Computing surprisal with causal GPT-2 (left-to-right)...
2025-10-18 14:03:57,304 - utils.linguistic_features - INFO - Dataset statistics:
2025-10-18 14:03:57,305 - utils.linguistic_features - INFO -   Total participant-sentence instances: 20,707
2025-10-18 14:03:57,305 - utils.linguistic_features - INFO -   Unique sentence texts: 1,986
2025-10-18 14:03:57,305 - utils.linguistic_features - INFO -   Average participants per sentence: 10.4
2025-10-18 14:03:57,305 - utils.linguistic_features - INFO - Loading cached surprisal values from word_surprisal\surprisal_cache_gpt2.pkl
2025-10-18 14:03:57,318 - utils.linguistic_features - INFO - Loaded surprisal for 1,986 unique sentences
2025-10-18 14:03:57,319 - utils.linguistic_features - INFO - Broadcasting surprisal values to all participant instances...
2025-10-18 14:03:57,319 - utils.linguistic_features - INFO -   Mapping surprisal to words...
2025-10-18 14:04:00,318 - utils.linguistic_features - INFO -   Mapped 326,496 words
2025-10-18 14:04:00,319 - utils.linguistic_features - INFO - 
Surprisal Computation Results:
2025-10-18 14:04:00,320 - utils.linguistic_features - INFO -   Unique sentences processed: 1,986
2025-10-18 14:04:00,320 - utils.linguistic_features - INFO -   Total words with surprisal: 326,496 / 330,567
2025-10-18 14:04:00,320 - utils.linguistic_features - INFO -   Mean: 6.93 bits
2025-10-18 14:04:00,324 - utils.linguistic_features - INFO -   Median: 5.69 bits
2025-10-18 14:04:00,326 - utils.linguistic_features - INFO -   Std: 5.55 bits
2025-10-18 14:04:00,326 - utils.linguistic_features - INFO -   Range: [0.00, 59.34] bits
2025-10-18 14:04:00,341 - utils.linguistic_features - INFO - Linguistic features added successfully
2025-10-18 14:04:00,342 - utils.linguistic_features - INFO - 
Feature Summary:
2025-10-18 14:04:00,345 - utils.linguistic_features - INFO -   Word length: mean=4.67, std=3.08
2025-10-18 14:04:00,349 - utils.linguistic_features - INFO -   Zipf frequency: mean=5.85, std=1.38, range=[0.91, 7.51]
2025-10-18 14:04:00,351 - utils.linguistic_features - INFO -   Surprisal: mean=6.93, std=5.55
2025-10-18 14:04:00,361 - utils.hypothesis_testing_utils - INFO - Preparing data for hypothesis testing...
2025-10-18 14:04:00,401 - utils.hypothesis_testing_utils - INFO - Creating ERT variable...
2025-10-18 14:04:00,404 - utils.hypothesis_testing_utils - INFO -   ERT created: 123,666 skipped (0ms), 206,901 fixated
2025-10-18 14:04:00,404 - utils.hypothesis_testing_utils - INFO - Centering and scaling predictors...
2025-10-18 14:04:00,418 - utils.hypothesis_testing_utils - INFO -   word_length: mean=4.67, scale=3.08
2025-10-18 14:04:00,432 - utils.hypothesis_testing_utils - INFO -   word_frequency_zipf: mean=5.85, scale=1.38
2025-10-18 14:04:00,444 - utils.hypothesis_testing_utils - INFO -   surprisal: mean=6.93, scale=5.55
2025-10-18 14:04:00,444 - utils.hypothesis_testing_utils - INFO - Checking collinearity (VIF)...
2025-10-18 14:04:00,525 - utils.hypothesis_testing_utils - INFO - VIF Results:
2025-10-18 14:04:00,527 - utils.hypothesis_testing_utils - INFO -   Length: 2.82 (OK)
2025-10-18 14:04:00,527 - utils.hypothesis_testing_utils - INFO -   Frequency: 3.18 (OK)
2025-10-18 14:04:00,527 - utils.hypothesis_testing_utils - INFO -   Surprisal: 1.41 (OK)
2025-10-18 14:04:00,527 - utils.hypothesis_testing_utils - INFO - Creating residualized surprisal...
2025-10-18 14:04:00,543 - utils.hypothesis_testing_utils - INFO -   Correlation (Frequency-Surprisal): r=-0.539
2025-10-18 14:04:00,543 - utils.hypothesis_testing_utils - INFO -   Residualized surprisal created
2025-10-18 14:04:00,543 - utils.hypothesis_testing_utils - INFO - Defining pooled quartiles...
2025-10-18 14:04:00,557 - utils.hypothesis_testing_utils - INFO -   word_length: Q1=2.00, Q3=6.00
2025-10-18 14:04:00,571 - utils.hypothesis_testing_utils - INFO -   word_frequency_zipf: Q1=4.91, Q3=7.10
2025-10-18 14:04:00,584 - utils.hypothesis_testing_utils - INFO -   surprisal: Q1=2.76, Q3=9.97
2025-10-18 14:04:00,584 - utils.hypothesis_testing_utils - INFO - Data preparation complete: 330,567 words ready for analysis
2025-10-18 14:04:00,597 - utils.quartile_analysis - INFO - ============================================================
2025-10-18 14:04:00,597 - utils.quartile_analysis - INFO - PART A: QUARTILE ANALYSIS (Q1 vs Q3)
2025-10-18 14:04:00,597 - utils.quartile_analysis - INFO - ============================================================
2025-10-18 14:04:00,597 - utils.quartile_analysis - INFO - 
Analyzing word_length...
2025-10-18 14:04:01,441 - utils.quartile_analysis - INFO -   Computed means for 57 participants
2025-10-18 14:04:01,442 - utils.quartile_analysis - INFO -     Control Q3-Q1: 259.7ms
2025-10-18 14:04:01,442 - utils.quartile_analysis - INFO -     Dyslexic Q3-Q1: 442.6ms
2025-10-18 14:04:01,502 - utils.quartile_analysis - INFO -   Fitting mixed model on 152,465 words...
2025-10-18 14:04:02,068 - utils.quartile_analysis - INFO -   GroupÃBin interaction: beta=134.79, p=0.0000
2025-10-18 14:04:02,093 - utils.quartile_analysis - INFO -   Computing bootstrap CIs (1000 iterations)...
2025-10-18 14:04:03,769 - utils.quartile_analysis - INFO -   Bootstrap 95% CI for interaction: [98.47, 259.71]
2025-10-18 14:04:03,771 - utils.quartile_analysis - INFO - 
Analyzing word_frequency_zipf...
2025-10-18 14:04:04,535 - utils.quartile_analysis - INFO -   Computed means for 57 participants
2025-10-18 14:04:04,536 - utils.quartile_analysis - INFO -     Control Q3-Q1: -225.9ms
2025-10-18 14:04:04,537 - utils.quartile_analysis - INFO -     Dyslexic Q3-Q1: -388.2ms
2025-10-18 14:04:04,598 - utils.quartile_analysis - INFO -   Fitting mixed model on 162,606 words...
2025-10-18 14:04:07,406 - utils.quartile_analysis - INFO -   GroupÃBin interaction: beta=-122.40, p=0.0000
2025-10-18 14:04:07,441 - utils.quartile_analysis - INFO -   Computing bootstrap CIs (1000 iterations)...
2025-10-18 14:04:09,125 - utils.quartile_analysis - INFO -   Bootstrap 95% CI for interaction: [-225.59, -87.90]
2025-10-18 14:04:09,126 - utils.quartile_analysis - INFO - 
Analyzing surprisal...
2025-10-18 14:04:09,922 - utils.quartile_analysis - INFO -   Computed means for 57 participants
2025-10-18 14:04:09,923 - utils.quartile_analysis - INFO -     Control Q3-Q1: 135.8ms
2025-10-18 14:04:09,923 - utils.quartile_analysis - INFO -     Dyslexic Q3-Q1: 277.3ms
2025-10-18 14:04:09,987 - utils.quartile_analysis - INFO -   Fitting mixed model on 163,257 words...
2025-10-18 14:04:12,474 - utils.quartile_analysis - INFO -   GroupÃBin interaction: beta=105.53, p=0.0000
2025-10-18 14:04:12,504 - utils.quartile_analysis - INFO -   Computing bootstrap CIs (1000 iterations)...
2025-10-18 14:04:14,211 - utils.quartile_analysis - INFO -   Bootstrap 95% CI for interaction: [84.99, 194.82]
2025-10-18 14:04:14,212 - utils.continuous_models - INFO - ============================================================
2025-10-18 14:04:14,212 - utils.continuous_models - INFO - PART B: CONTINUOUS MODELS (TWO-PART)
2025-10-18 14:04:14,212 - utils.continuous_models - INFO - ============================================================
2025-10-18 14:04:14,212 - utils.continuous_models - INFO - 
1. SKIPPING MODEL (Logistic with Clustered SEs)
2025-10-18 14:04:14,314 - utils.continuous_models - INFO -   Formula: skipped ~ dyslexic_int * (word_length_scaled + word_frequency_zipf_scaled + surprisal_scaled)
2025-10-18 14:04:14,316 - utils.continuous_models - INFO -   Fitting on 326,496 words...
2025-10-18 14:04:15,030 - utils.continuous_models - INFO -   Model fitted successfully with clustered SEs
2025-10-18 14:04:15,032 - utils.continuous_models - INFO -     dyslexic_int:word_length_scaled: beta=-0.0250, p=0.6714
2025-10-18 14:04:15,032 - utils.continuous_models - INFO -     dyslexic_int:word_frequency_zipf_scaled: beta=-0.0640, p=0.1975
2025-10-18 14:04:15,032 - utils.continuous_models - INFO -     dyslexic_int:surprisal_scaled: beta=-0.0272, p=0.2667
2025-10-18 14:04:15,043 - utils.continuous_models - INFO - 
2. DURATION MODEL (Log-TRT | Fixated)
2025-10-18 14:04:15,146 - utils.continuous_models - INFO -   Formula: log_TRT ~ dyslexic_int * (word_length_scaled + word_frequency_zipf_scaled + surprisal_scaled)
2025-10-18 14:04:15,146 - utils.continuous_models - INFO -   Fitting on 204,224 fixated words...
2025-10-18 14:04:16,208 - utils.continuous_models - INFO -   Model fitted successfully
2025-10-18 14:04:16,209 - utils.continuous_models - INFO -   Smearing correction factor: 1.1562
2025-10-18 14:04:16,209 - utils.continuous_models - INFO -     dyslexic_int:word_length_scaled: beta=0.0078, p=0.0585
2025-10-18 14:04:16,209 - utils.continuous_models - INFO -     dyslexic_int:word_frequency_zipf_scaled: beta=-0.0084, p=0.0678
2025-10-18 14:04:16,209 - utils.continuous_models - INFO -     dyslexic_int:surprisal_scaled: beta=0.0349, p=0.0000
2025-10-18 14:04:16,218 - utils.continuous_models - INFO - 
3. PREDICTING EXPECTED ERT
2025-10-18 14:04:16,271 - utils.continuous_models - INFO -   Predicting expected ERT...
2025-10-18 14:04:16,531 - utils.continuous_models - INFO -   Predicted expected ERT for 326,496 words
2025-10-18 14:04:16,533 - utils.continuous_models - INFO -     Mean expected ERT: 228.71ms
2025-10-18 14:04:16,534 - utils.continuous_models - INFO -     Mean observed ERT: 236.03ms
2025-10-18 14:04:16,542 - utils.continuous_models - INFO - 
4. VARIANCE EXPLAINED (ÎRÂ² on Expected ERT)
2025-10-18 14:04:16,663 - utils.continuous_models - INFO -   Computing ÎRÂ² on 326,496 observations
2025-10-18 14:04:16,987 - utils.continuous_models - INFO -     M0: RÂ² = 0.2074
2025-10-18 14:04:17,314 - utils.continuous_models - INFO -     M1: RÂ² = 0.9267
2025-10-18 14:04:17,645 - utils.continuous_models - INFO -     M2: RÂ² = 0.9501
2025-10-18 14:04:18,051 - utils.continuous_models - INFO -     M3: RÂ² = 0.9608
2025-10-18 14:04:18,051 - utils.continuous_models - INFO - 
  Variance Explained (ÎRÂ²):
2025-10-18 14:04:18,051 - utils.continuous_models - INFO -     Length: ÎRÂ² = 0.7193 (71.93%)
2025-10-18 14:04:18,051 - utils.continuous_models - INFO -     Frequency: ÎRÂ² = 0.0233 (2.33%)
2025-10-18 14:04:18,051 - utils.continuous_models - INFO -     Surprisal: ÎRÂ² = 0.0107 (1.07%)
2025-10-18 14:04:18,078 - utils.continuous_models - INFO - 
5. MS SHIFTS (Q1âQ3 on Expected ERT)
2025-10-18 14:04:18,086 - utils.continuous_models - INFO - 
  word_length: Q1=2.00, Q3=6.00
2025-10-18 14:04:18,107 - utils.continuous_models - INFO -     Control: 136.3ms -> 220.5ms (Î = 84.1ms)
2025-10-18 14:04:18,126 - utils.continuous_models - INFO -     Dyslexic: 239.3ms -> 361.0ms (Î = 121.7ms)
2025-10-18 14:04:18,135 - utils.continuous_models - INFO - 
  word_frequency_zipf: Q1=4.91, Q3=7.10
2025-10-18 14:04:18,154 - utils.continuous_models - INFO -     Control: 209.3ms -> 167.5ms (Î = -41.8ms)
2025-10-18 14:04:18,171 - utils.continuous_models - INFO -     Dyslexic: 342.6ms -> 290.3ms (Î = -52.3ms)
2025-10-18 14:04:18,180 - utils.continuous_models - INFO - 
  surprisal: Q1=2.76, Q3=9.97
2025-10-18 14:04:18,199 - utils.continuous_models - INFO -     Control: 185.2ms -> 195.4ms (Î = 10.2ms)
2025-10-18 14:04:18,218 - utils.continuous_models - INFO -     Dyslexic: 300.9ms -> 334.1ms (Î = 33.3ms)
2025-10-18 14:04:18,218 - utils.continuous_models - INFO - 
6. SLOPE RATIOS (Finite Differences on Expected ERT)
2025-10-18 14:04:18,262 - utils.continuous_models - INFO -   word_length: SR = 1.447 (AMPLIFIED)
2025-10-18 14:04:18,301 - utils.continuous_models - INFO -   word_frequency_zipf: SR = 1.251 (AMPLIFIED)
2025-10-18 14:04:18,343 - utils.continuous_models - INFO -   surprisal: SR = 3.257 (AMPLIFIED)
2025-10-18 14:04:18,343 - utils.continuous_models - INFO - 
7. BOOTSTRAP CONFIDENCE INTERVALS
2025-10-18 14:04:18,343 - utils.continuous_models - INFO -   Computing bootstrap CIs (100 iterations)...
2025-10-18 14:04:40,946 - utils.gap_decomposition - INFO - ============================================================
2025-10-18 14:04:40,946 - utils.gap_decomposition - INFO - PART C: GAP DECOMPOSITION (ON OBSERVED ERT)
2025-10-18 14:04:40,946 - utils.gap_decomposition - INFO - ============================================================
2025-10-18 14:04:41,047 - utils.gap_decomposition - INFO - Using common sample of 326,496 observations for all models
2025-10-18 14:04:41,047 - utils.gap_decomposition - INFO - 
Fitting M0 (main effects only)...
2025-10-18 14:04:41,047 - utils.gap_decomposition - INFO -   Formula: ERT_expected ~ dyslexic_int
2025-10-18 14:04:41,356 - utils.gap_decomposition - INFO -   M0 fitted successfully (OLS with clustered SEs)
2025-10-18 14:04:41,356 - utils.gap_decomposition - INFO - 
Fitting M1 (main effects only)...
2025-10-18 14:04:41,356 - utils.gap_decomposition - INFO -   Formula: ERT_expected ~ dyslexic_int + word_length_scaled
2025-10-18 14:04:41,688 - utils.gap_decomposition - INFO -   M1 fitted successfully (OLS with clustered SEs)
2025-10-18 14:04:41,689 - utils.gap_decomposition - INFO - 
Fitting M2 (main effects only)...
2025-10-18 14:04:41,689 - utils.gap_decomposition - INFO -   Formula: ERT_expected ~ dyslexic_int + word_length_scaled + word_frequency_zipf_scaled
2025-10-18 14:04:42,015 - utils.gap_decomposition - INFO -   M2 fitted successfully (OLS with clustered SEs)
2025-10-18 14:04:42,016 - utils.gap_decomposition - INFO - 
Fitting M3 (main effects only)...
2025-10-18 14:04:42,016 - utils.gap_decomposition - INFO -   Formula: ERT_expected ~ dyslexic_int + word_length_scaled + word_frequency_zipf_scaled + surprisal_scaled
2025-10-18 14:04:42,367 - utils.gap_decomposition - INFO -   M3 fitted successfully (OLS with clustered SEs)
2025-10-18 14:04:42,377 - utils.gap_decomposition - INFO - 
Computing gaps on OBSERVED ERT (not model predictions)...
2025-10-18 14:04:42,377 - utils.gap_decomposition - INFO -   Computing gaps on observed ERT...
2025-10-18 14:04:42,568 - utils.gap_decomposition - INFO -     M0: Gap = 133.03ms
2025-10-18 14:04:42,791 - utils.gap_decomposition - INFO -     M1: Gap = 132.03ms
2025-10-18 14:04:43,036 - utils.gap_decomposition - INFO -     M2: Gap = 132.16ms
2025-10-18 14:04:43,289 - utils.gap_decomposition - INFO -     M3: Gap = 132.02ms
2025-10-18 14:04:43,312 - utils.gap_decomposition - INFO -   Computing composition gaps...
2025-10-18 14:04:43,465 - utils.gap_decomposition - INFO -     M0: Composition gap = -0.00ms
2025-10-18 14:04:43,671 - utils.gap_decomposition - INFO -     M1: Composition gap = 1.00ms
2025-10-18 14:04:43,868 - utils.gap_decomposition - INFO -     M2: Composition gap = 0.86ms
2025-10-18 14:04:44,051 - utils.gap_decomposition - INFO -     M3: Composition gap = 1.00ms
2025-10-18 14:04:44,069 - utils.gap_decomposition - INFO -   Computing RÂ² on observed ERT...
2025-10-18 14:04:44,075 - utils.gap_decomposition - INFO -     M0: RÂ² = 0.0348
2025-10-18 14:04:44,082 - utils.gap_decomposition - INFO -     M1: RÂ² = 0.1599
2025-10-18 14:04:44,089 - utils.gap_decomposition - INFO -     M2: RÂ² = 0.1638
2025-10-18 14:04:44,096 - utils.gap_decomposition - INFO -     M3: RÂ² = 0.1656
2025-10-18 14:04:44,096 - utils.gap_decomposition - INFO - 
Fitting interaction models...
2025-10-18 14:04:44,199 - utils.gap_decomposition - INFO -   Fitting M1_int...
2025-10-18 14:04:44,532 - utils.gap_decomposition - INFO -     M1_int fitted successfully
2025-10-18 14:04:44,596 - utils.gap_decomposition - INFO -   Fitting M2_int...
2025-10-18 14:04:44,962 - utils.gap_decomposition - INFO -     M2_int fitted successfully
2025-10-18 14:04:45,029 - utils.gap_decomposition - INFO -   Fitting M3_int...
2025-10-18 14:04:45,459 - utils.gap_decomposition - INFO -     M3_int fitted successfully
2025-10-18 14:04:45,469 - utils.gap_decomposition - INFO - 
Oaxaca/Blinder Decomposition (on Observed ERT):
2025-10-18 14:04:46,488 - utils.gap_decomposition - INFO -   Total observed gap: 133.03ms
2025-10-18 14:04:46,488 - utils.gap_decomposition - INFO -   Composition effect: 1.00ms (0.8%)
2025-10-18 14:04:46,488 - utils.gap_decomposition - INFO -   Coefficient effect: 131.72ms (99.0%)
2025-10-18 14:04:46,488 - utils.gap_decomposition - INFO -   Residual: 0.30ms
2025-10-18 14:04:46,489 - utils.gap_decomposition - INFO - 
  â Groups read similar-difficulty words (composition â 0%)
2025-10-18 14:04:46,489 - utils.gap_decomposition - INFO -   â Gap is due to differential sensitivity (coefficient effect)
2025-10-18 14:04:46,564 - utils.gap_decomposition - INFO - 
============================================================
2025-10-18 14:04:46,564 - utils.gap_decomposition - INFO - GAP DECOMPOSITION SUMMARY (ON OBSERVED ERT)
2025-10-18 14:04:46,565 - utils.gap_decomposition - INFO - ============================================================
2025-10-18 14:04:46,565 - utils.gap_decomposition - INFO - 
Baseline observed gap (M0): 133.03ms
2025-10-18 14:04:46,565 - utils.gap_decomposition - INFO - 
M1 (+Length):
2025-10-18 14:04:46,565 - utils.gap_decomposition - INFO -   Observed gap: 132.03ms
2025-10-18 14:04:46,565 - utils.gap_decomposition - INFO -   Composition gap: 1.00ms
2025-10-18 14:04:46,565 - utils.gap_decomposition - INFO -   % Explained: 99.3%
2025-10-18 14:04:46,565 - utils.gap_decomposition - INFO -   ÎRÂ²: 0.1250
2025-10-18 14:04:46,566 - utils.gap_decomposition - INFO - 
M2 (+Frequency):
2025-10-18 14:04:46,566 - utils.gap_decomposition - INFO -   Observed gap: 132.16ms
2025-10-18 14:04:46,566 - utils.gap_decomposition - INFO -   Composition gap: 0.86ms
2025-10-18 14:04:46,566 - utils.gap_decomposition - INFO -   % Explained: 99.4%
2025-10-18 14:04:46,566 - utils.gap_decomposition - INFO -   ÎRÂ²: 0.0039
2025-10-18 14:04:46,566 - utils.gap_decomposition - INFO - 
M3 (+Surprisal):
2025-10-18 14:04:46,566 - utils.gap_decomposition - INFO -   Observed gap: 132.02ms
2025-10-18 14:04:46,566 - utils.gap_decomposition - INFO -   Composition gap: 1.00ms
2025-10-18 14:04:46,567 - utils.gap_decomposition - INFO -   % Explained: 99.2%
2025-10-18 14:04:46,567 - utils.gap_decomposition - INFO -   ÎRÂ²: 0.0018
2025-10-18 14:04:46,567 - utils.sensitivity_analysis - INFO - ============================================================
2025-10-18 14:04:46,567 - utils.sensitivity_analysis - INFO - SENSITIVITY ANALYSES
2025-10-18 14:04:46,567 - utils.sensitivity_analysis - INFO - ============================================================
2025-10-18 14:04:46,567 - utils.sensitivity_analysis - INFO - 
1. RESIDUALIZED SURPRISAL MODEL
2025-10-18 14:04:46,643 - utils.sensitivity_analysis - INFO -   Formula: ERT ~ dyslexic_int * (word_length_scaled + word_frequency_zipf_scaled + surprisal_resid)
2025-10-18 14:04:47,228 - utils.sensitivity_analysis - INFO -   Residualized surprisal: beta=11.6330, p=0.0000
2025-10-18 14:04:47,228 - utils.sensitivity_analysis - INFO -   [OK] Surprisal effect robust to frequency collinearity
2025-10-18 14:04:47,242 - utils.sensitivity_analysis - INFO - 
2. SUBJECT-WISE CROSS-VALIDATION
2025-10-18 14:04:47,243 - utils.sensitivity_analysis - INFO -   Running 10-fold subject-wise CV...
2025-10-18 14:04:47,471 - utils.sensitivity_analysis - INFO -     Fold 1/10
2025-10-18 14:04:48,047 - utils.sensitivity_analysis - INFO -     Fold 2/10
2025-10-18 14:04:48,675 - utils.sensitivity_analysis - INFO -     Fold 3/10
2025-10-18 14:04:49,293 - utils.sensitivity_analysis - INFO -     Fold 4/10
2025-10-18 14:04:49,930 - utils.sensitivity_analysis - INFO -     Fold 5/10
2025-10-18 14:04:50,518 - utils.sensitivity_analysis - INFO -     Fold 6/10
2025-10-18 14:04:51,697 - utils.sensitivity_analysis - INFO -     Fold 7/10
2025-10-18 14:04:52,313 - utils.sensitivity_analysis - INFO -     Fold 8/10
2025-10-18 14:04:52,852 - utils.sensitivity_analysis - INFO -     Fold 9/10
2025-10-18 14:04:53,372 - utils.sensitivity_analysis - INFO -     Fold 10/10
2025-10-18 14:04:53,907 - utils.sensitivity_analysis - INFO -   Cross-validation RÂ²: -0.3352 Â± 0.2999
2025-10-18 14:04:53,908 - utils.sensitivity_analysis - INFO -   Based on 10 successful folds
2025-10-18 14:04:53,949 - utils.sensitivity_analysis - INFO - 
3. ALTERNATIVE BINNING (Terciles & Quintiles)
2025-10-18 14:04:53,950 - utils.sensitivity_analysis - INFO - 
  Testing terciles...
2025-10-18 14:04:54,065 - utils.sensitivity_analysis - INFO -     word_length: Control Î=202.4ms, Dyslexic Î=304.4ms
2025-10-18 14:04:54,165 - utils.sensitivity_analysis - INFO -     word_frequency_zipf: Control Î=-187.4ms, Dyslexic Î=-283.4ms
2025-10-18 14:04:54,270 - utils.sensitivity_analysis - INFO -     surprisal: Control Î=112.9ms, Dyslexic Î=200.7ms
2025-10-18 14:04:54,270 - utils.sensitivity_analysis - INFO - 
  Testing quintiles...
2025-10-18 14:04:54,345 - utils.sensitivity_analysis - INFO -     word_length: Control Î=284.7ms, Dyslexic Î=452.5ms
2025-10-18 14:04:54,419 - utils.sensitivity_analysis - INFO -     word_frequency_zipf: Control Î=-242.1ms, Dyslexic Î=-393.1ms
2025-10-18 14:04:54,500 - utils.sensitivity_analysis - INFO -     surprisal: Control Î=150.5ms, Dyslexic Î=270.2ms
2025-10-18 14:04:54,507 - utils.hypothesis_visualization - INFO - ============================================================
2025-10-18 14:04:54,507 - utils.hypothesis_visualization - INFO - CREATING VISUALIZATIONS
2025-10-18 14:04:54,508 - utils.hypothesis_visualization - INFO - ============================================================
2025-10-18 14:04:54,508 - utils.hypothesis_visualization - INFO - 
1. Continuous effect curves...
2025-10-18 14:04:55,816 - utils.hypothesis_visualization - INFO -   Saved to results\continuous_effects_with_quartiles.png
2025-10-18 14:04:55,818 - utils.hypothesis_visualization - INFO - 2. Gap decomposition...
2025-10-18 14:04:55,818 - utils.hypothesis_visualization - WARNING - No gap results available
2025-10-18 14:04:55,818 - utils.hypothesis_visualization - INFO - 3. Slope ratios...
2025-10-18 14:04:56,108 - utils.hypothesis_visualization - INFO -   Saved to results\slope_ratios.png
2025-10-18 14:04:56,109 - utils.hypothesis_visualization - INFO - 4. Model comparison...
2025-10-18 14:04:56,128 - matplotlib.category - INFO - Using categorical units to plot a list of strings that are all parsable as floats or dates. If these strings should be plotted as numbers, cast to the appropriate data type before plotting.
2025-10-18 14:04:56,129 - matplotlib.category - INFO - Using categorical units to plot a list of strings that are all parsable as floats or dates. If these strings should be plotted as numbers, cast to the appropriate data type before plotting.
2025-10-18 14:04:56,508 - utils.hypothesis_visualization - INFO -   Saved to results\model_comparison.png
2025-10-18 14:04:56,508 - utils.hypothesis_visualization - INFO - 5. Quartile effects...
2025-10-18 14:04:57,113 - utils.hypothesis_visualization - INFO -   Saved to results\quartile_effects.png
2025-10-18 14:04:57,113 - utils.hypothesis_visualization - INFO - 6. Predicted vs observed...
2025-10-18 14:04:58,019 - utils.hypothesis_visualization - INFO -   Saved to results\predicted_vs_observed.png
2025-10-18 14:04:58,020 - utils.hypothesis_visualization - INFO - 
All visualizations saved to results
2025-10-18 14:04:58,020 - utils.results_reporting - INFO - ============================================================
2025-10-18 14:04:58,021 - utils.results_reporting - INFO - GENERATING RESULTS REPORT
2025-10-18 14:04:58,021 - utils.results_reporting - INFO - ============================================================
2025-10-18 14:04:58,024 - utils.results_reporting - INFO - 
Testing Hypothesis 1: Feature effects on reading time
2025-10-18 14:04:58,025 - utils.results_reporting - INFO -   Length: beta=0.1222, p=0.0000 - CONFIRMED
2025-10-18 14:04:58,025 - utils.results_reporting - INFO -   Frequency: beta=-0.0486, p=0.0000 - CONFIRMED
2025-10-18 14:04:58,025 - utils.results_reporting - INFO -   Surprisal: beta=0.0317, p=0.0000 - CONFIRMED
2025-10-18 14:04:58,025 - utils.results_reporting - INFO - 
Hypothesis 1: CONFIRMED
2025-10-18 14:04:58,026 - utils.results_reporting - INFO - 
Testing Hypothesis 2: Dyslexic amplification
2025-10-18 14:04:58,026 - utils.results_reporting - INFO - 
Hypothesis 2: CONFIRMED
2025-10-18 14:04:58,026 - utils.results_reporting - INFO - 
Testing Hypothesis 3: Gap explanation
2025-10-18 14:04:58,027 - utils.results_reporting - INFO - 
================================================================================
2025-10-18 14:04:58,027 - utils.results_reporting - INFO - HYPOTHESIS TESTING RESULTS SUMMARY
2025-10-18 14:04:58,027 - utils.results_reporting - INFO - ================================================================================
2025-10-18 14:04:58,027 - utils.results_reporting - INFO - 
HYPOTHESIS 1: CONFIRMED
2025-10-18 14:04:58,027 - utils.results_reporting - INFO -   All features predict reading time in expected directions
2025-10-18 14:04:58,027 - utils.results_reporting - INFO - 
HYPOTHESIS 2: CONFIRMED
2025-10-18 14:04:58,028 - utils.results_reporting - INFO -   All features show dyslexic amplification (SR > 1)
2025-10-18 14:04:58,028 - utils.results_reporting - INFO - 
HYPOTHESIS 3: FAILED
2025-10-18 14:04:58,028 - utils.results_reporting - INFO -   Gap decomposition failed - no baseline gap computed
2025-10-18 14:04:58,028 - utils.results_reporting - INFO - 
OVERALL: ALL HYPOTHESES CONFIRMED
2025-10-18 14:04:58,028 - utils.results_reporting - INFO - 
Key Findings:
2025-10-18 14:04:58,028 - utils.results_reporting - INFO -   â¢ 3/3 features show dyslexic amplification
2025-10-18 14:04:58,028 - utils.results_reporting - INFO -   â¢ Features explain 99.2% of group gap
2025-10-18 14:04:58,028 - utils.results_reporting - INFO -   â¢ Effects consistent across multiple analyses
2025-10-18 14:04:58,029 - utils.results_reporting - INFO - Report generation complete
2025-10-18 14:04:58,031 - utils.misc_utils - INFO - Results saved to results\hypothesis_testing_results.json
2025-10-18 14:04:58,031 - __main__ - INFO - 
Hypothesis testing complete! Results saved to results
2025-10-18 14:15:02,988 - __main__ - INFO - Dyslexia Time Analysis Pipeline initialized
2025-10-18 14:15:02,988 - __main__ - INFO - Dyslexia Time Analysis Pipeline initialized
2025-10-18 14:15:04,749 - __main__ - INFO - Running hypothesis testing analysis...
2025-10-18 14:15:04,750 - __main__ - INFO - ================================================================================
2025-10-18 14:15:04,750 - __main__ - INFO - HYPOTHESIS TESTING ANALYSIS
2025-10-18 14:15:04,750 - __main__ - INFO - ================================================================================
2025-10-18 14:15:04,750 - __main__ - INFO - Loading CopCo dataset...
2025-10-18 14:15:04,751 - utils.data_utils - INFO - Loading 57 participant files...
2025-10-18 14:15:06,092 - utils.data_utils - INFO - Starting with 335,203 total word entries
2025-10-18 14:15:06,253 - utils.data_utils - INFO - Word fixation patterns:
2025-10-18 14:15:06,253 - utils.data_utils - INFO -   - Skipped words (0 fixations): 126,302
2025-10-18 14:15:06,253 - utils.data_utils - INFO -   - Fixated words (1+ fixations): 208,901
2025-10-18 14:15:06,253 - utils.data_utils - INFO -   - Unknown fixations (NaN): 0
2025-10-18 14:15:06,283 - utils.data_utils - INFO - Fixated words reading times: median 272ms, 99th percentile 1777ms
2025-10-18 14:15:06,285 - utils.data_utils - INFO - Removed 14 fixated words with extreme reading times (0 too short, 14 too long)
2025-10-18 14:15:06,381 - utils.data_utils - INFO - Removed 23 words longer than 30 characters (likely data errors)
2025-10-18 14:15:06,416 - utils.data_utils - INFO - Final dataset: 126,302 skipped words, 208,864 fixated words
2025-10-18 14:15:06,417 - utils.data_utils - INFO - Data cleaning complete: 335,166 words retained (100.0% of original)
2025-10-18 14:15:06,423 - utils.data_utils - INFO - Groups identified: 19 dyslexic, 39 control
2025-10-18 14:15:06,490 - __main__ - INFO - Calculating skipping probabilities...
2025-10-18 14:15:06,494 - utils.skipping_utils - INFO - Skipping analysis from ExtractedFeatures:
2025-10-18 14:15:06,496 - utils.skipping_utils - INFO -   Total words: 335,166
2025-10-18 14:15:06,496 - utils.skipping_utils - INFO -   Skipped: 126,302 (37.7%)
2025-10-18 14:15:06,496 - utils.skipping_utils - INFO -   Fixated: 208,864 (62.3%)
2025-10-18 14:15:06,535 - __main__ - INFO - Skipping analysis: 37.7% overall rate
2025-10-18 14:15:06,551 - __main__ - INFO - Loaded: 335,166 words from 57 participants
2025-10-18 14:15:06,552 - __main__ - INFO - ============================================================
2025-10-18 14:15:06,552 - __main__ - INFO - COMPUTING LINGUISTIC FEATURES
2025-10-18 14:15:06,552 - __main__ - INFO - ============================================================
2025-10-18 14:15:06,552 - utils.linguistic_features - INFO - Loading Danish frequency list from danish_frequencies\danish_leipzig_for_analysis.txt
2025-10-18 14:15:07,834 - utils.linguistic_features - WARNING - Found 2 duplicate words after lowercasing. 
2025-10-18 14:15:08,281 - utils.linguistic_features - INFO - Loaded 1,499,999 word proportions from Leipzig Corpora
2025-10-18 14:15:08,343 - utils.linguistic_features - INFO - Computing word frequency...
2025-10-18 14:15:08,345 - utils.linguistic_features - INFO -   Stripping punctuation from words before frequency lookup
2025-10-18 14:15:09,021 - utils.linguistic_features - INFO - 13 missing word instances were punctuation-only
2025-10-18 14:15:09,022 - utils.linguistic_features - WARNING - 4,586 word instances (1.4%) not found in frequency list (197 unique valid words)
2025-10-18 14:15:09,022 - utils.linguistic_features - INFO - Sample of 197 missing valid words: ['1926-2016', '1986. mordet', '2. (margrethe', 'abilifyer', 'abrams efter', 'adspredelsens', 'adunyadet', 'af kong', 'amerikansk science', 'awakens (2015', 'blÃ¦redygtige', 'broderet messehagler og', 'by-spildevand', 'cybermind', 'dallis', 'efter star', 'en klase med', 'flensborggÃ¥rden', 'fÃ¦drelandssalmen', 'go-to-ting', 'grillparties', 'heksejagte', 'i star', 'initiativlyst', 'isotropic', 'it-mulighederne', 'klimatilpasningslov', 'klimatilpasningspakke', 'leartesâs', 'lgbtqi-familien', 'lgbtqi-rettigheder', 'lysfester', 'lÃ¸vmand og', 'magteslÃ¸ses', 'med prins', 'midsommerfÃ¦lleskabet', 'nabofolkeslag', 'nivaagaard-tradition', 'og star', 'pÃ¥ p', 'renÃ¦ssancekongen', 'sankthansormen', 'skjortesyerske', 'skraldepigerne', 'skywalker ogsÃ¥', 'spejder-juniorer', 'superlÃ¦rer', 'takstfinansiere', 'topgrÃ¦sser', 'tscherning (1817-1890']... (147 more)
2025-10-18 14:15:09,028 - utils.linguistic_features - INFO - Excluding 4,599 word instances (1.4%) with missing frequencies from analysis
2025-10-18 14:15:09,120 - utils.linguistic_features - INFO - Remaining dataset: 330,567 words
2025-10-18 14:15:09,121 - utils.linguistic_features - INFO - Final dataset: 330,567 words with valid frequencies
2025-10-18 14:15:12,823 - utils.linguistic_features - INFO - Loading causal language model: KennethTM/gpt2-medium-danish
2025-10-18 14:15:14,370 - utils.linguistic_features - INFO - Using CPU for surprisal computation
2025-10-18 14:15:14,370 - utils.linguistic_features - INFO - Causal language model loaded successfully
2025-10-18 14:15:14,371 - utils.linguistic_features - INFO - Computing surprisal with causal GPT-2 (left-to-right)...
2025-10-18 14:15:15,612 - utils.linguistic_features - INFO - Dataset statistics:
2025-10-18 14:15:15,613 - utils.linguistic_features - INFO -   Total participant-sentence instances: 20,707
2025-10-18 14:15:15,613 - utils.linguistic_features - INFO -   Unique sentence texts: 1,986
2025-10-18 14:15:15,613 - utils.linguistic_features - INFO -   Average participants per sentence: 10.4
2025-10-18 14:15:15,613 - utils.linguistic_features - INFO - Loading cached surprisal values from word_surprisal\surprisal_cache_gpt2.pkl
2025-10-18 14:15:15,626 - utils.linguistic_features - INFO - Loaded surprisal for 1,986 unique sentences
2025-10-18 14:15:15,627 - utils.linguistic_features - INFO - Broadcasting surprisal values to all participant instances...
2025-10-18 14:15:15,627 - utils.linguistic_features - INFO -   Mapping surprisal to words...
2025-10-18 14:15:18,661 - utils.linguistic_features - INFO -   Mapped 326,496 words
2025-10-18 14:15:18,662 - utils.linguistic_features - INFO - 
Surprisal Computation Results:
2025-10-18 14:15:18,662 - utils.linguistic_features - INFO -   Unique sentences processed: 1,986
2025-10-18 14:15:18,663 - utils.linguistic_features - INFO -   Total words with surprisal: 326,496 / 330,567
2025-10-18 14:15:18,663 - utils.linguistic_features - INFO -   Mean: 6.93 bits
2025-10-18 14:15:18,667 - utils.linguistic_features - INFO -   Median: 5.69 bits
2025-10-18 14:15:18,669 - utils.linguistic_features - INFO -   Std: 5.55 bits
2025-10-18 14:15:18,669 - utils.linguistic_features - INFO -   Range: [0.00, 59.34] bits
2025-10-18 14:15:18,683 - utils.linguistic_features - INFO - Linguistic features added successfully
2025-10-18 14:15:18,684 - utils.linguistic_features - INFO - 
Feature Summary:
2025-10-18 14:15:18,685 - utils.linguistic_features - INFO -   Word length: mean=4.67, std=3.08
2025-10-18 14:15:18,687 - utils.linguistic_features - INFO -   Zipf frequency: mean=5.85, std=1.38, range=[0.91, 7.51]
2025-10-18 14:15:18,689 - utils.linguistic_features - INFO -   Surprisal: mean=6.93, std=5.55
2025-10-18 14:15:18,698 - utils.hypothesis_testing_utils - INFO - Preparing data for hypothesis testing...
2025-10-18 14:15:18,738 - utils.hypothesis_testing_utils - INFO - Creating ERT variable...
2025-10-18 14:15:18,741 - utils.hypothesis_testing_utils - INFO -   ERT created: 123,666 skipped (0ms), 206,901 fixated
2025-10-18 14:15:18,741 - utils.hypothesis_testing_utils - INFO - Centering and scaling predictors...
2025-10-18 14:15:18,755 - utils.hypothesis_testing_utils - INFO -   word_length: mean=4.67, scale=3.08
2025-10-18 14:15:18,768 - utils.hypothesis_testing_utils - INFO -   word_frequency_zipf: mean=5.85, scale=1.38
2025-10-18 14:15:18,781 - utils.hypothesis_testing_utils - INFO -   surprisal: mean=6.93, scale=5.55
2025-10-18 14:15:18,782 - utils.hypothesis_testing_utils - INFO - Checking collinearity (VIF)...
2025-10-18 14:15:18,862 - utils.hypothesis_testing_utils - INFO - VIF Results:
2025-10-18 14:15:18,863 - utils.hypothesis_testing_utils - INFO -   Length: 2.82 (OK)
2025-10-18 14:15:18,863 - utils.hypothesis_testing_utils - INFO -   Frequency: 3.18 (OK)
2025-10-18 14:15:18,863 - utils.hypothesis_testing_utils - INFO -   Surprisal: 1.41 (OK)
2025-10-18 14:15:18,864 - utils.hypothesis_testing_utils - INFO - Creating residualized surprisal...
2025-10-18 14:15:18,879 - utils.hypothesis_testing_utils - INFO -   Correlation (Frequency-Surprisal): r=-0.539
2025-10-18 14:15:18,879 - utils.hypothesis_testing_utils - INFO -   Residualized surprisal created
2025-10-18 14:15:18,880 - utils.hypothesis_testing_utils - INFO - Defining pooled quartiles...
2025-10-18 14:15:18,893 - utils.hypothesis_testing_utils - INFO -   word_length: Q1=2.00, Q3=6.00
2025-10-18 14:15:18,905 - utils.hypothesis_testing_utils - INFO -   word_frequency_zipf: Q1=4.91, Q3=7.10
2025-10-18 14:15:18,919 - utils.hypothesis_testing_utils - INFO -   surprisal: Q1=2.76, Q3=9.97
2025-10-18 14:15:18,919 - utils.hypothesis_testing_utils - INFO - Data preparation complete: 330,567 words ready for analysis
2025-10-18 14:15:18,927 - utils.quartile_analysis - INFO - ============================================================
2025-10-18 14:15:18,928 - utils.quartile_analysis - INFO - PART A: QUARTILE ANALYSIS (Q1 vs Q3)
2025-10-18 14:15:18,928 - utils.quartile_analysis - INFO - ============================================================
2025-10-18 14:15:18,928 - utils.quartile_analysis - INFO - 
Analyzing word_length...
2025-10-18 14:15:19,725 - utils.quartile_analysis - INFO -   Computed means for 57 participants
2025-10-18 14:15:19,726 - utils.quartile_analysis - INFO -     Control Q3-Q1: 259.7ms
2025-10-18 14:15:19,726 - utils.quartile_analysis - INFO -     Dyslexic Q3-Q1: 442.6ms
2025-10-18 14:15:19,784 - utils.quartile_analysis - INFO -   Fitting mixed model on 152,465 words...
2025-10-18 14:15:20,392 - utils.quartile_analysis - INFO -   GroupÃBin interaction: beta=134.79, p=0.0000
2025-10-18 14:15:20,421 - utils.quartile_analysis - INFO -   Computing bootstrap CIs (1000 iterations)...
2025-10-18 14:15:22,101 - utils.quartile_analysis - INFO -   Bootstrap 95% CI for interaction: [98.47, 259.71]
2025-10-18 14:15:22,102 - utils.quartile_analysis - INFO - 
Analyzing word_frequency_zipf...
2025-10-18 14:15:22,889 - utils.quartile_analysis - INFO -   Computed means for 57 participants
2025-10-18 14:15:22,889 - utils.quartile_analysis - INFO -     Control Q3-Q1: -225.9ms
2025-10-18 14:15:22,890 - utils.quartile_analysis - INFO -     Dyslexic Q3-Q1: -388.2ms
2025-10-18 14:15:22,951 - utils.quartile_analysis - INFO -   Fitting mixed model on 162,606 words...
2025-10-18 14:15:25,719 - utils.quartile_analysis - INFO -   GroupÃBin interaction: beta=-122.40, p=0.0000
2025-10-18 14:15:25,746 - utils.quartile_analysis - INFO -   Computing bootstrap CIs (1000 iterations)...
2025-10-18 14:15:27,447 - utils.quartile_analysis - INFO -   Bootstrap 95% CI for interaction: [-225.59, -87.90]
2025-10-18 14:15:27,447 - utils.quartile_analysis - INFO - 
Analyzing surprisal...
2025-10-18 14:15:28,237 - utils.quartile_analysis - INFO -   Computed means for 57 participants
2025-10-18 14:15:28,237 - utils.quartile_analysis - INFO -     Control Q3-Q1: 135.8ms
2025-10-18 14:15:28,238 - utils.quartile_analysis - INFO -     Dyslexic Q3-Q1: 277.3ms
2025-10-18 14:15:28,302 - utils.quartile_analysis - INFO -   Fitting mixed model on 163,257 words...
2025-10-18 14:15:31,310 - utils.quartile_analysis - INFO -   GroupÃBin interaction: beta=105.53, p=0.0000
2025-10-18 14:15:31,346 - utils.quartile_analysis - INFO -   Computing bootstrap CIs (1000 iterations)...
2025-10-18 14:15:33,218 - utils.quartile_analysis - INFO -   Bootstrap 95% CI for interaction: [84.99, 194.82]
2025-10-18 14:15:33,219 - utils.continuous_models - INFO - ============================================================
2025-10-18 14:15:33,219 - utils.continuous_models - INFO - PART B: CONTINUOUS MODELS (TWO-PART)
2025-10-18 14:15:33,219 - utils.continuous_models - INFO - ============================================================
2025-10-18 14:15:33,219 - utils.continuous_models - INFO - 
1. SKIPPING MODEL (Logistic with Clustered SEs)
2025-10-18 14:15:33,323 - utils.continuous_models - INFO -   Formula: skipped ~ dyslexic_int * (word_length_scaled + word_frequency_zipf_scaled + surprisal_scaled)
2025-10-18 14:15:33,324 - utils.continuous_models - INFO -   Fitting on 326,496 words...
2025-10-18 14:15:34,055 - utils.continuous_models - INFO -   Model fitted successfully with clustered SEs
2025-10-18 14:15:34,056 - utils.continuous_models - INFO -     dyslexic_int:word_length_scaled: beta=-0.0250, p=0.6714
2025-10-18 14:15:34,057 - utils.continuous_models - INFO -     dyslexic_int:word_frequency_zipf_scaled: beta=-0.0640, p=0.1975
2025-10-18 14:15:34,057 - utils.continuous_models - INFO -     dyslexic_int:surprisal_scaled: beta=-0.0272, p=0.2667
2025-10-18 14:15:34,068 - utils.continuous_models - INFO - 
2. DURATION MODEL (Log-TRT | Fixated)
2025-10-18 14:15:34,237 - utils.continuous_models - INFO -   Formula: log_TRT ~ dyslexic_int * (word_length_scaled + word_frequency_zipf_scaled + surprisal_scaled)
2025-10-18 14:15:34,238 - utils.continuous_models - INFO -   Fitting on 204,224 fixated words...
2025-10-18 14:15:35,369 - utils.continuous_models - INFO -   Model fitted successfully
2025-10-18 14:15:35,369 - utils.continuous_models - INFO -   Smearing correction factor: 1.1562
2025-10-18 14:15:35,370 - utils.continuous_models - INFO -     dyslexic_int:word_length_scaled: beta=0.0078, p=0.0585
2025-10-18 14:15:35,370 - utils.continuous_models - INFO -     dyslexic_int:word_frequency_zipf_scaled: beta=-0.0084, p=0.0678
2025-10-18 14:15:35,370 - utils.continuous_models - INFO -     dyslexic_int:surprisal_scaled: beta=0.0349, p=0.0000
2025-10-18 14:15:35,381 - utils.continuous_models - INFO - 
3. PREDICTING EXPECTED ERT
2025-10-18 14:15:35,460 - utils.continuous_models - INFO -   Predicting expected ERT...
2025-10-18 14:15:35,737 - utils.continuous_models - INFO -   Predicted expected ERT for 326,496 words
2025-10-18 14:15:35,739 - utils.continuous_models - INFO -     Mean expected ERT: 228.71ms
2025-10-18 14:15:35,740 - utils.continuous_models - INFO -     Mean observed ERT: 236.03ms
2025-10-18 14:15:35,749 - utils.continuous_models - INFO - 
4. VARIANCE EXPLAINED (ÎRÂ² on Expected ERT)
2025-10-18 14:15:35,878 - utils.continuous_models - INFO -   Computing ÎRÂ² on 326,496 observations
2025-10-18 14:15:36,200 - utils.continuous_models - INFO -     M0: RÂ² = 0.2074
2025-10-18 14:15:36,573 - utils.continuous_models - INFO -     M1: RÂ² = 0.9267
2025-10-18 14:15:36,929 - utils.continuous_models - INFO -     M2: RÂ² = 0.9501
2025-10-18 14:15:37,297 - utils.continuous_models - INFO -     M3: RÂ² = 0.9608
2025-10-18 14:15:37,297 - utils.continuous_models - INFO - 
  Variance Explained (ÎRÂ²):
2025-10-18 14:15:37,297 - utils.continuous_models - INFO -     Length: ÎRÂ² = 0.7193 (71.93%)
2025-10-18 14:15:37,297 - utils.continuous_models - INFO -     Frequency: ÎRÂ² = 0.0233 (2.33%)
2025-10-18 14:15:37,297 - utils.continuous_models - INFO -     Surprisal: ÎRÂ² = 0.0107 (1.07%)
2025-10-18 14:15:37,328 - utils.continuous_models - INFO - 
5. MS SHIFTS (Q1âQ3 on Expected ERT)
2025-10-18 14:15:37,336 - utils.continuous_models - INFO - 
  word_length: Q1=2.00, Q3=6.00
2025-10-18 14:15:37,355 - utils.continuous_models - INFO -     Control: 136.3ms -> 220.5ms (Î = 84.1ms)
2025-10-18 14:15:37,370 - utils.continuous_models - INFO -     Dyslexic: 239.3ms -> 361.0ms (Î = 121.7ms)
2025-10-18 14:15:37,380 - utils.continuous_models - INFO - 
  word_frequency_zipf: Q1=4.91, Q3=7.10
2025-10-18 14:15:37,400 - utils.continuous_models - INFO -     Control: 209.3ms -> 167.5ms (Î = -41.8ms)
2025-10-18 14:15:37,421 - utils.continuous_models - INFO -     Dyslexic: 342.6ms -> 290.3ms (Î = -52.3ms)
2025-10-18 14:15:37,431 - utils.continuous_models - INFO - 
  surprisal: Q1=2.76, Q3=9.97
2025-10-18 14:15:37,451 - utils.continuous_models - INFO -     Control: 185.2ms -> 195.4ms (Î = 10.2ms)
2025-10-18 14:15:37,472 - utils.continuous_models - INFO -     Dyslexic: 300.9ms -> 334.1ms (Î = 33.3ms)
2025-10-18 14:15:37,473 - utils.continuous_models - INFO - 
6. SLOPE RATIOS (Finite Differences on Expected ERT)
2025-10-18 14:15:37,515 - utils.continuous_models - INFO -   word_length: SR = 1.447 (AMPLIFIED)
2025-10-18 14:15:37,556 - utils.continuous_models - INFO -   word_frequency_zipf: SR = 1.251 (AMPLIFIED)
2025-10-18 14:15:37,601 - utils.continuous_models - INFO -   surprisal: SR = 3.257 (AMPLIFIED)
2025-10-18 14:15:37,601 - utils.continuous_models - INFO - 
7. BOOTSTRAP CONFIDENCE INTERVALS
2025-10-18 14:15:37,601 - utils.continuous_models - INFO -   Computing bootstrap CIs (100 iterations)...
2025-10-18 14:16:00,228 - utils.gap_decomposition - INFO - ============================================================
2025-10-18 14:16:00,228 - utils.gap_decomposition - INFO - PART C: GAP DECOMPOSITION (ON OBSERVED ERT)
2025-10-18 14:16:00,228 - utils.gap_decomposition - INFO - ============================================================
2025-10-18 14:16:00,342 - utils.gap_decomposition - INFO - Using common sample of 326,496 observations for all models
2025-10-18 14:16:00,343 - utils.gap_decomposition - INFO - 
Fitting M0 (main effects only)...
2025-10-18 14:16:00,343 - utils.gap_decomposition - INFO -   Formula: ERT ~ dyslexic_int
2025-10-18 14:16:00,678 - utils.gap_decomposition - INFO -   M0 fitted successfully (OLS with clustered SEs)
2025-10-18 14:16:00,678 - utils.gap_decomposition - INFO - 
Fitting M1 (main effects only)...
2025-10-18 14:16:00,678 - utils.gap_decomposition - INFO -   Formula: ERT ~ dyslexic_int + word_length_scaled
2025-10-18 14:16:01,059 - utils.gap_decomposition - INFO -   M1 fitted successfully (OLS with clustered SEs)
2025-10-18 14:16:01,059 - utils.gap_decomposition - INFO - 
Fitting M2 (main effects only)...
2025-10-18 14:16:01,059 - utils.gap_decomposition - INFO -   Formula: ERT ~ dyslexic_int + word_length_scaled + word_frequency_zipf_scaled
2025-10-18 14:16:01,513 - utils.gap_decomposition - INFO -   M2 fitted successfully (OLS with clustered SEs)
2025-10-18 14:16:01,513 - utils.gap_decomposition - INFO - 
Fitting M3 (main effects only)...
2025-10-18 14:16:01,513 - utils.gap_decomposition - INFO -   Formula: ERT ~ dyslexic_int + word_length_scaled + word_frequency_zipf_scaled + surprisal_scaled
2025-10-18 14:16:01,912 - utils.gap_decomposition - INFO -   M3 fitted successfully (OLS with clustered SEs)
2025-10-18 14:16:01,926 - utils.gap_decomposition - INFO - 
Computing modelled group gaps from predictions on common sample...
2025-10-18 14:16:01,927 - utils.gap_decomposition - INFO -   Computing modelled group gaps (Îk)...
2025-10-18 14:16:02,158 - utils.gap_decomposition - INFO -     M0: Î0 = 143.02ms
2025-10-18 14:16:02,414 - utils.gap_decomposition - INFO -     M1: Î1 = 141.94ms
2025-10-18 14:16:02,664 - utils.gap_decomposition - INFO -     M2: Î2 = 142.09ms
2025-10-18 14:16:02,909 - utils.gap_decomposition - INFO -     M3: Î3 = 141.93ms
2025-10-18 14:16:02,929 - utils.gap_decomposition - INFO -   Computing composition gaps...
2025-10-18 14:16:03,083 - utils.gap_decomposition - INFO -     M0: Composition gap = -0.00ms
2025-10-18 14:16:03,279 - utils.gap_decomposition - INFO -     M1: Composition gap = 1.09ms
2025-10-18 14:16:03,485 - utils.gap_decomposition - INFO -     M2: Composition gap = 0.94ms
2025-10-18 14:16:03,683 - utils.gap_decomposition - INFO -     M3: Composition gap = 1.09ms
2025-10-18 14:16:03,705 - utils.gap_decomposition - INFO -   Computing RÂ² on observed ERT...
2025-10-18 14:16:03,713 - utils.gap_decomposition - INFO -     M0: RÂ² = 0.0354
2025-10-18 14:16:03,719 - utils.gap_decomposition - INFO -     M1: RÂ² = 0.1613
2025-10-18 14:16:03,727 - utils.gap_decomposition - INFO -     M2: RÂ² = 0.1653
2025-10-18 14:16:03,734 - utils.gap_decomposition - INFO -     M3: RÂ² = 0.1670
2025-10-18 14:16:03,734 - utils.gap_decomposition - INFO - 
Fitting interaction models...
2025-10-18 14:16:03,845 - utils.gap_decomposition - INFO -   Fitting M1_int...
2025-10-18 14:16:04,192 - utils.gap_decomposition - INFO -     M1_int fitted successfully
2025-10-18 14:16:04,254 - utils.gap_decomposition - INFO -   Fitting M2_int...
2025-10-18 14:16:04,633 - utils.gap_decomposition - INFO -     M2_int fitted successfully
2025-10-18 14:16:04,701 - utils.gap_decomposition - INFO -   Fitting M3_int...
2025-10-18 14:16:05,156 - utils.gap_decomposition - INFO -     M3_int fitted successfully
2025-10-18 14:16:05,165 - utils.gap_decomposition - INFO - 
Oaxaca/Blinder Decomposition (on Observed ERT):
2025-10-18 14:16:06,215 - utils.gap_decomposition - INFO -   Total observed gap: 143.02ms
2025-10-18 14:16:06,216 - utils.gap_decomposition - INFO -   Composition effect: 1.09ms (0.8%)
2025-10-18 14:16:06,216 - utils.gap_decomposition - INFO -   Coefficient effect: 141.60ms (99.0%)
2025-10-18 14:16:06,216 - utils.gap_decomposition - INFO -   Residual: 0.33ms
2025-10-18 14:16:06,216 - utils.gap_decomposition - INFO - 
  â Groups read similar-difficulty words (composition â 0%)
2025-10-18 14:16:06,216 - utils.gap_decomposition - INFO -   â Gap is due to differential sensitivity (coefficient effect)
2025-10-18 14:16:06,302 - utils.gap_decomposition - INFO - 
============================================================
2025-10-18 14:16:06,303 - utils.gap_decomposition - INFO - GAP DECOMPOSITION SUMMARY (ON OBSERVED ERT)
2025-10-18 14:16:06,303 - utils.gap_decomposition - INFO - ============================================================
2025-10-18 14:16:06,303 - utils.gap_decomposition - INFO - 
Baseline modelled gap (Î0): 143.02ms
2025-10-18 14:16:06,303 - utils.gap_decomposition - INFO - 
M1 (+Length):
2025-10-18 14:16:06,304 - utils.gap_decomposition - INFO -   Modelled gap (Î1): 141.94ms
2025-10-18 14:16:06,304 - utils.gap_decomposition - INFO -   Composition gap: 1.09ms
2025-10-18 14:16:06,304 - utils.gap_decomposition - INFO -   % Gap explained: 0.8%
2025-10-18 14:16:06,304 - utils.gap_decomposition - INFO -   ÎRÂ²: 0.1259
2025-10-18 14:16:06,304 - utils.gap_decomposition - INFO - 
M2 (+Frequency):
2025-10-18 14:16:06,304 - utils.gap_decomposition - INFO -   Modelled gap (Î2): 142.09ms
2025-10-18 14:16:06,305 - utils.gap_decomposition - INFO -   Composition gap: 0.94ms
2025-10-18 14:16:06,305 - utils.gap_decomposition - INFO -   % Gap explained: 0.7%
2025-10-18 14:16:06,305 - utils.gap_decomposition - INFO -   ÎRÂ²: 0.0040
2025-10-18 14:16:06,305 - utils.gap_decomposition - INFO - 
M3 (+Surprisal):
2025-10-18 14:16:06,305 - utils.gap_decomposition - INFO -   Modelled gap (Î3): 141.93ms
2025-10-18 14:16:06,305 - utils.gap_decomposition - INFO -   Composition gap: 1.09ms
2025-10-18 14:16:06,306 - utils.gap_decomposition - INFO -   % Gap explained: 0.8%
2025-10-18 14:16:06,306 - utils.gap_decomposition - INFO -   ÎRÂ²: 0.0018
2025-10-18 14:16:06,306 - utils.sensitivity_analysis - INFO - ============================================================
2025-10-18 14:16:06,306 - utils.sensitivity_analysis - INFO - SENSITIVITY ANALYSES
2025-10-18 14:16:06,306 - utils.sensitivity_analysis - INFO - ============================================================
2025-10-18 14:16:06,306 - utils.sensitivity_analysis - INFO - 
1. RESIDUALIZED SURPRISAL MODEL
2025-10-18 14:16:06,374 - utils.sensitivity_analysis - INFO -   Formula: ERT ~ dyslexic_int * (word_length_scaled + word_frequency_zipf_scaled + surprisal_resid)
2025-10-18 14:16:07,057 - utils.sensitivity_analysis - INFO -   Residualized surprisal: beta=11.6330, p=0.0000
2025-10-18 14:16:07,058 - utils.sensitivity_analysis - INFO -   [OK] Surprisal effect robust to frequency collinearity
2025-10-18 14:16:07,072 - utils.sensitivity_analysis - INFO - 
2. SUBJECT-WISE CROSS-VALIDATION
2025-10-18 14:16:07,073 - utils.sensitivity_analysis - INFO -   Running 10-fold subject-wise CV...
2025-10-18 14:16:07,317 - utils.sensitivity_analysis - INFO -     Fold 1/10
2025-10-18 14:16:07,980 - utils.sensitivity_analysis - INFO -     Fold 2/10
2025-10-18 14:16:08,609 - utils.sensitivity_analysis - INFO -     Fold 3/10
2025-10-18 14:16:09,308 - utils.sensitivity_analysis - INFO -     Fold 4/10
2025-10-18 14:16:09,927 - utils.sensitivity_analysis - INFO -     Fold 5/10
2025-10-18 14:16:10,629 - utils.sensitivity_analysis - INFO -     Fold 6/10
2025-10-18 14:16:11,970 - utils.sensitivity_analysis - INFO -     Fold 7/10
2025-10-18 14:16:12,694 - utils.sensitivity_analysis - INFO -     Fold 8/10
2025-10-18 14:16:13,327 - utils.sensitivity_analysis - INFO -     Fold 9/10
2025-10-18 14:16:14,098 - utils.sensitivity_analysis - INFO -     Fold 10/10
2025-10-18 14:16:14,712 - utils.sensitivity_analysis - INFO -   Cross-validation RÂ²: -0.3352 Â± 0.2999
2025-10-18 14:16:14,712 - utils.sensitivity_analysis - INFO -   Based on 10 successful folds
2025-10-18 14:16:14,758 - utils.sensitivity_analysis - INFO - 
3. ALTERNATIVE BINNING (Terciles & Quintiles)
2025-10-18 14:16:14,759 - utils.sensitivity_analysis - INFO - 
  Testing terciles...
2025-10-18 14:16:14,892 - utils.sensitivity_analysis - INFO -     word_length: Control Î=202.4ms, Dyslexic Î=304.4ms
2025-10-18 14:16:14,995 - utils.sensitivity_analysis - INFO -     word_frequency_zipf: Control Î=-187.4ms, Dyslexic Î=-283.4ms
2025-10-18 14:16:15,101 - utils.sensitivity_analysis - INFO -     surprisal: Control Î=112.9ms, Dyslexic Î=200.7ms
2025-10-18 14:16:15,102 - utils.sensitivity_analysis - INFO - 
  Testing quintiles...
2025-10-18 14:16:15,178 - utils.sensitivity_analysis - INFO -     word_length: Control Î=284.7ms, Dyslexic Î=452.5ms
2025-10-18 14:16:15,258 - utils.sensitivity_analysis - INFO -     word_frequency_zipf: Control Î=-242.1ms, Dyslexic Î=-393.1ms
2025-10-18 14:16:15,343 - utils.sensitivity_analysis - INFO -     surprisal: Control Î=150.5ms, Dyslexic Î=270.2ms
2025-10-18 14:16:15,351 - utils.hypothesis_visualization - INFO - ============================================================
2025-10-18 14:16:15,352 - utils.hypothesis_visualization - INFO - CREATING VISUALIZATIONS
2025-10-18 14:16:15,352 - utils.hypothesis_visualization - INFO - ============================================================
2025-10-18 14:16:15,352 - utils.hypothesis_visualization - INFO - 
1. Continuous effect curves...
2025-10-18 14:16:16,678 - utils.hypothesis_visualization - INFO -   Saved to results\continuous_effects_with_quartiles.png
2025-10-18 14:16:16,681 - utils.hypothesis_visualization - INFO - 2. Gap decomposition...
2025-10-18 14:16:17,010 - utils.hypothesis_visualization - INFO -   Saved to results\gap_decomposition.png
2025-10-18 14:16:17,010 - utils.hypothesis_visualization - INFO - 3. Slope ratios...
2025-10-18 14:16:17,311 - utils.hypothesis_visualization - INFO -   Saved to results\slope_ratios.png
2025-10-18 14:16:17,311 - utils.hypothesis_visualization - INFO - 4. Model comparison...
2025-10-18 14:16:17,323 - matplotlib.category - INFO - Using categorical units to plot a list of strings that are all parsable as floats or dates. If these strings should be plotted as numbers, cast to the appropriate data type before plotting.
2025-10-18 14:16:17,326 - matplotlib.category - INFO - Using categorical units to plot a list of strings that are all parsable as floats or dates. If these strings should be plotted as numbers, cast to the appropriate data type before plotting.
2025-10-18 14:16:17,720 - utils.hypothesis_visualization - INFO -   Saved to results\model_comparison.png
2025-10-18 14:16:17,721 - utils.hypothesis_visualization - INFO - 5. Quartile effects...
2025-10-18 14:16:18,345 - utils.hypothesis_visualization - INFO -   Saved to results\quartile_effects.png
2025-10-18 14:16:18,345 - utils.hypothesis_visualization - INFO - 6. Predicted vs observed...
2025-10-18 14:16:19,278 - utils.hypothesis_visualization - INFO -   Saved to results\predicted_vs_observed.png
2025-10-18 14:16:19,278 - utils.hypothesis_visualization - INFO - 
All visualizations saved to results
2025-10-18 14:16:19,278 - utils.results_reporting - INFO - ============================================================
2025-10-18 14:16:19,279 - utils.results_reporting - INFO - GENERATING RESULTS REPORT
2025-10-18 14:16:19,279 - utils.results_reporting - INFO - ============================================================
2025-10-18 14:16:19,281 - utils.results_reporting - INFO - 
Testing Hypothesis 1: Feature effects on reading time
2025-10-18 14:16:19,282 - utils.results_reporting - INFO -   Length: beta=0.1222, p=0.0000 - CONFIRMED
2025-10-18 14:16:19,282 - utils.results_reporting - INFO -   Frequency: beta=-0.0486, p=0.0000 - CONFIRMED
2025-10-18 14:16:19,282 - utils.results_reporting - INFO -   Surprisal: beta=0.0317, p=0.0000 - CONFIRMED
2025-10-18 14:16:19,282 - utils.results_reporting - INFO - 
Hypothesis 1: CONFIRMED
2025-10-18 14:16:19,283 - utils.results_reporting - INFO - 
Testing Hypothesis 2: Dyslexic amplification
2025-10-18 14:16:19,283 - utils.results_reporting - INFO - 
Hypothesis 2: CONFIRMED
2025-10-18 14:16:19,283 - utils.results_reporting - INFO - 
Testing Hypothesis 3: Gap explanation
2025-10-18 14:16:19,283 - utils.results_reporting - INFO -   Baseline gap: 143.02ms
2025-10-18 14:16:19,283 - utils.results_reporting - INFO -   Final gap: 141.93ms
2025-10-18 14:16:19,283 - utils.results_reporting - INFO -   Total explained: 0.8%
2025-10-18 14:16:19,283 - utils.results_reporting - INFO -     Length: 0.8%
2025-10-18 14:16:19,284 - utils.results_reporting - INFO -     Frequency: -0.1%
2025-10-18 14:16:19,284 - utils.results_reporting - INFO -     Surprisal: 0.1%
2025-10-18 14:16:19,284 - utils.results_reporting - INFO - 
Hypothesis 3: NOT CONFIRMED
2025-10-18 14:16:19,285 - utils.results_reporting - INFO - 
================================================================================
2025-10-18 14:16:19,285 - utils.results_reporting - INFO - HYPOTHESIS TESTING RESULTS SUMMARY
2025-10-18 14:16:19,285 - utils.results_reporting - INFO - ================================================================================
2025-10-18 14:16:19,285 - utils.results_reporting - INFO - 
HYPOTHESIS 1: CONFIRMED
2025-10-18 14:16:19,285 - utils.results_reporting - INFO -   All features predict reading time in expected directions
2025-10-18 14:16:19,285 - utils.results_reporting - INFO - 
HYPOTHESIS 2: CONFIRMED
2025-10-18 14:16:19,285 - utils.results_reporting - INFO -   All features show dyslexic amplification (SR > 1)
2025-10-18 14:16:19,287 - utils.results_reporting - INFO - 
HYPOTHESIS 3: NOT CONFIRMED
2025-10-18 14:16:19,287 - utils.results_reporting - INFO -   Features explain 0.8% of the dyslexic-control gap
2025-10-18 14:16:19,287 - utils.results_reporting - INFO - 
OVERALL: MIXED RESULTS
2025-10-18 14:16:19,287 - utils.results_reporting - INFO - 
Key Findings:
2025-10-18 14:16:19,287 - utils.results_reporting - INFO -   â¢ 3/3 features show dyslexic amplification
2025-10-18 14:16:19,287 - utils.results_reporting - INFO -   â¢ Features explain 0.8% of group gap
2025-10-18 14:16:19,287 - utils.results_reporting - INFO -   â¢ Effects consistent across multiple analyses
2025-10-18 14:16:19,288 - utils.results_reporting - INFO - Report generation complete
2025-10-18 14:16:19,290 - utils.misc_utils - INFO - Results saved to results\hypothesis_testing_results.json
2025-10-18 14:16:19,290 - __main__ - INFO - 
Hypothesis testing complete! Results saved to results
2025-10-18 17:45:58,133 - __main__ - INFO - Dyslexia Time Analysis Pipeline initialized
2025-10-18 17:45:58,134 - __main__ - INFO - Running pre-processing steps...
2025-10-18 17:45:58,134 - __main__ - INFO - Running exploratory analysis...
2025-10-18 17:45:58,134 - __main__ - INFO - Loading CopCo dataset...
2025-10-18 17:45:58,140 - utils.data_utils - INFO - Loading 57 participant files...
2025-10-18 17:46:00,066 - utils.data_utils - INFO - Starting with 335,203 total word entries
2025-10-18 17:46:00,271 - utils.data_utils - INFO - Word fixation patterns:
2025-10-18 17:46:00,271 - utils.data_utils - INFO -   - Skipped words (0 fixations): 126,302
2025-10-18 17:46:00,271 - utils.data_utils - INFO -   - Fixated words (1+ fixations): 208,901
2025-10-18 17:46:00,272 - utils.data_utils - INFO -   - Unknown fixations (NaN): 0
2025-10-18 17:46:00,304 - utils.data_utils - INFO - Fixated words reading times: median 272ms, 99th percentile 1777ms
2025-10-18 17:46:00,306 - utils.data_utils - INFO - Removed 14 fixated words with extreme reading times (0 too short, 14 too long)
2025-10-18 17:46:00,407 - utils.data_utils - INFO - Removed 23 words longer than 30 characters (likely data errors)
2025-10-18 17:46:00,453 - utils.data_utils - INFO - Final dataset: 126,302 skipped words, 208,864 fixated words
2025-10-18 17:46:00,454 - utils.data_utils - INFO - Data cleaning complete: 335,166 words retained (100.0% of original)
2025-10-18 17:46:00,467 - utils.data_utils - INFO - Groups identified: 19 dyslexic, 39 control
2025-10-18 17:46:00,557 - __main__ - INFO - Calculating skipping probabilities...
2025-10-18 17:46:00,561 - utils.skipping_utils - INFO - Skipping analysis from ExtractedFeatures:
2025-10-18 17:46:00,562 - utils.skipping_utils - INFO -   Total words: 335,166
2025-10-18 17:46:00,562 - utils.skipping_utils - INFO -   Skipped: 126,302 (37.7%)
2025-10-18 17:46:00,562 - utils.skipping_utils - INFO -   Fixated: 208,864 (62.3%)
2025-10-18 17:46:00,615 - __main__ - INFO - Skipping analysis: 37.7% overall rate
2025-10-18 17:46:00,639 - __main__ - INFO - Loaded: 335,166 words from 57 participants
2025-10-18 17:46:00,640 - __main__ - INFO - ============================================================
2025-10-18 17:46:00,640 - __main__ - INFO - COMPUTING LINGUISTIC FEATURES
2025-10-18 17:46:00,640 - __main__ - INFO - ============================================================
2025-10-18 17:46:00,641 - utils.linguistic_features - INFO - Loading Danish frequency list from danish_frequencies\danish_leipzig_for_analysis.txt
2025-10-18 17:46:02,076 - utils.linguistic_features - WARNING - Found 2 duplicate words after lowercasing. 
2025-10-18 17:46:02,524 - utils.linguistic_features - INFO - Loaded 1,499,999 word proportions from Leipzig Corpora
2025-10-18 17:46:02,639 - utils.linguistic_features - INFO - Computing word frequency...
2025-10-18 17:46:02,640 - utils.linguistic_features - INFO -   Stripping punctuation from words before frequency lookup
2025-10-18 17:46:03,391 - utils.linguistic_features - INFO - 13 missing word instances were punctuation-only
2025-10-18 17:46:03,392 - utils.linguistic_features - WARNING - 4,586 word instances (1.4%) not found in frequency list (197 unique valid words)
2025-10-18 17:46:03,392 - utils.linguistic_features - INFO - Sample of 197 missing valid words: ['af j.j', 'bliniopskrifter', 'blintzes', 'broderet messehagler og', 'bygnings-konstruktioner', 'certeau', 'coconference', 'demonstrationsland', 'downcycling', 'ecodesign-direktivet', 'fattigdomsfÃ¦ngel', 'finansudspil', 'forbrugsopgjorte', 'forÃ¥rsbebudning', 'fosforudnyttelsen', 'frederiksavn', 'frejakult', 'fÃ¦drelandssalmen', 'fÃ¸dt 16', 'havstrategier', 'heksetrold', 'hetzbÃ¸lger', 'htx-fag', 'hÃ¸jskoledanmark', 'hâerne', 'i star', 'jernalderkulturen', 'kentauerhaven', 'kusine, christine', 'meduddannere', 'nul-fejlkultur', 'og star', 'ph.d.-stilling', 'skraldefester', 'skraldepigerne', 'skywalker ogsÃ¥', 'slomo', 'som blomstermaler', 'superlÃ¦rer', 'sÃ¸nnerne kronprins', 'takstfinansiere', 'tankestrukturer', 'til landskabsmaleri', 'tilran', 'valborgsnatten', 'vandmiljÃ¸indsatsen', 'vindmÃ¸llehoveder', 'vk-fÃ¦llesskabet', 'Ã¦g-lancetformede', 'Ã¦ttesamfund']... (147 more)
2025-10-18 17:46:03,404 - utils.linguistic_features - INFO - Excluding 4,599 word instances (1.4%) with missing frequencies from analysis
2025-10-18 17:46:03,574 - utils.linguistic_features - INFO - Remaining dataset: 330,567 words
2025-10-18 17:46:03,575 - utils.linguistic_features - INFO - Final dataset: 330,567 words with valid frequencies
2025-10-18 17:46:07,809 - utils.linguistic_features - INFO - Loading causal language model: KennethTM/gpt2-medium-danish
2025-10-18 17:46:09,528 - utils.linguistic_features - INFO - Using CPU for surprisal computation
2025-10-18 17:46:09,529 - utils.linguistic_features - INFO - Causal language model loaded successfully
2025-10-18 17:46:09,529 - utils.linguistic_features - INFO - Computing surprisal with causal GPT-2 (left-to-right)...
2025-10-18 17:46:10,996 - utils.linguistic_features - INFO - Dataset statistics:
2025-10-18 17:46:10,996 - utils.linguistic_features - INFO -   Total participant-sentence instances: 20,707
2025-10-18 17:46:10,997 - utils.linguistic_features - INFO -   Unique sentence texts: 1,986
2025-10-18 17:46:10,997 - utils.linguistic_features - INFO -   Average participants per sentence: 10.4
2025-10-18 17:46:10,997 - utils.linguistic_features - INFO - Loading cached surprisal values from word_surprisal\surprisal_cache_gpt2.pkl
2025-10-18 17:46:11,011 - utils.linguistic_features - INFO - Loaded surprisal for 1,986 unique sentences
2025-10-18 17:46:11,011 - utils.linguistic_features - INFO - Broadcasting surprisal values to all participant instances...
2025-10-18 17:46:11,012 - utils.linguistic_features - INFO -   Mapping surprisal to words...
2025-10-18 17:46:14,626 - utils.linguistic_features - INFO -   Mapped 326,496 words
2025-10-18 17:46:14,627 - utils.linguistic_features - INFO - 
Surprisal Computation Results:
2025-10-18 17:46:14,627 - utils.linguistic_features - INFO -   Unique sentences processed: 1,986
2025-10-18 17:46:14,627 - utils.linguistic_features - INFO -   Total words with surprisal: 326,496 / 330,567
2025-10-18 17:46:14,628 - utils.linguistic_features - INFO -   Mean: 6.93 bits
2025-10-18 17:46:14,632 - utils.linguistic_features - INFO -   Median: 5.69 bits
2025-10-18 17:46:14,634 - utils.linguistic_features - INFO -   Std: 5.55 bits
2025-10-18 17:46:14,635 - utils.linguistic_features - INFO -   Range: [0.00, 59.34] bits
2025-10-18 17:46:14,663 - utils.linguistic_features - INFO - Linguistic features added successfully
2025-10-18 17:46:14,663 - utils.linguistic_features - INFO - 
Feature Summary:
2025-10-18 17:46:14,665 - utils.linguistic_features - INFO -   Word length: mean=4.67, std=3.08
2025-10-18 17:46:14,668 - utils.linguistic_features - INFO -   Zipf frequency: mean=5.85, std=1.38, range=[0.91, 7.51]
2025-10-18 17:46:14,671 - utils.linguistic_features - INFO -   Surprisal: mean=6.93, std=5.55
2025-10-18 17:46:14,694 - __main__ - INFO - Saving processed data to results\processed_data_full.csv
2025-10-18 17:46:14,694 - __main__ - INFO -   Shape: (330567, 41)
2025-10-18 17:46:14,694 - __main__ - INFO -   Columns: 41
2025-10-18 17:46:19,695 - __main__ - INFO - Processed data saved successfully
2025-10-18 17:46:19,941 - __main__ - INFO - Data dictionary saved to results\processed_data_full.txt
2025-10-18 17:46:20,017 - utils.stats_utils - INFO - Added enhanced skipping statistics to basic stats
2025-10-18 17:46:20,018 - utils.stats_utils - INFO - Overall skipping rate: 37.7%
2025-10-18 17:46:20,443 - __main__ - INFO - Analyzing linguistic feature effects...
2025-10-18 17:46:20,916 - __main__ - INFO - Linguistic feature analysis complete
2025-10-18 17:46:20,935 - utils.misc_utils - INFO - Results saved to results\exploratory_summary.json
2025-10-18 17:46:22,274 - utils.visualization_utils - INFO - Exploratory plots saved to results\exploratory_plots.png
2025-10-18 17:46:23,723 - utils.visualization_utils - INFO - Group summary plots saved to results\group_summary_plots.png
2025-10-18 17:46:23,729 - __main__ - INFO - Creating linguistic feature visualizations...
2025-10-18 17:46:26,584 - __main__ - INFO - Linguistic feature plots saved to results\linguistic_features_plots.png
2025-10-18 17:46:26,613 - __main__ - INFO - Analysis complete. Results saved to results
2025-10-18 17:46:26,635 - __main__ - INFO - Analysis complete!
2025-10-18 17:48:39,335 - __main__ - INFO - Dyslexia Time Analysis Pipeline initialized
2025-10-18 17:48:39,336 - __main__ - INFO - Running pre-processing steps...
2025-10-18 17:48:39,336 - __main__ - INFO - Running exploratory analysis...
2025-10-18 17:48:39,336 - __main__ - INFO - Loading CopCo dataset...
2025-10-18 17:48:39,336 - utils.data_utils - INFO - Loading 57 participant files...
2025-10-18 17:48:41,148 - utils.data_utils - INFO - Starting with 335,203 total word entries
2025-10-18 17:48:41,318 - utils.data_utils - INFO - Word fixation patterns:
2025-10-18 17:48:41,318 - utils.data_utils - INFO -   - Skipped words (0 fixations): 126,302
2025-10-18 17:48:41,318 - utils.data_utils - INFO -   - Fixated words (1+ fixations): 208,901
2025-10-18 17:48:41,319 - utils.data_utils - INFO -   - Unknown fixations (NaN): 0
2025-10-18 17:48:41,348 - utils.data_utils - INFO - Fixated words reading times: median 272ms, 99th percentile 1777ms
2025-10-18 17:48:41,350 - utils.data_utils - INFO - Removed 14 fixated words with extreme reading times (0 too short, 14 too long)
2025-10-18 17:48:41,445 - utils.data_utils - INFO - Removed 23 words longer than 30 characters (likely data errors)
2025-10-18 17:48:41,482 - utils.data_utils - INFO - Final dataset: 126,302 skipped words, 208,864 fixated words
2025-10-18 17:48:41,482 - utils.data_utils - INFO - Data cleaning complete: 335,166 words retained (100.0% of original)
2025-10-18 17:48:41,490 - utils.data_utils - INFO - Groups identified: 19 dyslexic, 39 control
2025-10-18 17:48:41,558 - __main__ - INFO - Calculating skipping probabilities...
2025-10-18 17:48:41,561 - utils.skipping_utils - INFO - Skipping analysis from ExtractedFeatures:
2025-10-18 17:48:41,561 - utils.skipping_utils - INFO -   Total words: 335,166
2025-10-18 17:48:41,561 - utils.skipping_utils - INFO -   Skipped: 126,302 (37.7%)
2025-10-18 17:48:41,561 - utils.skipping_utils - INFO -   Fixated: 208,864 (62.3%)
2025-10-18 17:48:41,601 - __main__ - INFO - Skipping analysis: 37.7% overall rate
2025-10-18 17:48:41,618 - __main__ - INFO - Loaded: 335,166 words from 57 participants
2025-10-18 17:48:41,618 - __main__ - INFO - ============================================================
2025-10-18 17:48:41,618 - __main__ - INFO - COMPUTING LINGUISTIC FEATURES
2025-10-18 17:48:41,618 - __main__ - INFO - ============================================================
2025-10-18 17:48:41,618 - utils.linguistic_features - INFO - Loading Danish frequency list from danish_frequencies\danish_leipzig_for_analysis.txt
2025-10-18 17:48:42,979 - utils.linguistic_features - WARNING - Found 2 duplicate words after lowercasing. 
2025-10-18 17:48:43,447 - utils.linguistic_features - INFO - Loaded 1,499,999 word proportions from Leipzig Corpora
2025-10-18 17:48:43,531 - utils.linguistic_features - INFO - Computing word frequency...
2025-10-18 17:48:43,531 - utils.linguistic_features - INFO -   Stripping punctuation from words before frequency lookup
2025-10-18 17:48:44,185 - utils.linguistic_features - INFO - 13 missing word instances were punctuation-only
2025-10-18 17:48:44,185 - utils.linguistic_features - WARNING - 4,586 word instances (1.4%) not found in frequency list (197 unique valid words)
2025-10-18 17:48:44,186 - utils.linguistic_features - INFO - Sample of 197 missing valid words: ['2. (margrethe', '2000-direktiverne', 'abilifyer', 'af imperialismen', 'af j.j', 'af kong', 'amerikansk science', 'at blomsterstanden er', 'bjergstien', 'blintzes', 'broder-sÃ¸sterligt', 'broderet messehagler og', 'by-spildevand', 'by-spildevandet', 'chakri-dynasti', 'cybermind', 'dallis', 'dambrugsomrÃ¥det', 'ecodesign-direktivet', 'et nationalt', 'fattigdomsfÃ¦ngel', 'havstrategidirektivets', 'havtema', 'hejre (bromus', 'henrik (prinsgemalen', 'hâerne', 'idahot-forum', 'istandgÃ¸re', 'itx-klasse', 'kusine, christine', 'lgbtqi-familien', 'lgbtqi-miljÃ¸et', 'livsresultat', 'magteslÃ¸ses', 'med prins', 'midsommerfÃ¦lleskabet', 'minervafester', 'nabofolkeslag', 'pinsesalmerne', 'renÃ¦ssancekongen', 'slomo', 'songkla', 'statsminister fra', 'stress-sygdomme', 'terracottafabrik', 'traume for', 'vaneslÃ¦gt', 'var sveriges', 'vindmÃ¸lle-testanlÃ¦gget', 'Ã¦ttesamfund']... (147 more)
2025-10-18 17:48:44,193 - utils.linguistic_features - INFO - Excluding 4,599 word instances (1.4%) with missing frequencies from analysis
2025-10-18 17:48:44,327 - utils.linguistic_features - INFO - Remaining dataset: 330,567 words
2025-10-18 17:48:44,327 - utils.linguistic_features - INFO - Final dataset: 330,567 words with valid frequencies
2025-10-18 17:48:47,927 - utils.linguistic_features - INFO - Loading causal language model: KennethTM/gpt2-medium-danish
2025-10-18 17:48:49,556 - utils.linguistic_features - INFO - Using CPU for surprisal computation
2025-10-18 17:48:49,556 - utils.linguistic_features - INFO - Causal language model loaded successfully
2025-10-18 17:48:49,557 - utils.linguistic_features - INFO - Computing surprisal with causal GPT-2 (left-to-right)...
2025-10-18 17:48:50,973 - utils.linguistic_features - INFO - Dataset statistics:
2025-10-18 17:48:50,973 - utils.linguistic_features - INFO -   Total participant-sentence instances: 20,707
2025-10-18 17:48:50,973 - utils.linguistic_features - INFO -   Unique sentence texts: 1,986
2025-10-18 17:48:50,973 - utils.linguistic_features - INFO -   Average participants per sentence: 10.4
2025-10-18 17:48:50,973 - utils.linguistic_features - INFO - Loading cached surprisal values from word_surprisal\surprisal_cache_gpt2.pkl
2025-10-18 17:48:50,984 - utils.linguistic_features - INFO - Loaded surprisal for 1,986 unique sentences
2025-10-18 17:48:50,984 - utils.linguistic_features - INFO - Broadcasting surprisal values to all participant instances...
2025-10-18 17:48:50,984 - utils.linguistic_features - INFO -   Mapping surprisal to words...
2025-10-18 17:48:54,125 - utils.linguistic_features - INFO -   Mapped 326,496 words
2025-10-18 17:48:54,127 - utils.linguistic_features - INFO - 
Surprisal Computation Results:
2025-10-18 17:48:54,127 - utils.linguistic_features - INFO -   Unique sentences processed: 1,986
2025-10-18 17:48:54,127 - utils.linguistic_features - INFO -   Total words with surprisal: 326,496 / 330,567
2025-10-18 17:48:54,128 - utils.linguistic_features - INFO -   Mean: 6.93 bits
2025-10-18 17:48:54,131 - utils.linguistic_features - INFO -   Median: 5.69 bits
2025-10-18 17:48:54,132 - utils.linguistic_features - INFO -   Std: 5.55 bits
2025-10-18 17:48:54,133 - utils.linguistic_features - INFO -   Range: [0.00, 59.34] bits
2025-10-18 17:48:54,156 - utils.linguistic_features - INFO - Linguistic features added successfully
2025-10-18 17:48:54,156 - utils.linguistic_features - INFO - 
Feature Summary:
2025-10-18 17:48:54,158 - utils.linguistic_features - INFO -   Word length: mean=4.67, std=3.08
2025-10-18 17:48:54,160 - utils.linguistic_features - INFO -   Zipf frequency: mean=5.85, std=1.38, range=[0.91, 7.51]
2025-10-18 17:48:54,163 - utils.linguistic_features - INFO -   Surprisal: mean=6.93, std=5.55
2025-10-18 17:48:54,171 - __main__ - ERROR - Pipeline failed: 'DyslexiaTimeAnalysisPipeline' object has no attribute 'results_dir'
Traceback (most recent call last):
  File "c:\Users\hugos\Desktop\Dyslexia_Time_Paper\Dyslexia_Time_Cost_Analysis\main_preprocessing.py", line 673, in main
    pipeline.run_exploratory_analysis()
  File "c:\Users\hugos\Desktop\Dyslexia_Time_Paper\Dyslexia_Time_Cost_Analysis\main_preprocessing.py", line 355, in run_exploratory_analysis
    self.save_processed_data(data, "processed_data_full.csv")
  File "c:\Users\hugos\Desktop\Dyslexia_Time_Paper\Dyslexia_Time_Cost_Analysis\main_preprocessing.py", line 561, in save_processed_data
    output_path = self.results_dir / filename
AttributeError: 'DyslexiaTimeAnalysisPipeline' object has no attribute 'results_dir'
2025-10-18 17:49:33,903 - __main__ - INFO - Dyslexia Time Analysis Pipeline initialized
2025-10-18 17:49:33,904 - __main__ - INFO - Running pre-processing steps...
2025-10-18 17:49:33,904 - __main__ - INFO - Running exploratory analysis...
2025-10-18 17:49:33,904 - __main__ - INFO - Loading CopCo dataset...
2025-10-18 17:49:33,904 - utils.data_utils - INFO - Loading 57 participant files...
2025-10-18 17:49:34,593 - utils.data_utils - INFO - Starting with 335,203 total word entries
2025-10-18 17:49:34,774 - utils.data_utils - INFO - Word fixation patterns:
2025-10-18 17:49:34,775 - utils.data_utils - INFO -   - Skipped words (0 fixations): 126,302
2025-10-18 17:49:34,775 - utils.data_utils - INFO -   - Fixated words (1+ fixations): 208,901
2025-10-18 17:49:34,775 - utils.data_utils - INFO -   - Unknown fixations (NaN): 0
2025-10-18 17:49:34,807 - utils.data_utils - INFO - Fixated words reading times: median 272ms, 99th percentile 1777ms
2025-10-18 17:49:34,810 - utils.data_utils - INFO - Removed 14 fixated words with extreme reading times (0 too short, 14 too long)
2025-10-18 17:49:34,910 - utils.data_utils - INFO - Removed 23 words longer than 30 characters (likely data errors)
2025-10-18 17:49:34,947 - utils.data_utils - INFO - Final dataset: 126,302 skipped words, 208,864 fixated words
2025-10-18 17:49:34,947 - utils.data_utils - INFO - Data cleaning complete: 335,166 words retained (100.0% of original)
2025-10-18 17:49:34,954 - utils.data_utils - INFO - Groups identified: 19 dyslexic, 39 control
2025-10-18 17:49:35,023 - __main__ - INFO - Calculating skipping probabilities...
2025-10-18 17:49:35,025 - utils.skipping_utils - INFO - Skipping analysis from ExtractedFeatures:
2025-10-18 17:49:35,025 - utils.skipping_utils - INFO -   Total words: 335,166
2025-10-18 17:49:35,026 - utils.skipping_utils - INFO -   Skipped: 126,302 (37.7%)
2025-10-18 17:49:35,026 - utils.skipping_utils - INFO -   Fixated: 208,864 (62.3%)
2025-10-18 17:49:35,064 - __main__ - INFO - Skipping analysis: 37.7% overall rate
2025-10-18 17:49:35,080 - __main__ - INFO - Loaded: 335,166 words from 57 participants
2025-10-18 17:49:35,081 - __main__ - INFO - ============================================================
2025-10-18 17:49:35,081 - __main__ - INFO - COMPUTING LINGUISTIC FEATURES
2025-10-18 17:49:35,081 - __main__ - INFO - ============================================================
2025-10-18 17:49:35,081 - utils.linguistic_features - INFO - Loading Danish frequency list from danish_frequencies\danish_leipzig_for_analysis.txt
2025-10-18 17:49:36,446 - utils.linguistic_features - WARNING - Found 2 duplicate words after lowercasing. 
2025-10-18 17:49:36,853 - utils.linguistic_features - INFO - Loaded 1,499,999 word proportions from Leipzig Corpora
2025-10-18 17:49:36,929 - utils.linguistic_features - INFO - Computing word frequency...
2025-10-18 17:49:36,930 - utils.linguistic_features - INFO -   Stripping punctuation from words before frequency lookup
2025-10-18 17:49:37,579 - utils.linguistic_features - INFO - 13 missing word instances were punctuation-only
2025-10-18 17:49:37,579 - utils.linguistic_features - WARNING - 4,586 word instances (1.4%) not found in frequency list (197 unique valid words)
2025-10-18 17:49:37,579 - utils.linguistic_features - INFO - Sample of 197 missing valid words: ['2. (margrethe', '9. og dronning', 'abilifyer', 'adspredelsens', 'af imperialismen', 'blotgydje', 'broder-sÃ¸sterligt', 'broderet messehagler og', 'drengekammeraterne', 'ecodesign-direktivet', 'en klase med', 'entrÃ©belÃ¸b', 'forbrugsopgjorte', 'fosforudnyttelsen', 'frejakult', 'geografilÃ¦rers', 'go-to-ting', 'havstrategier', 'heksejagte', 'henrik (prinsgemalen', 'hetzbÃ¸lger', 'intersex-inkluderende', 'istandgÃ¸re', 'jedi (2017', 'jernalderkulturen', 'lederun', 'majestÃ¦t dronning', 'med prins', 'miljÃ¸sejr', 'minervafester', 'morgensamlingsudvalget', 'nivaagaard-tradition', 'nÃ¦stlÃ¦ngste regeringstid af', 'rekrutteringsindsatsen', 'renÃ¦ssancekongen', 'sankthansormen', 'sankthanstraditioner', 'siden margrethe', 'slomo', 'snaksalighed', 'solhversfesten', 'spÃ¥domsevner', 'svenske velfÃ¦rdsstat og', 'takstfinansiere', 'tankestrukturer', 'top-omstillingsparate', 'traume for', 'vandmiljÃ¸indsatsen', 'vk-fÃ¦llesskabet', 'Ã¥bningsriffet']... (147 more)
2025-10-18 17:49:37,586 - utils.linguistic_features - INFO - Excluding 4,599 word instances (1.4%) with missing frequencies from analysis
2025-10-18 17:49:37,702 - utils.linguistic_features - INFO - Remaining dataset: 330,567 words
2025-10-18 17:49:37,702 - utils.linguistic_features - INFO - Final dataset: 330,567 words with valid frequencies
2025-10-18 17:49:40,716 - utils.linguistic_features - INFO - Loading causal language model: KennethTM/gpt2-medium-danish
2025-10-18 17:49:42,129 - utils.linguistic_features - INFO - Using CPU for surprisal computation
2025-10-18 17:49:42,130 - utils.linguistic_features - INFO - Causal language model loaded successfully
2025-10-18 17:49:42,130 - utils.linguistic_features - INFO - Computing surprisal with causal GPT-2 (left-to-right)...
2025-10-18 17:49:43,464 - utils.linguistic_features - INFO - Dataset statistics:
2025-10-18 17:49:43,465 - utils.linguistic_features - INFO -   Total participant-sentence instances: 20,707
2025-10-18 17:49:43,465 - utils.linguistic_features - INFO -   Unique sentence texts: 1,986
2025-10-18 17:49:43,465 - utils.linguistic_features - INFO -   Average participants per sentence: 10.4
2025-10-18 17:49:43,466 - utils.linguistic_features - INFO - Loading cached surprisal values from word_surprisal\surprisal_cache_gpt2.pkl
2025-10-18 17:49:43,477 - utils.linguistic_features - INFO - Loaded surprisal for 1,986 unique sentences
2025-10-18 17:49:43,478 - utils.linguistic_features - INFO - Broadcasting surprisal values to all participant instances...
2025-10-18 17:49:43,478 - utils.linguistic_features - INFO -   Mapping surprisal to words...
2025-10-18 17:49:46,544 - utils.linguistic_features - INFO -   Mapped 326,496 words
2025-10-18 17:49:46,545 - utils.linguistic_features - INFO - 
Surprisal Computation Results:
2025-10-18 17:49:46,546 - utils.linguistic_features - INFO -   Unique sentences processed: 1,986
2025-10-18 17:49:46,546 - utils.linguistic_features - INFO -   Total words with surprisal: 326,496 / 330,567
2025-10-18 17:49:46,546 - utils.linguistic_features - INFO -   Mean: 6.93 bits
2025-10-18 17:49:46,550 - utils.linguistic_features - INFO -   Median: 5.69 bits
2025-10-18 17:49:46,552 - utils.linguistic_features - INFO -   Std: 5.55 bits
2025-10-18 17:49:46,552 - utils.linguistic_features - INFO -   Range: [0.00, 59.34] bits
2025-10-18 17:49:46,568 - utils.linguistic_features - INFO - Linguistic features added successfully
2025-10-18 17:49:46,569 - utils.linguistic_features - INFO - 
Feature Summary:
2025-10-18 17:49:46,572 - utils.linguistic_features - INFO -   Word length: mean=4.67, std=3.08
2025-10-18 17:49:46,575 - utils.linguistic_features - INFO -   Zipf frequency: mean=5.85, std=1.38, range=[0.91, 7.51]
2025-10-18 17:49:46,579 - utils.linguistic_features - INFO -   Surprisal: mean=6.93, std=5.55
2025-10-18 17:49:46,589 - __main__ - INFO - Saving processed data to preprocessing_results\processed_data_full.csv
2025-10-18 17:49:46,589 - __main__ - INFO -   Shape: (330567, 41)
2025-10-18 17:49:46,589 - __main__ - INFO -   Columns: 41
2025-10-18 17:49:50,730 - __main__ - INFO - Processed data saved successfully
2025-10-18 17:49:50,955 - __main__ - INFO - Data dictionary saved to preprocessing_results\processed_data_full.txt
2025-10-18 17:49:51,027 - utils.stats_utils - INFO - Added enhanced skipping statistics to basic stats
2025-10-18 17:49:51,028 - utils.stats_utils - INFO - Overall skipping rate: 37.7%
2025-10-18 17:49:51,386 - __main__ - INFO - Analyzing linguistic feature effects...
2025-10-18 17:49:51,826 - __main__ - INFO - Linguistic feature analysis complete
2025-10-18 17:49:51,844 - utils.misc_utils - INFO - Results saved to preprocessing_results\exploratory_summary.json
2025-10-18 17:49:52,981 - utils.visualization_utils - INFO - Exploratory plots saved to preprocessing_results\exploratory_plots.png
2025-10-18 17:49:54,246 - utils.visualization_utils - INFO - Group summary plots saved to preprocessing_results\group_summary_plots.png
2025-10-18 17:49:54,252 - __main__ - INFO - Creating linguistic feature visualizations...
2025-10-18 17:49:56,979 - __main__ - INFO - Linguistic feature plots saved to preprocessing_results\linguistic_features_plots.png
2025-10-18 17:49:57,002 - __main__ - INFO - Analysis complete. Results saved to preprocessing_results
2025-10-18 17:49:57,017 - __main__ - INFO - Analysis complete!
